/*!
 * Fizz-Admin v2.6.6
 * (c) 2020-2022 Joker-Lee
 * AGPL v3 Licensed.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views.aggregate"],{"0209":function(e,t,a){"use strict";a("5c4b")},"0452":function(e,t,a){},"04b4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:e.title,visible:e.drawerVisible,direction:"rtl","modal-append-to-body":!1,wrapperClosable:!1,size:"880px"},on:{"update:visible":function(t){e.drawerVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"small",disabled:e.disabled||"detail"===e.dialogType}},[a("el-form-item",{attrs:{label:"组件描述:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",placeholder:"如：循环调用10次"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("div",{staticClass:"form-item-required"},[a("el-form-item",{attrs:{label:"循环数据源:"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"",prop:"dataSourceType"}},[a("el-select",{attrs:{placeholder:"固定值/引用值"},model:{value:e.form.dataSourceType,callback:function(t){e.$set(e.form,"dataSourceType",t)},expression:"form.dataSourceType"}},e._l(e.valueType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"",prop:"dataSource"}},["fixed"===e.form.dataSourceType?a("el-input",{attrs:{"controls-position":"right",clearable:"",placeholder:"值",min:1,oninput:"value=value.replace(/[^0-9]/g,'')",type:"number"},model:{value:e.form.dataSource,callback:function(t){e.$set(e.form,"dataSource",e._n(t))},expression:"form.dataSource"}}):a("el-input",{attrs:{placeholder:"值"},model:{value:e.form.dataSource,callback:function(t){e.$set(e.form,"dataSource",t)},expression:"form.dataSource"}})],1)],1),"ref"===e.form.dataSourceType?a("quote-tooltip",{staticClass:"tooltip"}):e._e()],1)],1),a("el-collapse",{staticClass:"info-con",attrs:{accordion:""},model:{value:e.activeCollapse,callback:function(t){e.activeCollapse=t},expression:"activeCollapse"}},[a("el-collapse-item",{attrs:{title:"",name:"desc"}},[a("template",{slot:"title"},[a("div",{staticClass:"title"},[e._l(e.info.title,(function(t,r){return a("p",{key:r},[e._v(e._s(t))])})),a("span",{staticClass:"switch-text"},[e._v(e._s("desc"===e.activeCollapse?"收起":"展开"))])],2)]),e._l(e.info.body,(function(t,r){return a("div",{key:r,staticClass:"row"},e._l(t,(function(t,r){return a("p",{key:r},[e._v(e._s(t))])})),0)}))],2)],1)],1),a("div",{staticClass:"con"},[a("exec-break",{ref:"circleConditions",attrs:{data:e.execConditions,disabled:e.disabled||"detail"===e.dialogType,title:"循环条件",info:"条件为true时执行当次循环, 为false时跳过当次循环"},on:{"update:data":function(t){e.execConditions=t}}})],1),a("div",{staticClass:"con"},[a("exec-break",{ref:"breakConditions",attrs:{data:e.breakConditions,disabled:e.disabled||"detail"===e.dialogType,title:"退出条件",info:"条件为true时跳出循环, 退出条件在每次循环之后执行"},on:{"update:data":function(t){e.breakConditions=t}}})],1),a("footer",{staticClass:"drawer-footer"},[e.disabled||"detail"===e.dialogType?e._e():a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("\n      确 定\n    ")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawerVisible=!1}}},[e._v(" \n      "+e._s(e.disabled||"detail"===e.dialogType?"关 闭":" 取 消")+"\n    ")])],1)],1)},n=[],i=(a("8e6e"),a("456d"),a("5df3"),a("ade3")),o=(a("ac6a"),a("c5f6"),a("e683")),s=a("cc38"),l=a("9288");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"circle-dialog",components:{quoteTooltip:s["default"],execBreak:l["default"]},props:{visible:{type:Boolean,default:!1},disabled:Boolean,data:Object,dialogType:{type:String,default:"add",validator:function(e){return-1!==["add","detail","edit"].indexOf(e)}}},data:function(){return{activeCollapse:"",form:{type:"circle",desc:"",dataSourceType:"",dataSource:""},rules:{desc:[{required:!0,message:"请输入组件描述",trigger:"blur"}],dataSourceType:[{required:!0,message:"请选择【循环数据源】",trigger:"change"}],dataSource:[{required:!0,message:"请输入【值】",trigger:"blur"}]},valueType:o["c"],info:{title:[" 数据源是一个数组或数字(循环次数)，固定值只支持数字。","如：固定值10，引用值step1.request1.response.body.data，当数据源不为空时才执行循环；"],body:[["在请求的循环内可通stepN.requestM.item引用当次循环对象，如：","step2.request1.item.name可获取到循环对象name字段的值，数据源是数字时，item是以1开始的数字，step2.request1.index可得到当次循环对象的下标，下标从0开始","在步骤的循环内可通stepN.item引用当次循环对象，如：","step2.item.name可获取到循环对象name字段的值，数据源是数字时，item是以1开始的数字，step2.index可得到当次循环对象的下标；"],["循环调用的结果为一个数组，可通过引用值获取，如：","循环请求：","step2.request1.circle[0].response.body可得到第一次循环请求的结果，","step2.request1.circle[-1].response.body可得到前一次循环请求的结果,","step2.request1.circle[*].response.body可得到所有循环请求的响应结果;","循环步骤:","step2.circle[0].request1.response.body可得到第一次循环步骤的结果，","step2.circle[-1].request1.response.body可得到前一次循环步骤的结果,","step2.circle[*].request1.response.body可得到所有循环步骤的响应结果"]]},execConditions:[],breakConditions:[]}},computed:{drawerVisible:{get:function(){return this.visible},set:function(){this.$emit("changeDrawer")}},title:function(){var e="";switch(this.dialogType){case"add":e="新增 流程控制组件【循环组件 circle】";break;case"edit":e="编辑 流程控制组件【循环组件 circle】";break;case"detail":e="流程控制组件【循环组件 circle】 详情";break}return e}},methods:{emitData:function(){this.$emit("emitData",this.handleData())},handleData:function(){"fixed"===this.form.dataSourceType&&(this.form.dataSource=Number(this.form.dataSource));var e=[],t=[];return this.execConditions.forEach((function(t){delete t._uuid,e.push(t)})),this.breakConditions.forEach((function(e){delete e._uuid,t.push(e)})),u(u({},this.form),{},{execConditions:e,breakConditions:t})},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message({showClose:!0,message:"请完善信息！",type:"warning"}),!1;var a=[t.$refs.circleConditions.validate(),t.$refs.breakConditions.validate()];Promise.all(a).then((function(){t.emitData(),t.drawerVisible=!1})).catch((function(e){console.log(e)}))}))}},mounted:function(){this.data&&(this.form=Object.assign({},this.data),this.execConditions=Object.assign([],this.data.execConditions),this.breakConditions=Object.assign([],this.data.breakConditions))}},d=p,f=(a("1c84"),a("81d7"),a("2877")),h=Object(f["a"])(d,r,n,!1,null,"83d19486",null);t["default"]=h.exports},"069e":function(e,t,a){"use strict";a("18ba")},"07d3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"json-schema-table"},[a("el-table",{ref:"jsonTable",staticClass:"json-table",attrs:{"row-key":"id",size:e.size,data:e.tableData,"cell-class-name":e.setCellClass,border:"","default-expand-all":""}},[a("el-table-column",{attrs:{prop:"name",label:"参数名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"scope-box",attrs:{size:e.size,disabled:e.disabled,placeholder:"参数名"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e.propType?e._e():[a("el-table-column",{attrs:{label:"类型",width:"121"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.root?a("el-select",{attrs:{size:e.size,disabled:e.disabled,placeholder:"类型",filterable:""},model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.rootTypeOptions,(function(t){return e.rootNode&&e.rootNode===t.value?a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}}):e._e()})),1):e.propTypeOptions?a("el-select",{attrs:{size:e.size,disabled:e.disabled,placeholder:"类型",filterable:""},on:{change:function(a){return e.handleSelect(t.row)}},model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.propTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("el-select",{attrs:{size:e.size,disabled:e.disabled,placeholder:"类型",filterable:""},on:{change:function(a){return e.handleSelect(t.row)}},model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,1565571909)})],a("el-table-column",{attrs:{label:"必填",width:"45"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{attrs:{disabled:e.disabled||t.row.root},model:{value:t.row.required,callback:function(a){e.$set(t.row,"required",a)},expression:"scope.row.required"}})]}}])}),a("el-table-column",{attrs:{prop:"title",label:"中文标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:e.size,disabled:e.disabled,placeholder:"中文标题"},model:{value:t.row.title,callback:function(a){e.$set(t.row,"title",a)},expression:"scope.row.title"}})]}}])}),a("el-table-column",{attrs:{prop:"titleEn",label:"英文标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:e.size,disabled:e.disabled,placeholder:"英文标题"},model:{value:t.row.titleEn,callback:function(a){e.$set(t.row,"titleEn",a)},expression:"scope.row.titleEn"}})]}}])}),a("el-table-column",{attrs:{label:"说明"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{size:e.size,disabled:e.disabled,placeholder:"说明"},model:{value:t.row.description,callback:function(a){e.$set(t.row,"description",a)},expression:"scope.row.description"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:e.hasAddChildren?"220px":"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasAddChildren?[a("el-tooltip",{attrs:{content:"为Object或Array添加子层级的参数",placement:"top-start"}},[a("el-button",{attrs:{size:e.size,disabled:e.disabled,type:"text"},on:{click:function(a){return e.handleAddChildren(t.row)}}},[e._v("添加子字段\n            ")])],1)]:e._e(),a("el-tooltip",{attrs:{content:"为参数补充更详细的信息",placement:"top-start"}},[a("el-button",{attrs:{size:e.size,type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("更多设置\n          ")])],1),t.row.root?e._e():[a("el-tooltip",{attrs:{content:"插入新的参数",placement:"top-start"}},[a("el-button",{attrs:{size:e.size,disabled:e.disabled,type:"text"},on:{click:function(a){return e.handleAdd(t.row)}}},[e._v("插入\n            ")])],1)],a("el-button",{attrs:{size:e.size,disabled:e.disabled,type:"text"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除\n        ")])]}}])}),a("template",{slot:"empty"},[a("div",{staticStyle:{padding:"20px"}},[a("avue-empty"),a("el-button",{attrs:{type:"primary",size:e.size,disabled:e.disabled},on:{click:function(t){return e.initTableData()}}},[e._v("新增数据")])],1)])],2),a("el-dialog",{staticClass:"json-schema-dialog",attrs:{"append-to-body":"",width:"900px","close-on-click-modal":!1,title:e.detailDialog.title,visible:e.detailDialog.visible},on:{"update:visible":function(t){return e.$set(e.detailDialog,"visible",t)}}},[a("el-table",{attrs:{data:e.detailData,size:"mini",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"参数名"}}),a("el-table-column",{attrs:{prop:"type",label:"类型",width:"121"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.formatType(t.row.type))+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"required",label:"必填",width:"45"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.required?"是":"否")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"title",label:"中文标题"}}),a("el-table-column",{attrs:{prop:"titleEn",label:"英文标题"}}),a("el-table-column",{attrs:{prop:"description",label:"说明"}})],1),a("el-form",{ref:"detailForm",attrs:{model:e.detailForm,rules:e.rules,size:"small",disabled:e.disabled,"label-width":"100px"}},[e.showMoreRule?[a("el-form-item",{attrs:{label:"长度限制",prop:"length"}},[a("el-input-number",{attrs:{placeholder:"最小长度","controls-position":"right",min:0,precision:0},model:{value:e.detailForm.minLength,callback:function(t){e.$set(e.detailForm,"minLength",t)},expression:"detailForm.minLength"}}),a("span",[e._v(" ~ ")]),a("el-input-number",{attrs:{placeholder:"最大长度","controls-position":"right",min:0,precision:0},model:{value:e.detailForm.maxLength,callback:function(t){e.$set(e.detailForm,"maxLength",t)},expression:"detailForm.maxLength"}})],1),a("el-form-item",{attrs:{label:"格式限制",prop:"format"}},[a("el-select",{attrs:{placeholder:"格式限制",filterable:"",clearable:""},model:{value:e.detailForm.format,callback:function(t){e.$set(e.detailForm,"format",t)},expression:"detailForm.format"}},e._l(e.formatOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"正则限制",prop:"pattern"}},[a("el-input",{attrs:{placeholder:"正则限制",clearable:""},model:{value:e.detailForm.pattern,callback:function(t){e.$set(e.detailForm,"pattern",t)},expression:"detailForm.pattern"}})],1)]:e._e(),"number"===e.detailForm.type||"integer"===e.detailForm.type?[a("el-form-item",{attrs:{label:"数值范围",prop:"length"}},[a("el-input-number",{attrs:{placeholder:"最小值","controls-position":"right",min:0,precision:0},model:{value:e.detailForm.minimum,callback:function(t){e.$set(e.detailForm,"minimum",t)},expression:"detailForm.minimum"}}),a("span",[e._v(" ~ ")]),a("el-input-number",{attrs:{placeholder:"最大值","controls-position":"right",min:0,precision:0},model:{value:e.detailForm.maximum,callback:function(t){e.$set(e.detailForm,"maximum",t)},expression:"detailForm.maximum"}})],1)]:e._e(),a("el-form-item",{attrs:{label:"参数值可能性",prop:"enum"}},[e._l(e.detailForm.enum,(function(t){return a("el-tag",{key:t,attrs:{"disable-transitions":!1,closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v("\n          "+e._s(t)+"\n        ")])})),e.tagInputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}},model:{value:e.tagInputValue,callback:function(t){e.tagInputValue=t},expression:"tagInputValue"}}):a("el-button",{attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 新枚举值")])],2),"array"!==e.detailForm.type||e.detailForm.children&&e.detailForm.children.length?e._e():[a("el-form-item",{attrs:{label:"子字段类型",prop:"subtype"}},[a("el-select",{attrs:{placeholder:"子字段类型",filterable:"",clearable:""},model:{value:e.detailForm.items.type,callback:function(t){e.$set(e.detailForm.items,"type",t)},expression:"detailForm.items.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]],2),e.disabled?e._e():a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small",loading:e.detailDialog.loading},on:{click:e.submitDetail}},[e._v("提 交\n      ")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.detailDialog.visible=!1}}},[e._v("取 消")])],1)],1)],1)},n=[],i=(a("8e6e"),a("20d6"),a("4f7f"),a("5df3"),a("1c4c"),a("7f7f"),a("ade3")),o=(a("456d"),a("ac6a"),a("6b54"),a("c54a")),s=a("307b");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u=function e(t,a){var r=t.children;if(r&&r.length){for(var n,i=0;i<r.length;i++){if(r[i].id===a)return n=t,n;if(r[i].children&&r[i].children.length&&(n=e(r[i],a),n))return n}return n}},p={name:"json-schema-table",data:function(){return{tableData:[],typeOptions:[{value:"string",label:"string"},{value:"array",label:"array"},{value:"object",label:"object"},{value:"integer",label:"integer"},{value:"number",label:"number"},{value:"boolean",label:"boolean"}],rootTypeOptions:[{value:"object",label:"object"},{value:"array",label:"array"}],formatOptions:["date-time","time","date","email","ipv4","ipv6","uri"],id:1,detailDialog:{visible:!1,title:"详情",loading:!1},detailData:[],detailForm:{},tagInputVisible:!1,tagInputValue:""}},props:{disabled:{type:Boolean},size:{type:String,default:"mini"},rootType:{type:String},rootNode:{type:String},propType:{type:[String,Array]},propTypeOptions:{type:Array},data:{type:Object},subfields:{type:Boolean,default:!0},isHeaderParams:{type:Boolean,default:!1}},computed:{hasAddChildren:function(){return this.subfields&&!this.propType},showMoreRule:function(){return this.propType&&Array.isArray(this.propType)?this.propType.toString()===["array","string"].toString():"string"===this.detailForm.type}},watch:{data:{deep:!0,handler:function(){this.jsonToTableHandler()}}},created:function(){this.jsonToTableHandler()},methods:{formatType:function(e){return e instanceof Array?e.join(" / "):this.propType&&this.propType instanceof Array?this.propType.join(" / "):e},initTableData:function(){this.isHeaderParams?this.tableData=[{root:!!this.rootNode,required:!0,description:"",oneOf:[{type:"array",items:{type:"string"}},{type:"string"}]}]:this.tableData=[{id:this.id++,name:"",root:!!this.rootNode,type:this.propType||this.rootNode||"string",required:!0,description:""}]},emitData:function(){var e=this.tableToJsonHandler();this.$emit("change",e),this.$emit("update:data",e)},jsonDataFilter:function(e){var t=this,a=[],r=e.items&&e.items.properties||e.properties,n=e.childRequired||e.items&&e.items.required||e.required;return r&&Object.keys(r).forEach((function(e){var i=Object.assign({name:e,id:t.id++},r[e]);if(Object(o["b"])(i.required)&&(i.childRequired=i.required),Object(o["b"])(i.type)){var s=i.type.indexOf("null");s>-1&&i.type.splice(s,1),1===i.type.length&&(i.type=i.type[0])}i.required=!(!Object(o["b"])(n)||!n.some((function(t){return t===e}))),(i.properties||i.items&&i.items.properties)&&(i.children=t.jsonDataFilter(i),delete i.items,delete i.properties,delete i.childRequired),a.push(i)})),a},jsonToTableHandler:function(){var e={},t=this.data.properties,a={};this.isHeaderParams?t&&Object.keys(t).forEach((function(e){t[e]&&(a[e]=c(c({},t[e]),t[e].items),a[e].type=["array","string"],delete a[e].oneOf)})):t&&Object.keys(t).forEach((function(e){t[e]&&(a[e]=Object(s["a"])(c(c({},t[e].items),t[e])),t[e].items&&"string"===t[e].items.type&&(Array.isArray(t[e].type)?a[e].type.push("string"):a[e].type=[t[e].type,"string"],delete a[e].items),delete a[e].oneOf)})),e=Object(s["a"])(Object.assign({},this.data,{properties:a})),this.isEmptyObj(e)?this.initTableData():(this.tableData=this.jsonDataFilter(e),this.rootNode&&this.tableData[0]&&(this.tableData[0].root=!0))},tableDataFilter:function(e){for(var t={},a=[],r=[],n=0;n<e.length;n++){var i=e[n];if(i.name){if(t.hasOwnProperty(i.name)&&r.push(i.name),t[i.name]=Object.assign({},i),i.children&&i.children.length>0){var s=this.tableDataFilter(i.children);t[i.name].properties=s.properties||s,t[i.name].required=s.required||[]}if("array"===t[i.name].type&&(this.isEmptyObj(t[i.name].properties)||(t[i.name].items={type:"object",properties:t[i.name].properties,required:t[i.name].required}),delete t[i.name].properties,delete t[i.name].required),i.required)a.push(i.name);else if(Object(o["b"])(t[i.name].type)){var l=["null"];l=l.concat(t[i.name].type),t[i.name].type=Array.from(new Set(l))}else if(t[i.name].type){var c=["null"];c.push(t[i.name].type),t[i.name].type=c}delete t[i.name].id,delete t[i.name].name,delete t[i.name].root,delete t[i.name].children,Object(o["b"])(t[i.name].required)||delete t[i.name].required}}return r&&r.length&&this.$message.warning("请注意参数[".concat(r.join(","),"]重复，后值覆盖前值")),{properties:t,required:a}},tableToJsonHandler:function(){if(this.tableData.map((function(e){return e.enum&&0===e.enum.length&&delete e.enum,e})),this.isHeaderParams){var e=["minLength","maxLength","pattern","format","enum"];this.tableData.map((function(t){var a={type:"string"};return e.forEach((function(e){t.hasOwnProperty(e)&&(a[e]=t[e],delete t[e],t.items&&delete t.items)})),t.type="array",t.items=a,delete t.oneOf,t}))}else if(this.propType&&this.propType.toString()===["array","string"].toString()){var t=["minLength","maxLength","pattern","format","enum"];this.tableData.map((function(e){var a={};return t.forEach((function(t){e.hasOwnProperty(t)&&(a[t]=e[t],e.items&&delete e.items)})),e.items=a,delete e.oneOf,e}))}var a=Object.assign({},this.tableDataFilter(this.tableData)),r=!a.required.length;return"array"===this.rootType?a={type:r?["array","null"]:["array"],items:Object.assign({type:"object"},a)}:"object"===this.rootType?a.type=r?["object","null"]:["object"]:a.type=r?["object","array","null"]:["object","array"],a},handleAdd:function(e){var t={id:this.id++,name:"",type:this.propType||"string",description:"",required:!0},a=u({id:0,children:this.tableData},e.id),r=a.children.findIndex((function(t){return t.id===e.id}));a.children.splice(r,0,t)},handleAddChildren:function(e){var t={id:this.id++,name:"",type:"string",description:"",required:!0};e.children||this.$set(e,"children",[]),"object"!==e.type&&"array"!==e.type&&this.$set(e,"type","object"),e.children.push(t)},handleDelete:function(e){var t=u({id:0,children:this.tableData},e.id),a=t.children.findIndex((function(t){return t.id===e.id}));t.children.splice(a,1)},handleSelect:function(e){!this.rootTypeOptions.some((function(t){return t.value===e.type}))&&e.children&&this.$set(e,"children",[])},handleEdit:function(e){this.detailData=[],this.detailData.push(e),this.detailForm=Object.assign({enum:[],items:{}},e),this.detailDialog.visible=!0},submitDetail:function(){var e=this;this.detailForm.enum.length||delete this.detailForm.enum,this.detailForm.items.type||delete this.detailForm.items.type;var t=u({id:0,children:this.tableData},this.detailForm.id),a=t.children.findIndex((function(t){return t.id===e.detailForm.id}));t.children[a]=Object.assign(t.children[a],this.detailForm),this.detailDialog.visible=!1},handleClose:function(e){this.detailForm.enum.splice(this.detailForm.enum.indexOf(e),1)},showInput:function(){var e=this;this.tagInputVisible=!0,this.$nextTick((function(){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){this.tagInputValue&&this.detailForm.enum.push(this.tagInputValue),this.tagInputVisible=!1,this.tagInputValue=""},isEmptyObj:function(e){var t=Object.assign({},e);return"{}"===JSON.stringify(t)},setCellClass:function(e){var t=e.columnIndex;if(0===t)return"flex-cell"}}},d=p,f=(a("a50b"),a("2877")),h=Object(f["a"])(d,r,n,!1,null,null,null);t["default"]=h.exports},"0a6a":function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"f",(function(){return p})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return f}));a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/remove"),method:"post",params:{ids:e}})},u=function(e){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/save"),method:"post",data:e})},p=function(e){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/update"),method:"post",data:e})},d=function(e){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/detail/").concat(e),method:"get"})},f=function(){return Object(n["a"])({url:"".concat(i["a"],"/registry-config/registry-name-list"),method:"get"})}},"11d7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-detail-request"},[a("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.hasHeader?a("el-tab-pane",{attrs:{label:"请求头",name:"header"}},[e.getParamsKeys(e.headersDef)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.headersDef),max:10,type:"success"}},[e._v("请求头")])],1):e._e(),a("json-schema-table",{ref:"headersDef",attrs:{isHeaderParams:"",data:e.headersDef,disabled:e.disabled,"prop-type":["array","string"],"root-type":"object"},on:{"update:data":function(t){e.headersDef=t}}})],1):e._e(),e.hasBody?a("el-tab-pane",{attrs:{label:"请求体",name:"body"}},[e.isForm&&e.getParamsKeys(e.formBodyDef)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.formBodyDef),max:10,type:"success"}},[e._v("请求体")])],1):e.isJSON&&e.checkBodyParams(e.bodyDef)||e.isXML&&e.checkBodyParams(e.xmlBodyDef)?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{"is-dot":""}},[e._v("请求体")])],1):e._e(),a("el-form",{attrs:{size:"mini"}},[a("el-form-item",{attrs:{label:""}},[a("el-radio-group",{model:{value:e.contentType,callback:function(t){e.contentType=t},expression:"contentType"}},[a("el-radio",{attrs:{label:"application/json"}},[e._v("JSON")]),a("el-radio",{attrs:{label:"application/xml"}},[e._v("XML")]),a("el-radio",{attrs:{label:"multipart/form-data"}},[e._v("form-data")]),a("el-radio",{attrs:{label:"application/x-www-form-urlencoded"}},[e._v("x-www-form-urlencoded")])],1)],1),e.isJSON?[a("el-form-item",{attrs:{label:"JSON根类型",prop:"bodyRootType"}},[a("el-select",{model:{value:e.bodyRootType,callback:function(t){e.bodyRootType=t},expression:"bodyRootType"}},[a("el-option",{attrs:{value:"object",label:"Object"}}),a("el-option",{attrs:{value:"array",label:"Array"}})],1)],1)]:e._e(),e.isXML?[a("el-form-item",{attrs:{label:"数组节点路径",prop:"xmlArrPaths"}},[a("el-input",{attrs:{clearable:""},model:{value:e.xmlArrPaths,callback:function(t){e.xmlArrPaths=t},expression:"xmlArrPaths"}}),a("span",{staticClass:"key-tips"},[e._v("输入XML响应体里数组节点的路径, 多个路径用逗号分隔，如：/root/data/user 用于指明user标签可能有多个要转换成一个JSON数组，而不是转换成一个JSON对象 。此字段仅在响应体为XML时有效。")])],1),a("div",{staticClass:"key-tips"},[e._v("\n            网关接收到XML后会把它转换为JSON，入参按转换后的JSON配置，"),a("el-link",{on:{click:function(t){e.xmlInoVisible=!0}}},[e._v("请参考XML和JSON间的转换规则")]),e._v("。\n          ")],1)]:e._e()],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isJSON,expression:"isJSON"}]},[a("json-schema-table",{ref:"bodyDef",attrs:{data:e.bodyDef,disabled:e.disabled,"root-type":e.bodyRootType},on:{"update:data":function(t){e.bodyDef=t}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isXML,expression:"isXML"}]},[a("json-schema-table",{ref:"xmlBodyDef",attrs:{data:e.xmlBodyDef,disabled:e.disabled,"prop-type-options":e.xmlTypeOptions,"root-node":"object"},on:{"update:data":function(t){e.xmlBodyDef=t}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isForm,expression:"isForm"}]},[a("json-schema-table",{ref:"formBodyDef",attrs:{data:e.formBodyDef,disabled:e.disabled,"prop-type":["array","string"],"root-type":"object"},on:{"update:data":function(t){e.formBodyDef=t}}})],1)],1):e._e(),e.hasQuery?a("el-tab-pane",{attrs:{label:"Query参数",name:"params"}},[e.getParamsKeys(e.paramsDef)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.paramsDef),max:10,type:"success"}},[e._v("Query参数")])],1):e._e(),a("json-schema-table",{ref:"paramsDef",attrs:{isHeaderParams:"",data:e.paramsDef,disabled:e.disabled,"prop-type":["array","string"],"root-type":"object"},on:{"update:data":function(t){e.paramsDef=t}}})],1):e._e(),e.hasScript?a("el-tab-pane",{attrs:{label:"脚本校验",name:"script"}},[e.scriptId?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{"is-dot":""}},[e._v("脚本校验")])],1):e._e(),a("el-form",{attrs:{"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"脚本配置"}},[e.scriptId?a("div",[e.scriptId?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openScript()}}},[e._v("\n              "+e._s("{ aggregate_config_script_id: "+e.scriptId+" }")+"\n            ")]):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteScript(e.scriptId)}}},[e._v("\n              删除\n            ")])],1):a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){return e.openScript()}}},[e._v("\n            "+e._s(e.disabled?"无":"新增")+"\n          ")]),a("script-dialog",{attrs:{default:"validate",visible:e.scriptVisible,content:e.scriptContent,"business-type":e.businessType,disabled:e.disabled,id:e.scriptId,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:visible":function(t){e.scriptVisible=t},"update:content":function(t){e.scriptContent=t},"update:id":function(t){e.scriptId=t}}})],1)],1)],1):e._e(),a("el-tab-pane",{attrs:{label:"语言配置",name:"lang"}},[e.langForm.key||e.langForm.zh||e.langForm.en?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{"is-dot":""}},[e._v("语言配置")])],1):e._e(),a("el-form",{ref:"langForm",attrs:{model:e.langForm,rules:e.langRules,size:"small",disabled:e.disabled,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"字段",prop:"key"}},[a("el-input",{attrs:{placeholder:"请输入入参字段（例：input.request.body.languageCode"},model:{value:e.langForm.key,callback:function(t){e.$set(e.langForm,"key",t)},expression:"langForm.key"}},[a("el-popover",{attrs:{slot:"append",trigger:"hover",content:"通过该入参字段设置提示语言"},slot:"append"},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-question"},slot:"reference"})],1)],1)],1),a("el-form-item",{attrs:{label:"中文",prop:"zh"}},[a("el-input",{attrs:{type:"number"===e.langForm.zhType?"number":"text",placeholder:"请输入字段值（例：0 或 zh"},model:{value:e.langForm.zh,callback:function(t){e.$set(e.langForm,"zh",t)},expression:"langForm.zh"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{slot:"prepend",placeholder:"请选择数据类型"},on:{change:function(t){return e.changeParamsType("zh")}},slot:"prepend",model:{value:e.langForm.zhType,callback:function(t){e.$set(e.langForm,"zhType",t)},expression:"langForm.zhType"}},e._l(e.langParamsType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-popover",{attrs:{slot:"append",trigger:"hover",content:"语言与入参字段值映射关系"},slot:"append"},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-question"},slot:"reference"})],1)],1)],1),a("el-form-item",{attrs:{label:"英文",prop:"en"}},[a("el-input",{attrs:{type:"number"===e.langForm.enType?"number":"text",placeholder:"请输入字段值（例：1 或 en"},model:{value:e.langForm.en,callback:function(t){e.$set(e.langForm,"en",t)},expression:"langForm.en"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{slot:"prepend",placeholder:"请选择数据类型"},on:{change:function(t){return e.changeParamsType("en")}},slot:"prepend",model:{value:e.langForm.enType,callback:function(t){e.$set(e.langForm,"enType",t)},expression:"langForm.enType"}},e._l(e.langParamsType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-popover",{attrs:{slot:"append",trigger:"hover",content:"语言与入参字段值映射关系"},slot:"append"},[a("el-button",{attrs:{slot:"reference",icon:"el-icon-question"},slot:"reference"})],1)],1)],1)],1)],1)],1),a("xml-info",{attrs:{visible:e.xmlInoVisible},on:{"update:visible":function(t){e.xmlInoVisible=t}}})],1)},n=[],i=(a("8e6e"),a("53ca")),o=(a("6762"),a("2fdb"),a("c5f6"),a("ac6a"),a("456d"),a("ade3")),s=a("4627"),l=a("2fa9"),c=a("07d3"),u=a("921f"),p=a("5880");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={name:"api-detail-request",data:function(){return{activeTab:"header",editorHeight:400,headersDef:{},bodyDef:{},xmlBodyDef:{},formBodyDef:{},paramsDef:{},scriptValidate:{},scriptVisible:!1,scriptId:"",scriptContent:"",langForm:{},langParamsType:[{label:"number",value:"number"},{label:"string",value:"string"}],bodyRootType:"object",contentType:"application/json",xmlArrPaths:"",xmlInoVisible:!1,xmlTypeOptions:[{value:"string",label:"string"},{value:"array",label:"array"},{value:"object",label:"object"}]}},props:{data:{type:Object,default:function(){return{}}},lang:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},hasHeader:{type:Boolean,default:!0},hasBody:{type:Boolean,default:!0},hasQuery:{type:Boolean,default:!0},hasScript:{type:Boolean,default:!0},businessType:{type:String},isDelScriptWithHttp:{type:Boolean,default:!0}},computed:f(f({},Object(p["mapGetters"])(["apiScriptType"])),{},{isJSON:function(){return"application/json"===this.contentType},isXML:function(){return"application/xml"===this.contentType},isForm:function(){return"multipart/form-data"===this.contentType||"application/x-www-form-urlencoded"===this.contentType},dataObj:function(){var e={};return this.hasHeader&&(e.headersDef=this.headersDef||{}),this.hasBody&&(this.isXML?e.bodyDef=this.xmlBodyDef||{}:this.isForm?e.bodyDef=this.formBodyDef||{}:e.bodyDef=this.bodyDef||{}),this.hasQuery&&(e.paramsDef=this.paramsDef||{}),this.hasScript&&(e.scriptValidate=this.scriptId?{aggregate_config_script_id:this.scriptId}:{}),e.contentType=this.contentType,e.xmlArrPaths=this.xmlArrPaths,e}}),components:{dataEditor:s["default"],scriptDialog:l["default"],jsonSchemaTable:c["default"],xmlInfo:u["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},lang:{immediate:!0,deep:!0,handler:function(e){this.initLangData(e)}},scriptValidate:{immediate:!0,deep:!0,handler:function(e){var t=e&&"string"===typeof e?JSON.parse(e):e;this.scriptId=t["aggregate_config_script_id"]||""}},dataObj:{deep:!0,handler:function(){this.emitData()}}},methods:f(f({},Object(p["mapActions"])(["removeScript"])),{},{getParamsKeys:function(e){var t=Object.keys(e.properties||{})||[];return t.length},checkBodyParams:function(e){var t=Object.keys(e.items&&e.items.properties||e.properties||e||{})||[];return!!t.length},getJson:function(){this.$refs.headersDef&&this.$refs.headersDef.emitData(),this.$refs.paramsDef&&this.$refs.paramsDef.emitData(),this.$refs.bodyDef&&this.$refs.bodyDef.emitData(),this.$refs.xmlBodyDef&&this.$refs.xmlBodyDef.emitData(),this.$refs.formBodyDef&&this.$refs.formBodyDef.emitData(),this.emitData()},emitData:function(){this.$emit("update:data",this.dataObj)},emitLangData:function(){var e={langParam:this.langForm.key,langMapping:{zh:"number"===this.langForm.zhType?Number(this.langForm.zh):this.langForm.zh,en:"number"===this.langForm.enType?Number(this.langForm.en):this.langForm.en}};this.$emit("update:lang",e)},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=e||this.data,this.contentType=e.contentType||"application/json",this.xmlArrPaths=e.xmlArrPaths||"",this.headersDef=e.headersDef||{},this.paramsDef=e.paramsDef||{},this.scriptValidate=e.scriptValidate||{},this.isXML?this.xmlBodyDef=e.bodyDef||{}:this.isForm?this.formBodyDef=e.bodyDef||{}:(this.bodyDef=e.bodyDef||{},this.bodyRootType=e.bodyDef&&e.bodyDef.items?"array":"object")},initLangData:function(){var e=Object.assign({langParam:"",langMapping:{zh:null,en:null}},this.lang||{}),t={key:e.langParam||"",zh:e.langMapping.zh,en:e.langMapping.en};t.zhType=["number","string"].includes(Object(i["a"])(t.zh))?Object(i["a"])(t.zh):"string",t.enType=["number","string"].includes(Object(i["a"])(t.en))?Object(i["a"])(t.en):"string",this.langForm=t},validateForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"langForm";this.emitLangData();var t=!0;return this.$refs[e].validate((function(e){t=e})),t},changeParamsType:function(e){if(!e)return!1;this.langForm[e]=""},openScript:function(){this.scriptVisible=!0},deleteScript:function(e){var t=this;this.$confirm("确定删除该脚本?",{type:"warning"}).then((function(){t.isDelScriptWithHttp?t.removeScript(e).then((function(){t.scriptId="",t.$message.success("删除成功")})):(t.$store.commit("SET_WILL_DEL_SCRIPT_IDS",e),t.scriptId="",t.$message.success("删除成功"))}))}})},m=h,b=(a("beac"),a("f231"),a("2877")),g=Object(b["a"])(m,r,n,!1,null,"1d107bc7",null);t["default"]=g.exports},"11f5":function(e,t,a){"use strict";a("8065")},1401:function(e,t,a){"use strict";a("480a")},1763:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{ref:"apiDrawer",attrs:{"append-to-body":"","before-close":e.handleClose,title:"添加"+e.typeName+"接口",size:"50%",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("div",[a("div",{staticStyle:{"padding-bottom":"50px"}},[a("avue-crud",{ref:"crud",attrs:{data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad}})],1),a("footer",{staticClass:"drawer-footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleConfirm()}}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleClose()}}},[e._v("取 消")])],1)])])},n=[],i=(a("ac6a"),a("adc3")),o={data:function(){return{loading:!0,query:{},page:{pageSize:10,currentPage:1,total:0},option:{size:"mini",border:!0,selection:!0,tip:!1,columnBtn:!1,addBtn:!1,menu:!1,searchMenuSpan:12,column:[{label:"服务类型",prop:"type",type:"radio",dicData:[{label:"Dubbo",value:1},{label:"gRPC",value:2}],searchSpan:12,search:!1,hide:!0},{label:"服务名",prop:"service",search:!0,searchSpan:12},{label:"描述",prop:"description",search:!1},{label:"方法名",prop:"method",search:!0,searchSpan:12},{label:"接口名称",prop:"name",search:!0,searchSpan:12},{label:"版本",prop:"version",search:!0,searchSpan:12},{label:"分组",prop:"group",search:!0,searchSpan:12},{label:"参数类型",prop:"paramTypes",overHidden:!0,searchSpan:12},{label:"备注",prop:"note",overHidden:!0}]},data:[],selectionList:[]}},props:{visible:{type:Boolean,default:!1},type:{type:String,default:"DUBBO"},selection:{type:[Object,Array]}},computed:{ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")},typeCode:function(){return("DUBBO"===this.type?1:"GRPC"===this.type&&2)||""},typeName:function(){return("DUBBO"===this.type?" Dubbo ":"GRPC"===this.type&&" gRPC ")||" RPC "}},watch:{typeCode:function(e,t){e!==t&&(this.onLoad(this.page),this.initOption())},visible:function(e){e||this.selectionClear()}},mounted:function(){this.initOption()},methods:{initOption:function(){var e=this;this.option.column=this.option.column.map((function(t){return"version"!==t.prop&&"group"!==t.prop&&"paramTypes"!==t.prop||(t.hide=2===e.typeCode),"type"===t.prop&&(t.hide=!!e.typeCode,t.search=!e.typeCode),t}))},handleClose:function(e){this.$emit("update:visible",!1),e&&e()},handleConfirm:function(){1===this.selectionList.length?(this.$emit("confirm",this.selectionList),this.handleClose()):this.$message.warning("只能选择一条数据")},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud&&this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,e=e||this.page,a.type=a.type||this.typeCode,Object(i["d"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1,t.selectionClear()}))}}},s=o,l=(a("a4a9"),a("2877")),c=Object(l["a"])(s,r,n,!1,null,"2079c476",null);t["default"]=c.exports},"18ba":function(e,t,a){},1941:function(e,t,a){},"1c28":function(e,t,a){"use strict";a("d4b0")},"1c84":function(e,t,a){"use strict";a("970c")},"1da2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",[a("avue-crud",{ref:"crud",attrs:{"before-open":e.beforeOpen,"before-close":e.beforeClose,data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"row-del":e.rowDel,"row-update":e.rowUpdate,"row-save":e.rowSave,"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"name",fn:function(t){var r=t.row;return[e.permissionList.apiAuthority?a("span",{staticClass:"text-link",on:{click:function(t){return e.goApiList(r)}}},[e._v(e._s(r.name))]):a("span",[e._v(e._s(r.name))])]}},{key:"menu",fn:function(t){var r=t.row,n=t.type,i=t.size;return[e.permissionList.authorityBtn?a("el-button",{attrs:{icon:"el-icon-setting",size:i,type:n},on:{click:function(t){return e.handleAuthority(r)}}},[e._v("权限")]):e._e()]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("template",{slot:"menuLeft"},[e.permissionList.delBtn?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small",plain:""},on:{click:e.handleDelete}},[e._v("删 除\n      ")]):e._e()],1)],2),a("el-dialog",{attrs:{title:"["+e.authorityName+"]用户权限配置","append-to-body":"","custom-class":"authority-dialog",visible:e.authorityDialog,width:"400px"},on:{"update:visible":function(t){e.authorityDialog=t}}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleUserCheckAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),a("el-checkbox-group",{on:{change:e.handleCheckedUser},model:{value:e.checkedUser,callback:function(t){e.checkedUser=t},expression:"checkedUser"}},e._l(e.userList,(function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.userId}},[e._v(e._s(t.userName))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.authorityDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.authoritySubmit}},[e._v("确 定")])],1)],1)],1)},n=[],i=(a("8e6e"),a("456d"),a("6762"),a("2fdb"),a("7f7f"),a("ac6a"),a("ade3")),o=a("a378"),s=a("5880");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={data:function(){return{form:{},query:{},loading:!0,treeProps:{label:"userName",value:"userId"},checkAll:!1,isIndeterminate:!0,authorityId:"",authorityName:"",authorityDialog:!1,userList:[],checkedUser:[],page:{pageSize:10,currentPage:1,total:0},selectionList:[],option:{dialogWidth:900,labelWidth:100,border:!0,tip:!1,index:!0,selection:!0,dialogClickModal:!1,columnBtn:!1,menuPosition:"right",column:[{label:"服务名",prop:"name",search:!0,slot:!0,rules:[{required:!0,message:"必填",trigger:"blur"}],placeholder:"请输入 服务名，如：user-service"},{label:"服务描述",prop:"title",search:!0,searchLabelWidth:88,rules:[{required:!0,message:"必填",trigger:"blur"}],placeholder:"请输入 服务描述，如：用户服务"},{label:"团队",prop:"team",search:!0,rules:[{required:!0,message:"必填",trigger:"blur"}]},{label:"负责人",prop:"personInCharge",search:!0,rules:[{required:!0,message:"必填",trigger:"blur"}]},{label:"备注",prop:"description",span:24,overHidden:!0,minRows:6,type:"textarea",placeholder:" "}]},data:[],historyRoute:null}},computed:c(c({},Object(s["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.aggregate_service_add,!1),delBtn:this.vaildData(this.permission.aggregate_service_delete,!1),editBtn:this.vaildData(this.permission.aggregate_service_edit,!1),authorityBtn:this.vaildData(this.permission.aggregate_service_authority,!1),apiAuthority:this.vaildData(this.permission.aggregate_api,!1)}},ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")}}),beforeRouteEnter:function(e,t,a){a((function(a){e.query&&e.query.add&&(a.historyRoute=t,a.$refs.crud.rowAdd())}))},methods:{goApiList:function(e){e.name&&this.$router.push({path:"/aggregate/api",query:{serviceName:e.name}})},handleAuthority:function(e){var t=this;this.authorityId=e.id,this.authorityName=e.name,this.checkedUser=[],Object(o["e"])(this.authorityId).then((function(e){t.userList=e.data.data,t.userList.forEach((function(e){1===e.hasPrivilege&&t.checkedUser.push(e.userId)})),t.handleCheckedUser(t.checkedUser),t.authorityDialog=!0}))},handleUserCheckAll:function(e){if(e){var t=[];this.userList.forEach((function(e){t.push(e.userId)})),this.checkedUser=t}else this.checkedUser=[];this.isIndeterminate=!1},handleCheckedUser:function(e){var t=e.length;this.checkAll=t===this.userList.length,this.isIndeterminate=t>0&&t<this.userList.length},authoritySubmit:function(){var e=this,t={serviceId:this.authorityId,userIds:this.checkedUser};Object(o["f"])(t).then((function(){e.authorityDialog=!1,e.$message({type:"success",message:"操作成功!"})}))},rowSave:function(e,t,a){var r=this;Object(o["a"])(e).then((function(){t(),r.$message({type:"success",message:"保存成功"}),r.$route.query&&r.$route.query.add?(r.$router.$avueRouter.closeTag(),r.$router.push("/aggregate/service")):r.onLoad(r.page)}),(function(e){a(),window.console.log(e)}))},rowUpdate:function(e,t,a,r){var n=this;Object(o["h"])(e).then((function(){a(),n.onLoad(n.page),n.$message({type:"success",message:"修改成功"})}),(function(e){r(),window.console.log(e)}))},rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["g"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},handleDelete:function(){var e=this;0!==this.selectionList.length?this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["g"])(e.ids)})).then((function(){e.onLoad(e.page),e.$message({type:"success",message:"删除成功"}),e.$refs.crud.toggleSelection()})):this.$message.warning("请选择至少一条数据")},beforeOpen:function(e,t){var a=this;["edit","view"].includes(t)&&Object(o["c"])(this.form.id).then((function(e){a.form=e.data.data})),e()},beforeClose:function(e,t){e(),"add"===t&&this.$route.query&&this.$route.query.add&&(this.$router.$avueRouter.closeTag(),this.$router.push(this.historyRoute.fullPath))},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud&&this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(o["d"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1,t.selectionClear()}))}}},p=u,d=(a("9607"),a("2877")),f=Object(d["a"])(p,r,n,!1,null,null,null);t["default"]=f.exports},2190:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-detail-response"},[a("data-params",e._b({attrs:{"header-name":"响应头","body-name":"响应体","has-query":!1,data:e.response,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:data":function(t){e.response=t}}},"data-params",e.$attrs,!1))],1)},n=[],i=a("942a"),o={name:"api-detail-validate",data:function(){return{response:{}}},inheritAttrs:!1,props:{data:{type:Object,default:function(){return{}}},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{dataParams:i["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},response:{deep:!0,handler:function(){this.emitData()}}},methods:{emitData:function(){this.$emit("update:data",this.response)},initData:function(e){this.response=e||this.data||{}}}},s=o,l=a("2877"),c=Object(l["a"])(s,r,n,!1,null,"d220a3e4",null);t["default"]=c.exports},2420:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-detail-base"},[a("el-form",{ref:"baseForm",attrs:{model:e.baseForm,rules:e.rules,size:"small",disabled:e.disabled,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"所属服务",prop:"serviceId"}},[a("el-select",{attrs:{placeholder:"请选择所属服务",filterable:""},on:{change:e.getServiceName},model:{value:e.baseForm.serviceId,callback:function(t){e.$set(e.baseForm,"serviceId",t)},expression:"baseForm.serviceId"}},e._l(e.aggregateServiceOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.value,value:e.id}})})),1),!e.disabled&&e.permissionList.serviceAddBtn?a("span",{staticClass:"add-service",on:{click:function(t){return e.goAddService()}}},[e._v("新增服务")]):e._e()],1),a("el-form-item",{attrs:{label:"接口描述",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入接口描述，如：用户详情接口"},model:{value:e.baseForm.name,callback:function(t){e.$set(e.baseForm,"name",t)},expression:"baseForm.name"}})],1),a("el-form-item",{attrs:{label:"方法",prop:"method"}},[a("el-select",{attrs:{placeholder:"请选择方法"},model:{value:e.baseForm.method,callback:function(t){e.$set(e.baseForm,"method",t)},expression:"baseForm.method"}},e._l(e.apiMethod,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"路径",prop:"path"}},[a("el-input",{attrs:{placeholder:"请输入接口路径（例：/member/getMebInfo"},model:{value:e.baseForm.path,callback:function(t){e.$set(e.baseForm,"path",t)},expression:"baseForm.path"}}),a("span",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v("（例：/member/getMebInfo）")])],1),a("el-form-item",{attrs:{label:"开发人员",prop:"developer"}},[a("el-input",{attrs:{placeholder:"请输入开发人员"},model:{value:e.baseForm.developer,callback:function(t){e.$set(e.baseForm,"developer",t)},expression:"baseForm.developer"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{type:"textarea",placeholder:""},model:{value:e.baseForm.description,callback:function(t){e.$set(e.baseForm,"description",t)},expression:"baseForm.description"}})],1)],1)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("7514"),a("ade3")),o=a("5880"),s=a("16cd");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"api-detail-base",data:function(){return{baseForm:{},rules:{serviceId:[{required:!0,message:"请选择所属服务",trigger:"change"}],name:[{required:!0,message:"请输入接口描述",trigger:"blur"}],title:[{required:!0,message:"请输入接口中文名",trigger:"blur"}],method:[{required:!0,message:"请选择方法",trigger:"change"}],path:[{required:!0,message:"请输入路径",trigger:"blur"},{pattern:/^(\/)+/,message:"请参照例子正确填写路径, 开头不可缺少 '/' 符号",trigger:"blur"},{pattern:/^[^\u4e00-\u9fa5]+$/,message:"请勿输入中文字符",trigger:"blur"}]}}},props:{data:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},computed:c(c({},Object(o["mapGetters"])(["apiMethod","aggregateServiceOptions","permission"])),{},{permissionList:function(){return{serviceAddBtn:this.vaildData(this.permission.aggregate_service_add,!1)}}}),watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}}},created:function(){this.getAggregateServiceOptions()},methods:c(c({},Object(o["mapActions"])(["getAggregateServiceOptions"])),{},{goAddService:function(){this.$router.push({path:"/aggregate/service",query:{add:1}})},emitData:function(){this.$emit("update:data",Object(s["b"])(this.baseForm))},validateForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"baseForm";this.emitData();var t=!0;return this.$refs[e].validate((function(e){t=e})),t},getServiceName:function(e){e&&(this.baseForm.serviceName=this.aggregateServiceOptions.find((function(t){return t.id===e})).value||"")},initData:function(e){this.baseForm=e||this.data||{id:"",serviceId:"",name:"",title:"",method:"",path:"",developer:"",description:"",serviceName:""}}})},p=u,d=(a("8890"),a("2877")),f=Object(d["a"])(p,r,n,!1,null,"d68abc54",null);t["default"]=f.exports},"2b3f":function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return u}));a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config-history/aggregateconfighistory/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config-history/aggregateconfighistory/detail"),method:"get",params:{id:e}})},u=function(e){var t=e.id,a=e.remark;return Object(n["a"])({url:"".concat(i["a"],"/aggregate/rollbackSpecific"),method:"post",params:{id:t,remark:a}})}},"2fa9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,"append-to-body":"",visible:e.visible,"before-close":e.handleClose,width:"900px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"tips-area"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openTipsDialog("common")}}},[e._v("common.js")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openTipsDialog("context")}}},[e._v("context.js")])],1),a("el-form",{ref:"scriptForm",attrs:{model:e.scriptForm,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"脚本类型",required:""}},[a("el-select",{attrs:{placeholder:"请选择脚本类型",disabled:e.disabled||e.type},on:{change:e.changeType},model:{value:e.script.type,callback:function(t){e.$set(e.script,"type",t)},expression:"script.type"}},e._l(e.apiScriptType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-alert",{directives:[{name:"show",rawName:"v-show",value:"javascript"===e.script.type,expression:"script.type === 'javascript'"}],staticClass:"warn-msg",attrs:{closable:!1,type:"warning","show-icon":"",title:"注意：只支持 ES5 语法，不支持ES6及以上语法"}})],1),a("el-form-item",{attrs:{label:"脚本内容",required:""}},[a("code-editor",{attrs:{height:e.editorHeight,content:e.script.source},on:{"update:content":function(t){return e.$set(e.script,"source",t)},change:e.changeCode}})],1),e.disabled?e._e():a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitFn()}}},[e._v("确定")]),e.id?a("el-button",{on:{click:function(t){return e.deleteFn()}}},[e._v("删除")]):e._e()],1)],1),a("el-dialog",{attrs:{width:"600px",title:e.tipsDialog.title,visible:e.tipsDialog.visible,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.tipsDialog,"visible",t)}}},[a("code-highlight",{attrs:{height:e.editorHeight,code:e.tipsDialog.content}})],1)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),o=(a("c5f6"),a("5880")),s=a("c735"),l=a("9470"),c=a("d480"),u={commonJS:"/**\r\n * context 上下文便捷操作函数\r\n *\r\n */\r\n var common = {\r\n  /* *********** private function begin *********** */\r\n\r\n  /**\r\n   * 获取上下文中客户端请求对象\r\n   * @param {*} ctx 上下文 【必填】\r\n   */\r\n  getInputReq: function (ctx){\r\n      if(!ctx || !ctx['input'] || !ctx['input']['request']){\r\n          return {};\r\n      }\r\n      return ctx['input']['request']\r\n  },\r\n\r\n  /**\r\n   * 获取上下文步骤中请求接口的请求对象\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名称 【必填】\r\n   * @param {*} requestName 请求名称 【必填】\r\n   */\r\n  getStepReq: function (ctx, stepName, requestName){\r\n      if(!ctx || !stepName || !requestName){\r\n          return {};\r\n      }\r\n      if(!ctx[stepName] || !ctx[stepName]['requests'] || !ctx[stepName]['requests'][requestName] ||\r\n          !ctx[stepName]['requests'][requestName]['request']){\r\n          return {};\r\n      }\r\n      return ctx[stepName]['requests'][requestName]['request'];\r\n  },\r\n\r\n  /**\r\n   * 获取上下文步骤中请求接口的响应对象\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名称 【必填】\r\n   * @param {*} requestName 请求名称 【必填】\r\n   */\r\n  getStepResp: function (ctx, stepName, requestName){\r\n      if(!ctx || !stepName || !requestName){\r\n          return {};\r\n      }\r\n      if(!ctx[stepName] || !ctx[stepName]['requests'] || !ctx[stepName]['requests'][requestName] ||\r\n          !ctx[stepName]['requests'][requestName]['response']){\r\n          return {};\r\n      }\r\n      return ctx[stepName]['requests'][requestName]['response'];\r\n  },\r\n\r\n  /* *********** private function end *********** */\r\n\r\n  /* *********** input begin ************ */\r\n\r\n  /**\r\n   * 获取客户端请求头\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} headerName 请求头字段名 【选填】，不传时返回所有请求头\r\n   */\r\n  getInputReqHeader: function (ctx, headerName){\r\n      var req = this.getInputReq(ctx);\r\n      var headers = req['headers'] || {};\r\n      return headerName ? headers[headerName.toUpperCase()] : headers;\r\n  },\r\n\r\n  /**\r\n   * 获取客户端URL请求参数（query string）\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} paramName URL参数名 【选填】，不传时返回所有请求参数\r\n   */\r\n  getInputReqParam: function (ctx, paramName){\r\n      var req = this.getInputReq(ctx);\r\n      var params = req['params'] || {};\r\n      return paramName ? params[paramName] : params;\r\n  },\r\n\r\n  /**\r\n   * 获取客户端请求体\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} field 字段名 【选填】，不传时返回整个请求体\r\n   */\r\n  getInputReqBody: function (ctx, field){\r\n      var req = this.getInputReq(ctx);\r\n      var body = req['body'] || {};\r\n      return field ? body[field] : body;\r\n  },\r\n\r\n  /**\r\n   * 获取返回给客户端的响应头\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} headerName 响应头字段名 【选填】，不传时返回所有响应头\r\n   */\r\n  getInputRespHeader: function (ctx, headerName){\r\n      var req = this.getInputReq(ctx);\r\n      var headers = req['headers'] || {};\r\n      return headerName ? headers[headerName.toUpperCase()] : headers;\r\n  },\r\n\r\n  /**\r\n   * 获取返回给客户端的响应体\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} field 字段名 【选填】，不传时返回整个响应体\r\n   */\r\n  getInputRespBody: function (ctx, field){\r\n      var req = this.getInputReq(ctx);\r\n      var body = req['body'] || {};\r\n      return field ? body[field] : body;\r\n  },\r\n\r\n  /* *********** input begin ************ */\r\n\r\n  /* *********** step request begin ************ */\r\n\r\n  /**\r\n   * 获取步骤中调用的接口的请求头\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} requestName 请求的接口名 【必填】\r\n   * @param {*} headerName 请求头字段名 【选填】，不传时返回所有请求头\r\n   */\r\n  getStepReqHeader: function (ctx, stepName, requestName, headerName){\r\n      var req = this.getStepReq(ctx, stepName, requestName);\r\n      var headers = req['headers'] || {};\r\n      return headerName ? headers[headerName.toUpperCase()] : headers;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤中调用的接口的URL参数\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} requestName 请求的接口名 【必填】\r\n   * @param {*} paramName URL参数名 【选填】，不传时返回所有URL参数\r\n   */\r\n  getStepReqParam: function (ctx, stepName, requestName, paramName){\r\n      var req = this.getStepReq(ctx, stepName, requestName);\r\n      var params = req['params'] || {};\r\n      return paramName ? params[paramName] : params;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤中调用的接口的请求体\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} requestName 请求的接口名 【必填】\r\n   * @param {*} field 字段名 【选填】，不传时返回整个请求体\r\n   */\r\n  getStepReqBody: function (ctx, stepName, requestName, field){\r\n      var req = this.getStepReq(ctx, stepName, requestName);\r\n      var body = req['body'] || {};\r\n      return field ? body[field] : body;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤中调用的接口的响应头\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} requestName 请求的接口名 【必填】\r\n   * @param {*} headerName 响应头字段名 【选填】，不传时返回所有响应头\r\n   */\r\n  getStepRespHeader: function (ctx, stepName, requestName, headerName){\r\n      var resp = this.getStepResp(ctx, stepName, requestName);\r\n      var headers = resp['headers'] || {};\r\n      return headerName ? headers[headerName.toUpperCase()] : headers;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤中调用的接口的响应头\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} requestName 请求的接口名 【必填】\r\n   * @param {*} field 字段名 【选填】，不传时返回整个响应头\r\n   */\r\n  getStepRespBody: function (ctx, stepName, requestName, field){\r\n      var resp = this.getStepResp(ctx, stepName, requestName);\r\n      var body = resp['body'] || {};\r\n      return field ? body[field] : body;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤结果\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   * @param {*} field 字段名 【选填】，不传时返回整个步骤结果对象\r\n   */\r\n  getStepResult: function (ctx, stepName, field){\r\n      if(!ctx || !stepName || !ctx[stepName]){\r\n          return {};\r\n      }\r\n      var result = ctx[stepName]['result'] || {};\r\n      return field ? result[field] : result;\r\n  },\r\n\r\n  /**\r\n   * 获取步骤循环结果\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   */\r\n  getStepCircle: function (ctx, stepName){\r\n      if(!ctx || !stepName || !ctx[stepName]){\r\n          return null;\r\n      }\r\n      // 返回循环结果数组\r\n      return ctx[stepName]['circle'];\r\n  },\r\n\r\n  /**\r\n   * 获取请求的循环结果\r\n   * @param {*} ctx 上下文 【必填】\r\n   * @param {*} stepName 步骤名【必填】\r\n   */\r\n  getRequestCircle: function (ctx, stepName, requestName){\r\n      if(!ctx || !stepName || !requestName){\r\n          return null;\r\n      }\r\n      if(!ctx[stepName] || !ctx[stepName]['requests'] || !ctx[stepName]['requests'][requestName] ||\r\n          !ctx[stepName]['requests'][requestName]['request']){\r\n          return null;\r\n      }\r\n      // 返回循环结果数组\r\n      return ctx[stepName]['requests'][requestName]['circle'];\r\n  }\r\n\r\n  /* *********** step request end ************ */\r\n\r\n  ,/**\r\n     ** 乘法函数，用来得到精确的乘法结果\r\n     ** 说明：javascript的乘法结果会有误差，在两个浮点数相乘的时候会比较明显。这个函数返回较为精确的乘法结果。\r\n     ** 调用：accMul(arg1,arg2)\r\n     ** 返回值：arg1乘以 arg2的精确结果\r\n     **/\r\n    accMul:function (arg1, arg2) {\r\n    var m = 0, s1 = arg1.toString(), s2 = arg2.toString();\r\n    try {\r\n      m += s1.split(\".\")[1].length;\r\n    } catch (e) {\r\n    }\r\n    try {\r\n      m += s2.split(\".\")[1].length;\r\n    } catch (e) {\r\n    }\r\n    return Number(s1.replace(\".\", \"\")) * Number(s2.replace(\".\", \"\"))\r\n      / Math.pow(10, m);\r\n  },\r\n\r\n    /**\r\n     ** 除法函数，用来得到精确的除法结果\r\n     ** 说明：javascript的除法结果会有误差，在两个浮点数相除的时候会比较明显。这个函数返回较为精确的除法结果。\r\n     ** 调用：accDiv(arg1,arg2)\r\n     ** 返回值：arg1除以arg2的精确结果\r\n     **/\r\n    accDiv:function (arg1, arg2) {\r\n    var t1 = 0, t2 = 0, r1, r2;\r\n    try {\r\n      t1 = arg1.toString().split(\".\")[1].length;\r\n    } catch (e) {\r\n    }\r\n    try {\r\n      t2 = arg2.toString().split(\".\")[1].length;\r\n    } catch (e) {\r\n    }\r\n    with (Math) {\r\n      r1 = Number(arg1.toString().replace(\".\", \"\"));\r\n      r2 = Number(arg2.toString().replace(\".\", \"\"));\r\n      return (r1 / r2) * pow(10, t2 - t1);\r\n    }\r\n  }\r\n\r\n\r\n};\r\n\r\n\r\n",contextJS:'// 上下文数据结构设计\r\n// 上下文，用于保存客户输入输出和每个步骤的输入与输出结果\r\nvar context = {\r\n\t// 是否DEBUG模式\r\n\tdebug:false,\r\n\t\t\r\n\t// 各个操作的耗时\r\n\telapsedTimes: [{\r\n\t\t[actionName]: 123, // 操作名称:耗时\r\n\t}],\r\n\t\r\n\t// exception info\r\n\texceptionMessage: "",\r\n\texceptionStacks: "",\r\n\texceptionData: "", // such as script source code that cause exception\r\n\t\r\n\t\t\r\n    // 客户输入和接口的返回结果\r\n    input: {\r\n        request:{\r\n        \tpath: "",\r\n            method: "GET/POST",\r\n            headers: {},\r\n            body: {},\r\n            params: {}\r\n        },\r\n        response: { // 聚合接口的响应\r\n            headers: {},\r\n            body: {}\r\n        }\r\n    },\r\n\r\n    // 步骤\r\n    step1: {\r\n        requests: {\r\n        \t// 接口1\r\n            request1: {\r\n            \t// 请求相关参数\r\n                request:{\r\n                    url: "",\r\n                    method: "GET/POST",\r\n                    headers: {},\r\n                    body: {}\r\n                },\r\n                // 根据转换规则转换后的接口响应\r\n                response: {\r\n                    headers: {},\r\n                    body: {}\r\n                },\r\n                // 请求循环组件当前循环对象\r\n                item: null,\r\n                // 请求循环组件当前循环对象的下标\r\n                index: null,\r\n                // 请求循环的结果\r\n                circle: [{\r\n                    // 循环对象\r\n                    item: null,\r\n                    // 循环对象的下标\r\n                    index: null,\r\n                    // 请求相关参数\r\n                    request:{\r\n                        url: "",\r\n                        method: "GET/POST",\r\n                        headers: {},\r\n                        body: {}\r\n                    },\r\n                    // 根据转换规则转换后的接口响应\r\n                    response: {\r\n                        headers: {},\r\n                        body: {}\r\n                    }\r\n                }],\r\n                // 条件组件的执行结果\r\n                conditionResults: [\r\n                \t{\'我的条件1\': true}\r\n                ]\r\n            },\r\n            // 接口2\r\n            request2: {\r\n                request:{\r\n                    url: "",\r\n                    method: "GET/POST",\r\n                    headers: {},\r\n                    body: {}\r\n                },\r\n                response: {\r\n                headers: {},\r\n                    body: {}\r\n                },\r\n                // 请求循环组件当前循环对象\r\n                item: null,\r\n                // 请求循环组件当前循环对象的下标\r\n                index: null,\r\n                // 请求循环的结果\r\n                circle: [{\r\n                    // 循环对象\r\n                    item: null,\r\n                    // 循环对象的下标\r\n                    index: null,\r\n                    // 请求相关参数\r\n                    request:{\r\n                        url: "",\r\n                        method: "GET/POST",\r\n                        headers: {},\r\n                        body: {}\r\n                    },\r\n                    // 根据转换规则转换后的接口响应\r\n                    response: {\r\n                        headers: {},\r\n                        body: {}\r\n                    }\r\n                }],\r\n                // 条件组件的执行结果\r\n                conditionResults: [\r\n                \t{\'我的条件1\': true}\r\n                ]\r\n            }\r\n            //...\r\n        },\r\n\r\n        // 步骤结果\r\n        result: {},\r\n\t\t// 步骤循环组件当前循环对象\r\n        item: null,\r\n        // 步骤循环组件当前循环对象的下标\r\n        index: null,\r\n        // 步骤循环的结果\r\n        circle:[{\r\n            // 循环对象\r\n            item: null,\r\n            // 循环对象的下标\r\n            index: null,\r\n            // 步骤结果\r\n            result: {}\r\n        }] \r\n    }\r\n}',defaultGroovyJS:"// context为内置的上下文变量，详情请参考we.fizz.StepContext类实现\r\n// def data = context.getStepRespBody('step2', 'request1', 'data')\r\n\r\n// do something\r\n\r\n// 自定义返回结果，如果返回的Object里含有_stopAndResponse=true字段时将会终止请求并把脚本结果响应给客户端（主要用于有异常情况要终止请求的场景）\r\ndef result = [\r\n    // _stopAndResponse: true,\r\n    msgCode: '0',\r\n    message: '',\r\n    data: null\r\n]\r\n\r\n// 将处理结果返回\r\nreturn result",defaultScriptJS:"// javascript脚本函数名不能修改\r\nfunction dyFunc(paramsJsonStr) {\r\n  // 上下文, 数据结构请参考 context.js\r\n  var context = JSON.parse(paramsJsonStr)['context'];\r\n  // common为内置的上下文便捷操作工具类，详情请参考common.js；例如：\r\n  // var data = common.getStepRespBody(context, 'step2', 'request1', 'data');\r\n\r\n  // do something\r\n\r\n\r\n  // 自定义返回结果，如果返回的Object里含有_stopAndResponse=true字段时将会终止请求并把脚本结果响应给客户端（主要用于有异常情况要终止请求的场景）\r\n  var result = {\r\n    // _stopAndResponse: true,\r\n    msgCode: '0',\r\n    message: '',\r\n    data: null\r\n  };\r\n  // 返回结果为Array或Object时要先转为json字符串\r\n  return JSON.stringify(result);\r\n}\r\n",validateGroovyJS:"// context为内置的上下文变量，详情请参考we.fizz.StepContext类实现\r\n// 获取聚合接口用户输入的数据\r\n// 获取请求体中account数据\r\ndef account = context.getInputReqBody('account')\r\n// 获取请求体中password数据\r\ndef password = context.getInputReqBody('password')\r\ndef validate = []\r\n\r\n// 校验请求参数\r\nif (account == null || account.trim().isEmpty()) {\r\n    // 将校验不通过的错误信息add到validate中\r\n    validate << '账号不能为空'\r\n}\r\n\r\nif (password == null || password.trim().isEmpty()) {\r\n    validate << '密码不能为空'\r\n}\r\n\r\n// 空数组表示校验通过，非空表示校验不通过\r\nreturn validate",validateScriptJS:"// javascript脚本函数名不能修改\r\nfunction dyFunc(paramsJsonStr) {\r\n  // 上下文, 数据结构请参考 context.js\r\n  var context = JSON.parse(paramsJsonStr)['context'];\r\n  // common为内置的上下文便捷操作工具类，详情请参考common.js；例如：\r\n  // var account = common.getInputReqBody(context, 'account');\r\n  // var password = common.getInputReqBody(context, 'password');\r\n\r\n  // 入参校验结果，空字符串列表表示校验成功\r\n  var result = [];\r\n\r\n  // do something\r\n  // if (account == null) {\r\n  //    result.push(\"账号不能为空\");\r\n  // }\r\n  // if (password == null) {\r\n  //    result.push(\"密码不能为空\");\r\n  // }\r\n\r\n  // 返回结果为Array或Object时要先转为json字符串\r\n  return JSON.stringify(result);\r\n}\r\n"};function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f={name:"script-dialog",data:function(){return{editorHeight:400,scriptForm:{},script:{type:this.type||"javascript",source:""},tipsDialog:{title:"js",visible:!1,content:""},scriptModule:"",groovyModule:""}},props:{type:{type:String},businessType:{type:String,default:"default"},id:{type:[String,Number]},visible:{type:Boolean,default:!1},content:{type:[Object,String]},disabled:{type:Boolean,default:!1},callback:{type:Function},default:{type:String,default:"default"},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{codeEditor:l["default"],codeHighlight:c["default"]},computed:d(d({},Object(o["mapGetters"])(["apiScriptType"])),{},{title:function(){return"脚本配置"+(this.id?" ID-"+this.id:"")}}),watch:{visible:function(e){e?this.getDetail():this.script.source=""}},methods:{openTipsDialog:function(e){this.tipsDialog.visible=!0,this.tipsDialog.title=e+".js",this.tipsDialog.content="common"===e?u.commonJS:u.contextJS},getDetail:function(){var e=this;this.scriptModule=u[this.default+"ScriptJS"]||"",this.groovyModule=u[this.default+"GroovyJS"]||"",this.id?"history"===this.businessType?Object(s["b"])(this.id).then((function(t){e.renderSource(t.data)})):"log"===this.businessType?Object(s["c"])(this.id).then((function(t){e.renderSource(t.data)})):Object(s["a"])(this.id).then((function(t){e.renderSource(t.data)})):this.script.source=u[this.default+"ScriptJS"]||""},renderSource:function(e){var t=e.data&&e.data.script||{};if("{}"===JSON.stringify(t))return this.$message({showClose:!0,message:e.msg,duration:5e3,type:"warning"}),this.id="",void(this.script.source=u[this.default+"ScriptJS"]||"");this.script="string"===typeof t?JSON.parse(t):t,"javascript"===this.script.type?this.scriptModule=this.script.source:"groovy"===this.script.type&&(this.groovyModule=this.script.source)},submitFn:function(){var e=this;if(!this.script.type||!this.script.source)return this.$message.error("请完善脚本数据再提交"),!1;var t=this.script;Object(s["e"])({id:this.id,script:JSON.stringify(t)}).then((function(t){e.$emit("update:id",t.data.data),e.callback&&"function"===typeof e.callback&&e.callback(),e.$message({type:"success",message:"脚本保存成功!"})}),(function(e){window.console.log(e)})),this.$emit("update:content",JSON.stringify(t)),this.$emit("update:visible",!1)},deleteFn:function(e){var t=this;if(e=e||this.id||"",!e)return!1;this.$confirm("确定删除该脚本?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return t.isDelScriptWithHttp?Object(s["d"])(e).then((function(){t.delCallback()})):(t.$store.commit("SET_WILL_DEL_SCRIPT_IDS",e),void t.delCallback())}))},delCallback:function(){this.$emit("update:id",""),this.$emit("update:visible",!1),this.$message({type:"success",message:"删除成功!"}),this.callback&&"function"===typeof this.callback&&this.callback()},handleClose:function(e){this.$emit("update:visible",!1),e()},changeType:function(e){this.script.source="javascript"===e?this.scriptModule:this.groovyModule},changeCode:function(e){"javascript"===this.script.type?this.scriptModule=e:this.groovyModule=e}}},h=f,m=(a("fa97"),a("2877")),b=Object(m["a"])(h,r,n,!1,null,"7c2dc2f2",null);t["default"]=b.exports},"307b":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("53ca"),n=function(e){if("object"===Object(r["a"])(e))return JSON.parse(JSON.stringify(e))}},"329b":function(e,t,a){"use strict";a("ec8f")},"36a5":function(e,t,a){"use strict";a("98f3")},"421d":function(e,t,a){},"44d0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:e.title,visible:e.drawerVisible,direction:"rtl","modal-append-to-body":!1,wrapperClosable:!1,size:"780px"},on:{"update:visible":function(t){e.drawerVisible=t}}},[a("compare-form",{ref:"compareForm",attrs:{data:e.form,disabled:e.disabled||"detail"===e.dialogType,rule:e.rule},on:{"update:data":function(t){e.form=t}}}),a("footer",{staticClass:"drawer-footer"},[e.disabled||"detail"===e.dialogType?e._e():a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("\n      确 定\n    ")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawerVisible=!1}}},[e._v("\n       "+e._s(e.disabled||"detail"===e.dialogType?"关 闭":" 取 消")+"\n    ")])],1)],1)},n=[],i=a("e815"),o={name:"condition-dialog",components:{compareForm:i["default"]},props:{visible:{type:Boolean,default:!1},disabled:Boolean,data:Object,dialogType:{type:String,default:"add",validator:function(e){return-1!==["add","detail","edit"].indexOf(e)}}},data:function(){return{form:{},rule:{desc:[{required:!0,message:"请输入条件描述",trigger:"blur"}]}}},computed:{drawerVisible:{get:function(){return this.visible},set:function(){this.$emit("changeDrawer")}},title:function(){var e="";switch(this.dialogType){case"add":e="新增 流程控制组件【判断条件 if】";break;case"edit":e="编辑 流程控制组件【判断条件 if】";break;case"detail":e="流程控制组件【判断条件 if】 详情";break}return e}},methods:{submitForm:function(){var e=this;this.$refs.compareForm.validate().then((function(){e.$emit("emitData",e.form),e.drawerVisible=!1}),(function(){e.$message({showClose:!0,message:"请完善信息！",type:"warning"})}))}},mounted:function(){this.data&&(this.form=Object.assign({},this.data))}},s=o,l=(a("6c43"),a("2877")),c=Object(l["a"])(s,r,n,!1,null,"e0afe214",null);t["default"]=c.exports},"44f7":function(e,t,a){},"480a":function(e,t,a){},"4aa1":function(e,t,a){},"4c07":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"exec-condition"},[a("el-checkbox",{attrs:{disabled:e.disabled},model:{value:e.step.stop,callback:function(t){e.$set(e.step,"stop",t)},expression:"step.stop"}},[e._v("是否执行完此步骤后结束")])],1),a("step-requests",e._b({ref:"stepRequests",attrs:{data:e.stepRequestsData,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:data":function(t){e.stepRequestsData=t}}},"step-requests",e.$attrs,!1)),a("h2",[e._v("\n    配置步骤结果 "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.showResult=!e.showResult}}},[e._v(e._s(e.showResult?"收起":"展开"))])],1),a("div",[e.showResult?a("data-params",e._b({staticClass:"highlight-border",attrs:{"body-name":"结果","has-query":!1,"has-header":!1,data:e.step.dataMapping.response,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:data":function(t){return e.$set(e.step.dataMapping,"response",t)}}},"data-params",e.$attrs,!1)):e._e()],1)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),o=a("5e9f"),s=a("942a"),l=a("5880");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"step-item",data:function(){return{stepRequestsData:{requests:[],components:[]},step:{},showResult:!1}},inheritAttrs:!1,props:{data:{type:Array,default:function(){return{}}},disabled:{type:Boolean,default:!1},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{stepRequests:o["default"],dataParams:s["default"]},computed:{},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},stepRequestsData:{immediate:!0,deep:!0,handler:function(e){this.$set(this.step,"requests",e.requests||[]),this.$set(this.step,"components",e.components||[])}}},methods:u(u({},Object(l["mapActions"])(["updateValidateStep"])),{},{initData:function(){this.step=this.data||{name:"Step 1",stop:!1,requests:[],components:[],dataMapping:{}},this.$set(this.stepRequestsData,"requests",this.step.requests),this.$set(this.stepRequestsData,"components",this.step.components)},validate:function(){var e=this;return this.emitData(),new Promise((function(t,a){e.$refs.stepRequests.validate((function(e){e?t():a()}))}))},emitData:function(){this.$emit("update:data",this.step)}})},d=p,f=(a("60e9"),a("2877")),h=Object(f["a"])(d,r,n,!1,null,"134990aa",null);t["default"]=h.exports},"522c":function(e,t,a){},"5c4b":function(e,t,a){},"5e9f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"requests-con"},[a("add-component",{staticClass:"add-component-con",attrs:{data:e.components,disabled:e.disabled},on:{"update:data":function(t){e.components=t}}}),a("div",{staticClass:"add-request-btn"},[e.disabled?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addTab()}}},[e._v("\n      添加请求\n    ")])],1),a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:e.requestList.length>0,expression:"requestList.length > 0"}],staticClass:"tabs-con",attrs:{"tab-position":"left"},on:{"tab-remove":e.removeTab},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.requestList,(function(t){return a("el-tab-pane",{key:t.name,attrs:{name:t.name,label:t.name,closable:e.requestList&&!e.disabled}},[a("request-item",e._b({ref:"requestItem",refInFor:!0,attrs:{data:t,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:data":function(e){t=e}}},"request-item",e.$attrs,!1))],1)})),1)],1)},n=[],i=(a("20d6"),a("5df3"),a("ac6a"),a("28a5"),a("c5f6"),a("7f7f"),a("fd89")),o=a("c983"),s="request",l={name:"step-requests",data:function(){return{currentTab:"",requestList:[],maxIndex:0,components:[]}},inheritAttrs:!1,props:{data:{type:Object,default:function(){return{requests:[],components:[]}}},disabled:{type:Boolean,default:!1},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{requestItem:i["default"],addComponent:o["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(){var e=this,t=this.data||{},a=t.requests,r=t.components;this.components=r||[],a&&0!==a.length||0!==this.requestList.length?a&&a.length>0&&(this.requestList=a,this.currentTab=this.requestList.filter((function(t){return t.name===e.currentTab})).length>0?this.currentTab:this.requestList[0].name,this.maxIndex=Number(a[a.length-1].name.split(s)[1])||0):this.maxIndex=0}}},methods:{validate:function(e){if(this.emitData(),this.requestList&&this.requestList.length>0){var t=[];this.$refs.requestItem.forEach((function(e){t.push(e.validate())})),Promise.all(t).then((function(){e(!0)})).catch((function(){e(!1)}))}else e(!0)},emitData:function(){this.$emit("update:data",{requests:this.requestList,components:this.components})},addTab:function(){this.currentTab="".concat(s).concat(++this.maxIndex),this.requestList.push({name:this.currentTab,type:"REQUEST",fallback:{},condition:{},dataMapping:{request:{contentType:"application/json"},response:{contentType:"auto"}},conditionFlag:!1})},removeTab:function(e){var t=this;this.$confirm("确定删除请求".concat(e,"?"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.requestList.findIndex((function(t){return t.name==e}));a>-1&&(t.requestList.splice(a,1),t.requestList.length>0&&t.currentTab===e?t.currentTab=t.requestList[t.requestList.length-1].name:0===t.requestList.length&&(t.currentTab="".concat(s).concat(t.maxIndex+1)))}))}}},c=l,u=(a("069e"),a("2877")),p=Object(u["a"])(c,r,n,!1,null,"5f880930",null);t["default"]=p.exports},6093:function(e,t,a){"use strict";a("cb79")},"60e9":function(e,t,a){"use strict";a("8352")},"61cb":function(e,t,a){},6385:function(e,t,a){},"65d4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",{staticClass:"aggregate-api-detail"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"api-header-wrapper clearfix",attrs:{slot:"header"},slot:"header"},[a("api-header",{staticStyle:{display:"inline-block"},attrs:{"service-name":e.serviceName,"api-name":e.apiName,"page-name":e.pageName}}),"default"===e.businessType?a("div",[e.originId&&e.permissionList.publishBtn&&2===e.formData.approvalState?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.publish}},[e._v("发布")]):e._e(),e.originId?a("el-button",{attrs:{size:"small",type:"primary",plain:"",loading:e.testLoading},on:{click:e.testFn}},[e._v("测试")]):e._e()],1):e._e()],1),a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTabs,callback:function(t){e.activeTabs=t},expression:"activeTabs"}},[a("el-tab-pane",{attrs:{label:"基础信息",name:"0"}},[a("api-base",{ref:"baseForm",attrs:{data:e.baseConfigs,disabled:e.disabled},on:{"update:data":function(t){e.baseConfigs=t}}})],1),a("el-tab-pane",{attrs:{label:"配置输入",name:"1",lazy:!0}},[a("api-request",{ref:"requestConfigs",attrs:{data:e.requestConfigs,lang:e.langConfigs,"business-type":e.businessType,"has-body":"GET"!==e.baseConfigs.method,disabled:e.disabled,isDelScriptWithHttp:!1},on:{"update:data":function(t){e.requestConfigs=t},"update:lang":function(t){e.langConfigs=t}}})],1),a("el-tab-pane",{attrs:{label:"配置步骤",name:"2"}},[a("api-step",{ref:"stepForm",attrs:{"business-type":e.businessType,data:e.stepConfigs,disabled:e.disabled,isDelScriptWithHttp:!1},on:{"update:data":function(t){e.stepConfigs=t}}})],1),a("el-tab-pane",{attrs:{label:"配置输出",name:"3"}},[a("api-response",{ref:"responseForm",attrs:{"business-type":e.businessType,data:e.responseConfigs,disabled:e.disabled,isDelScriptWithHttp:!1},on:{"update:data":function(t){e.responseConfigs=t}}})],1),a("el-tab-pane",{attrs:{label:"校验结果",name:"4"}},[a("api-validate",{attrs:{"business-type":e.businessType,data:e.validateResponse,disabled:e.disabled,isDelScriptWithHttp:!1},on:{"update:data":function(t){e.validateResponse=t}}})],1),"add"!==e.actionType?a("el-tab-pane",{attrs:{label:"Config Json",lazy:!0,name:"5"}},[a("el-alert",{attrs:{title:"只读 Read Only",type:"warning"}}),a("code-highlight",{attrs:{language:"json",code:e.jsonCode,height:500}})],1):e._e()],1),a("footer",[e.disabled?e._e():a("div",[a("el-button",{attrs:{size:"small",icon:"el-icon-circle-check",loading:e.loading,type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")]),a("el-button",{attrs:{size:"small",icon:"el-icon-circle-close"},on:{click:e.handleClose}},[e._v("取消")])],1)])],1),a("publish-dialog",{attrs:{visible:e.publishDialog,name:e.baseConfigs.name,id:e.originId},on:{"update:visible":function(t){e.publishDialog=t}}})],1)},n=[],i=(a("8e6e"),a("6b54"),a("53ca")),o=(a("456d"),a("ac6a"),a("a481"),a("6762"),a("2fdb"),a("96cf"),a("1da1")),s=(a("7f7f"),a("28a5"),a("ade3")),l=a("708f"),c=a("5880"),u=a("936b"),p=a("2420"),d=a("11d7"),f=a("78e6"),h=a("f6d3"),m=a("2190"),b=a("047b"),g=a("d480");function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={name:"detail",data:function(){return{activeTabs:"0",loading:!1,testLoading:!1,debug:!1,formData:{},baseConfigs:{},requestConfigs:{},responseConfigs:{},stepConfigs:[],validateResponse:{},langConfigs:{},publishDialog:!1,businessType:"default"}},computed:y(y({},Object(c["mapGetters"])(["permission"])),{},{permissionList:function(){return{publishBtn:this.vaildData(this.permission.aggregate_api_publish,!1)}},originId:function(){return this.$route.query.originId||""},actionType:function(){var e=this.$route.path.split("/");return e[e.length-1]||"add"},disabled:function(){return"view"===this.actionType||!1},pageName:function(){return"add"===this.actionType?"新增接口":this.$route.name},serviceName:function(){return this.formData.serviceName||""},apiName:function(){return this.formData.name||""},apiConfig:function(){var e=this.formData&&this.formData.config||{};if("string"===typeof this.formData.config)try{e=JSON.parse(this.formData.config)}catch(t){console.warn("[error in config]",t)}return e||{}},jsonCode:function(){return JSON.stringify(this.apiConfig,null,"    ")}}),components:{apiHeader:u["default"],apiBase:p["default"],apiRequest:d["default"],apiStep:f["default"],apiResponse:h["default"],apiValidate:m["default"],publishDialog:b["default"],codeHighlight:g["default"]},created:function(){this.init()},beforeRouteUpdate:function(e,t,a){e.fullPath!==t.fullPath&&(a(),this.init())},watch:{apiConfig:{deep:!0,handler:function(e){this.initConfig(e)}}},methods:y(y({},Object(c["mapActions"])(["removeScript"])),{},{add:function(e,t){var a=this;return this.loading=!0,Object(l["a"])(e).then((function(){a.$message.success("接口保存成功"),a.loading=!1;var e=setTimeout((function(){a.$router.$avueRouter.closeTag(),a.$router.push({path:"/aggregate/api"}),clearTimeout(e),t&&"function"===typeof t&&t()}),300)})).catch((function(){a.loading=!1}))},update:function(e,t){var a=this;return this.loading=!0,Object(l["m"])(e).then((function(){a.$message.success("接口修改成功"),a.loading=!1,a.getDetail(),t&&"function"===typeof t&&t()})).catch((function(){a.loading=!1}))},publish:function(){this.originId?this.publishDialog=!0:this.$message.error("数据缺失，无法发布！")},testPublish:function(){this.$router.$avueRouter.closeTag();var e=this.$route;this.$router.push({path:"/aggregate/test",query:{originId:this.originId,redirect:encodeURIComponent(e.fullPath)}})},testFn:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.validateConfigs();case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return",!1);case 5:if(this.testLoading=!0,a=this.handleSubmitData(),r=this.checkChange(a),!r){e.next=12;break}this.$confirm("配置内容已修改，是否保存后跳转测试页面?",{confirmButtonText:"保存后跳转测试",cancelButtonText:"不保存直接测试",distinguishCancelAndClose:!0,type:"warning"}).then((function(){n.update(a,(function(){return n.testLoading=!1,n.testPublish(a)}))})).catch((function(e){if(n.testLoading=!1,"cancel"===e)return n.testPublish(a)})),e.next=13;break;case 12:return e.abrupt("return",this.testPublish(a));case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),initConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=e||this.apiConfig,this.debug=e.debug||!1;var t=e,a=t.headersDef,r=t.paramsDef,n=t.bodyDef,i=t.scriptValidate,o=t.langDef,s=t.dataMapping,l=t.stepConfigs,c=t.validateResponse,u=t.contentType,p=t.xmlArrPaths;this.requestConfigs={headersDef:a,paramsDef:r,bodyDef:n,scriptValidate:i,contentType:u,xmlArrPaths:p},this.langConfigs=o||{},this.responseConfigs=s||{},this.stepConfigs=l||[],this.validateResponse=c||{body:{errorMsg:"string validateMsg"}}},getDetail:function(){var e=this;if(!this.originId)return this.formData={},void(this.baseConfigs={});["edit","view"].includes(this.actionType)&&Object(l["f"])(this.originId).then((function(t){e.formData=t.data.data||{};var a=Object.assign({},e.formData),r=a.id,n=void 0===r?"":r,i=a.serviceId,o=void 0===i?"":i,s=a.name,l=void 0===s?"":s,c=a.method,u=void 0===c?"":c,p=a.path,d=void 0===p?"":p,f=a.developer,h=void 0===f?"":f,m=a.description,b=void 0===m?"":m,g=a.serviceName,v=void 0===g?"":g;d=d.replace("/proxy/".concat(v,"/"),"/"),e.baseConfigs={id:n,serviceId:o,name:l,method:u,path:d,developer:h,description:b,serviceName:v}}))},handleConfig:function(){this.$refs.requestConfigs&&this.$refs.requestConfigs.getJson();var e=Object.assign({},this.requestConfigs);return e.name=this.baseConfigs.name,e.debug=this.debug,e.type="REQUEST",e.method=this.baseConfigs.method,e.path="/proxy/".concat(this.baseConfigs.serviceName)+this.baseConfigs.path,e.validateResponse=this.validateResponse,e.stepConfigs=this.stepConfigs,e.dataMapping=this.responseConfigs,e.langDef=this.langConfigs,JSON.stringify(e)},validateConfigs:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=!0,a=this.$refs.baseForm.validateForm(),this.$refs.requestConfigs&&this.$refs.requestConfigs.validateForm(),a){e.next=7;break}return t=!1,this.$message.error("请完善基础信息"),e.abrupt("return",!1);case 7:if(e.t0=this.$refs.stepForm,!e.t0){e.next=12;break}return e.next=11,this.$refs.stepForm.validate();case 11:e.t0=e.sent;case 12:if(r=e.t0,r){e.next=17;break}return this.$message.error("请完善步骤信息"),t=!1,e.abrupt("return",!1);case 17:if(e.t1=this.$refs.responseForm,!e.t1){e.next=22;break}return e.next=21,this.$refs.responseForm.validate();case 21:e.t1=e.sent;case 22:if(n=e.t1,n.validate){e.next=27;break}return this.$message.error(n.message),t=!1,e.abrupt("return",!1);case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSubmitData:function(){var e=Object.assign({},this.baseConfigs);return e.path="/proxy/".concat(e.serviceName)+e.path,e.config=this.handleConfig(),e},handleSubmit:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.validateConfigs();case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return",!1);case 5:a=this.handleSubmitData(),r="add"===this.actionType?this.add:this.update,r(a,(function(){var e=n.$store.state.api.willDelScriptIds||[];e.length>0&&n.removeScript(e.join(",")).then((function(){n.$store.commit("CLEAR_WILL_DEL_SCRIPT_IDS")}))}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleClose:function(){this.$router.$avueRouter.closeTag(),this.$router.push({path:"/aggregate/api"})},checkChange:function(e){var t=this;if(!e)return!0;var a=!1;return Object.keys(e).forEach((function(r){if("config"!==r&&e[r]!==t.formData[r]&&(a=!0),"config"===r)try{var n=t.deepEqual(JSON.parse(e[r]),JSON.parse(t.formData[r]));a=!n||a}catch(i){console.log(i)}})),a},deepEqual:function(e,t){var a=["fixedHeaders","headers","fixedBody","body","fixedParams","params"];if(e===t)return!0;if("object"==Object(i["a"])(e)&&null!=e&&"object"==Object(i["a"])(t)&&null!=t){if(Object.keys(e).length<Object.keys(t).length)return!1;for(var r in e)if(t.hasOwnProperty(r)){if("[object Array]"===Object.prototype.toString.call(e[r])&&"[object Object]"===Object.prototype.toString.call(t[r])&&a.includes(r)){if(!this.checkJSONArray(e[r],t[r]))return!1}else if(!this.deepEqual(e[r],t[r]))return!1}else if("[]"!==JSON.stringify(e[r])&&"{}"!==JSON.stringify(e[r])&&("contentType"!==r||!e[r]||t[r]))return!1;return!0}return!1},checkJSONArray:function(e,t){for(var a=0;a<e.length;a++)if("object"==Object(i["a"])(e)&&null!=e[a].value||"object"==Object(i["a"])(e)&&null!=t[e[a].key]){if(!this.deepEqual(e[a].value,t[e[a].key]))return!1}else if(e[a].value!==t[e[a].key])return!1;return!0},init:function(){"add"===this.actionType&&(this.formData={}),this.getDetail()}}),beforeDestroy:function(){this.$store.commit("CLEAR_WILL_DEL_SCRIPT_IDS")}},O=x,w=(a("1401"),a("2877")),T=Object(w["a"])(O,r,n,!1,null,"33b7cdd6",null);t["default"]=T.exports},"6b32":function(e,t,a){},"6c43":function(e,t,a){"use strict";a("522c")},7162:function(e,t,a){"use strict";a("1941")},7476:function(e,t,a){"use strict";a("0452")},"74fd":function(e,t,a){},7539:function(e,t,a){"use strict";a("44f7")},7631:function(e,t,a){},"78e6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-detail-step"},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary",disabled:e.disabled},on:{click:function(t){return e.handleAdd()}}},[e._v("\n      添加步骤\n    ")]),a("div",{staticClass:"step-tip"},[e._v("\n      注意：可拖拽步骤进行排序, 网关从左到右依次执行步骤\n    ")])],1),a("div",{staticClass:"tab-sort",attrs:{id:"tabSort"}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-remove":e.handleDelete},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.stepList,(function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.name,name:t.name,closable:!e.disabled}},[a("step-item",e._b({ref:"stepItem",refInFor:!0,attrs:{data:t,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:data":function(e){t=e}}},"step-item",e.$attrs,!1))],1)})),1)],1)])},n=[],i=(a("20d6"),a("5df3"),a("96cf"),a("1da1")),o=(a("7f7f"),a("28a5"),a("c5f6"),a("ac6a"),a("4c07"));
/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e){return c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},p.apply(this,arguments)}function d(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}function f(e,t){if(null==e)return{};var a,r,n=d(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var h="1.14.0";function m(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var b=m(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=m(/Edge/i),v=m(/firefox/i),y=m(/safari/i)&&!m(/chrome/i)&&!m(/android/i),x=m(/iP(ad|od|hone)/i),O=m(/chrome/i)&&m(/android/i),w={capture:!1,passive:!1};function T(e,t,a){e.addEventListener(t,a,!b&&w)}function D(e,t,a){e.removeEventListener(t,a,!b&&w)}function _(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(a){return!1}return!1}}function S(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function k(e,t,a,r){if(e){a=a||document;do{if(null!=t&&(">"===t[0]?e.parentNode===a&&_(e,t):_(e,t))||r&&e===a)return e;if(e===a)break}while(e=S(e))}return null}var j,q=/\s+/g;function C(e,t,a){if(e&&t)if(e.classList)e.classList[a?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(q," ").replace(" "+t+" "," ");e.className=(r+(a?" "+t:"")).replace(q," ")}}function N(e,t,a){var r=e&&e.style;if(r){if(void 0===a)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(a=e.currentStyle),void 0===t?a:a[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=a+("string"===typeof a?"":"px")}}function $(e,t){var a="";if("string"===typeof e)a=e;else do{var r=N(e,"transform");r&&"none"!==r&&(a=r+" "+a)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(a)}function P(e,t,a){if(e){var r=e.getElementsByTagName(t),n=0,i=r.length;if(a)for(;n<i;n++)a(r[n],n);return r}return[]}function F(){var e=document.scrollingElement;return e||document.documentElement}function E(e,t,a,r,n){if(e.getBoundingClientRect||e===window){var i,o,s,l,c,u,p;if(e!==window&&e.parentNode&&e!==F()?(i=e.getBoundingClientRect(),o=i.top,s=i.left,l=i.bottom,c=i.right,u=i.height,p=i.width):(o=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,p=window.innerWidth),(t||a)&&e!==window&&(n=n||e.parentNode,!b))do{if(n&&n.getBoundingClientRect&&("none"!==N(n,"transform")||a&&"static"!==N(n,"position"))){var d=n.getBoundingClientRect();o-=d.top+parseInt(N(n,"border-top-width")),s-=d.left+parseInt(N(n,"border-left-width")),l=o+i.height,c=s+i.width;break}}while(n=n.parentNode);if(r&&e!==window){var f=$(n||e),h=f&&f.a,m=f&&f.d;f&&(o/=m,s/=h,p/=h,u/=m,l=o+u,c=s+p)}return{top:o,left:s,bottom:l,right:c,width:p,height:u}}}function I(e,t,a){var r=A(e,!0),n=E(e)[t];while(r){var i=E(r)[a],o=void 0;if(o="top"===a||"left"===a?n>=i:n<=i,!o)return r;if(r===F())break;r=A(r,!1)}return!1}function L(e,t,a,r){var n=0,i=0,o=e.children;while(i<o.length){if("none"!==o[i].style.display&&o[i]!==Qe.ghost&&(r||o[i]!==Qe.dragged)&&k(o[i],a.draggable,e,!1)){if(n===t)return o[i];n++}i++}return null}function B(e,t){var a=e.lastElementChild;while(a&&(a===Qe.ghost||"none"===N(a,"display")||t&&!_(a,t)))a=a.previousElementSibling;return a||null}function R(e,t){var a=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===Qe.clone||t&&!_(e,t)||a++;return a}function z(e){var t=0,a=0,r=F();if(e)do{var n=$(e),i=n.a,o=n.d;t+=e.scrollLeft*i,a+=e.scrollTop*o}while(e!==r&&(e=e.parentNode));return[t,a]}function M(e,t){for(var a in e)if(e.hasOwnProperty(a))for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[a][r])return Number(a);return-1}function A(e,t){if(!e||!e.getBoundingClientRect)return F();var a=e,r=!1;do{if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var n=N(a);if(a.clientWidth<a.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||a.clientHeight<a.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!a.getBoundingClientRect||a===document.body)return F();if(r||t)return a;r=!0}}}while(a=a.parentNode);return F()}function H(e,t){if(e&&t)for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}function U(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function J(e,t){return function(){if(!j){var a=arguments,r=this;1===a.length?e.call(r,a[0]):e.apply(r,a),j=setTimeout((function(){j=void 0}),t)}}}function V(e,t,a){e.scrollLeft+=t,e.scrollTop+=a}function W(e){var t=window.Polymer,a=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):a?a(e).clone(!0)[0]:e.cloneNode(!0)}var X="Sortable"+(new Date).getTime();function G(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==N(e,"display")&&e!==Qe.ghost){t.push({target:e,rect:E(e)});var a=l({},t[t.length-1].rect);if(e.thisAnimationDuration){var r=$(e,!0);r&&(a.top-=r.f,a.left-=r.e)}e.fromRect=a}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(M(t,{target:e}),1)},animateAll:function(a){var r=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof a&&a());var n=!1,i=0;t.forEach((function(e){var t=0,a=e.target,o=a.fromRect,s=E(a),l=a.prevFromRect,c=a.prevToRect,u=e.rect,p=$(a,!0);p&&(s.top-=p.f,s.left-=p.e),a.toRect=s,a.thisAnimationDuration&&U(l,s)&&!U(o,s)&&(u.top-s.top)/(u.left-s.left)===(o.top-s.top)/(o.left-s.left)&&(t=Q(u,l,c,r.options)),U(s,o)||(a.prevFromRect=o,a.prevToRect=s,t||(t=r.options.animation),r.animate(a,u,s,t)),t&&(n=!0,i=Math.max(i,t),clearTimeout(a.animationResetTimer),a.animationResetTimer=setTimeout((function(){a.animationTime=0,a.prevFromRect=null,a.fromRect=null,a.prevToRect=null,a.thisAnimationDuration=null}),t),a.thisAnimationDuration=t)})),clearTimeout(e),n?e=setTimeout((function(){"function"===typeof a&&a()}),i):"function"===typeof a&&a(),t=[]},animate:function(e,t,a,r){if(r){N(e,"transition",""),N(e,"transform","");var n=$(this.el),i=n&&n.a,o=n&&n.d,s=(t.left-a.left)/(i||1),l=(t.top-a.top)/(o||1);e.animatingX=!!s,e.animatingY=!!l,N(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=Y(e),N(e,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),N(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){N(e,"transition",""),N(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),r)}}}}function Y(e){return e.offsetWidth}function Q(e,t,a,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-a.top,2)+Math.pow(t.left-a.left,2))*r.animation}var K=[],Z={initializeByDefault:!0},ee={mount:function(e){for(var t in Z)Z.hasOwnProperty(t)&&!(t in e)&&(e[t]=Z[t]);K.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),K.push(e)},pluginEvent:function(e,t,a){var r=this;this.eventCanceled=!1,a.cancel=function(){r.eventCanceled=!0};var n=e+"Global";K.forEach((function(r){t[r.pluginName]&&(t[r.pluginName][n]&&t[r.pluginName][n](l({sortable:t},a)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](l({sortable:t},a)))}))},initializePlugins:function(e,t,a,r){for(var n in K.forEach((function(r){var n=r.pluginName;if(e.options[n]||r.initializeByDefault){var i=new r(e,t,e.options);i.sortable=e,i.options=e.options,e[n]=i,p(a,i.defaults)}})),e.options)if(e.options.hasOwnProperty(n)){var i=this.modifyOption(e,n,e.options[n]);"undefined"!==typeof i&&(e.options[n]=i)}},getEventProperties:function(e,t){var a={};return K.forEach((function(r){"function"===typeof r.eventProperties&&p(a,r.eventProperties.call(t[r.pluginName],e))})),a},modifyOption:function(e,t,a){var r;return K.forEach((function(n){e[n.pluginName]&&n.optionListeners&&"function"===typeof n.optionListeners[t]&&(r=n.optionListeners[t].call(e[n.pluginName],a))})),r}};function te(e){var t=e.sortable,a=e.rootEl,r=e.name,n=e.targetEl,i=e.cloneEl,o=e.toEl,s=e.fromEl,c=e.oldIndex,u=e.newIndex,p=e.oldDraggableIndex,d=e.newDraggableIndex,f=e.originalEvent,h=e.putSortable,m=e.extraEventProperties;if(t=t||a&&a[X],t){var v,y=t.options,x="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||b||g?(v=document.createEvent("Event"),v.initEvent(r,!0,!0)):v=new CustomEvent(r,{bubbles:!0,cancelable:!0}),v.to=o||a,v.from=s||a,v.item=n||a,v.clone=i,v.oldIndex=c,v.newIndex=u,v.oldDraggableIndex=p,v.newDraggableIndex=d,v.originalEvent=f,v.pullMode=h?h.lastPutMode:void 0;var O=l(l({},m),ee.getEventProperties(r,t));for(var w in O)v[w]=O[w];a&&a.dispatchEvent(v),y[x]&&y[x].call(t,v)}}var ae=["evt"],re=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.evt,n=f(a,ae);ee.pluginEvent.bind(Qe)(e,t,l({dragEl:ie,parentEl:oe,ghostEl:se,rootEl:le,nextEl:ce,lastDownEl:ue,cloneEl:pe,cloneHidden:de,dragStarted:_e,putSortable:ve,activeSortable:Qe.active,originalEvent:r,oldIndex:fe,oldDraggableIndex:me,newIndex:he,newDraggableIndex:be,hideGhostForTarget:We,unhideGhostForTarget:Xe,cloneNowHidden:function(){de=!0},cloneNowShown:function(){de=!1},dispatchSortableEvent:function(e){ne({sortable:t,name:e,originalEvent:r})}},n))};function ne(e){te(l({putSortable:ve,cloneEl:pe,targetEl:ie,rootEl:le,oldIndex:fe,oldDraggableIndex:me,newIndex:he,newDraggableIndex:be},e))}var ie,oe,se,le,ce,ue,pe,de,fe,he,me,be,ge,ve,ye,xe,Oe,we,Te,De,_e,Se,ke,je,qe,Ce=!1,Ne=!1,$e=[],Pe=!1,Fe=!1,Ee=[],Ie=!1,Le=[],Be="undefined"!==typeof document,Re=x,ze=g||b?"cssFloat":"float",Me=Be&&!O&&!x&&"draggable"in document.createElement("div"),Ae=function(){if(Be){if(b)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),He=function(e,t){var a=N(e),r=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),n=L(e,0,t),i=L(e,1,t),o=n&&N(n),s=i&&N(i),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+E(n).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+E(i).width;if("flex"===a.display)return"column"===a.flexDirection||"column-reverse"===a.flexDirection?"vertical":"horizontal";if("grid"===a.display)return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&o["float"]&&"none"!==o["float"]){var u="left"===o["float"]?"left":"right";return!i||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return n&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=r&&"none"===a[ze]||i&&"none"===a[ze]&&l+c>r)?"vertical":"horizontal"},Ue=function(e,t,a){var r=a?e.left:e.top,n=a?e.right:e.bottom,i=a?e.width:e.height,o=a?t.left:t.top,s=a?t.right:t.bottom,l=a?t.width:t.height;return r===o||n===s||r+i/2===o+l/2},Je=function(e,t){var a;return $e.some((function(r){var n=r[X].options.emptyInsertThreshold;if(n&&!B(r)){var i=E(r),o=e>=i.left-n&&e<=i.right+n,s=t>=i.top-n&&t<=i.bottom+n;return o&&s?a=r:void 0}})),a},Ve=function(e){function t(e,a){return function(r,n,i,o){var s=r.options.group.name&&n.options.group.name&&r.options.group.name===n.options.group.name;if(null==e&&(a||s))return!0;if(null==e||!1===e)return!1;if(a&&"clone"===e)return e;if("function"===typeof e)return t(e(r,n,i,o),a)(r,n,i,o);var l=(a?r:n).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var a={},r=e.group;r&&"object"==c(r)||(r={name:r}),a.name=r.name,a.checkPull=t(r.pull,!0),a.checkPut=t(r.put),a.revertClone=r.revertClone,e.group=a},We=function(){!Ae&&se&&N(se,"display","none")},Xe=function(){!Ae&&se&&N(se,"display","")};Be&&document.addEventListener("click",(function(e){if(Ne)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Ne=!1,!1}),!0);var Ge=function(e){if(ie){e=e.touches?e.touches[0]:e;var t=Je(e.clientX,e.clientY);if(t){var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=e[r]);a.target=a.rootEl=t,a.preventDefault=void 0,a.stopPropagation=void 0,t[X]._onDragOver(a)}}},Ye=function(e){ie&&ie.parentNode[X]._isOutsideThisEl(e.target)};function Qe(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=p({},t),e[X]=this;var a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return He(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Qe.supportPointer&&"PointerEvent"in window&&!y,emptyInsertThreshold:5};for(var r in ee.initializePlugins(this,e,a),a)!(r in t)&&(t[r]=a[r]);for(var n in Ve(t),this)"_"===n.charAt(0)&&"function"===typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!t.forceFallback&&Me,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?T(e,"pointerdown",this._onTapStart):(T(e,"mousedown",this._onTapStart),T(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(T(e,"dragover",this),T(e,"dragenter",this)),$e.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),p(this,G())}function Ke(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function Ze(e,t,a,r,n,i,o,s){var l,c,u=e[X],p=u.options.onMove;return!window.CustomEvent||b||g?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=a,l.draggedRect=r,l.related=n||t,l.relatedRect=i||E(t),l.willInsertAfter=s,l.originalEvent=o,e.dispatchEvent(l),p&&(c=p.call(u,l,o)),c}function et(e){e.draggable=!1}function tt(){Ie=!1}function at(e,t,a){var r=E(L(a.el,0,a.options,!0)),n=10;return t?e.clientX<r.left-n||e.clientY<r.top&&e.clientX<r.right:e.clientY<r.top-n||e.clientY<r.bottom&&e.clientX<r.left}function rt(e,t,a){var r=E(B(a.el,a.options.draggable)),n=10;return t?e.clientX>r.right+n||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+n}function nt(e,t,a,r,n,i,o,s){var l=r?e.clientY:e.clientX,c=r?a.height:a.width,u=r?a.top:a.left,p=r?a.bottom:a.right,d=!1;if(!o)if(s&&je<c*n){if(!Pe&&(1===ke?l>u+c*i/2:l<p-c*i/2)&&(Pe=!0),Pe)d=!0;else if(1===ke?l<u+je:l>p-je)return-ke}else if(l>u+c*(1-n)/2&&l<p-c*(1-n)/2)return it(t);return d=d||o,d&&(l<u+c*i/2||l>p-c*i/2)?l>u+c/2?1:-1:0}function it(e){return R(ie)<R(e)?1:-1}function ot(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,a=t.length,r=0;while(a--)r+=t.charCodeAt(a);return r.toString(36)}function st(e){Le.length=0;var t=e.getElementsByTagName("input"),a=t.length;while(a--){var r=t[a];r.checked&&Le.push(r)}}function lt(e){return setTimeout(e,0)}function ct(e){return clearTimeout(e)}Qe.prototype={constructor:Qe,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Se=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,ie):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,a=this.el,r=this.options,n=r.preventOnFilter,i=e.type,o=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(o||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=r.filter;if(st(a),!ie&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||r.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!y||!s||"SELECT"!==s.tagName.toUpperCase())&&(s=k(s,r.draggable,a,!1),(!s||!s.animated)&&ue!==s)){if(fe=R(s),me=R(s,r.draggable),"function"===typeof c){if(c.call(this,e,s,this))return ne({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:a,fromEl:a}),re("filter",t,{evt:e}),void(n&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(r){if(r=k(l,r.trim(),a,!1),r)return ne({sortable:t,rootEl:r,name:"filter",targetEl:s,fromEl:a,toEl:a}),re("filter",t,{evt:e}),!0})),c))return void(n&&e.cancelable&&e.preventDefault());r.handle&&!k(l,r.handle,a,!1)||this._prepareDragStart(e,o,s)}}},_prepareDragStart:function(e,t,a){var r,n=this,i=n.el,o=n.options,s=i.ownerDocument;if(a&&!ie&&a.parentNode===i){var l=E(a);if(le=i,ie=a,oe=ie.parentNode,ce=ie.nextSibling,ue=a,ge=o.group,Qe.dragged=ie,ye={target:ie,clientX:(t||e).clientX,clientY:(t||e).clientY},Te=ye.clientX-l.left,De=ye.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ie.style["will-change"]="all",r=function(){re("delayEnded",n,{evt:e}),Qe.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!v&&n.nativeDraggable&&(ie.draggable=!0),n._triggerDragStart(e,t),ne({sortable:n,name:"choose",originalEvent:e}),C(ie,o.chosenClass,!0))},o.ignore.split(",").forEach((function(e){P(ie,e.trim(),et)})),T(s,"dragover",Ge),T(s,"mousemove",Ge),T(s,"touchmove",Ge),T(s,"mouseup",n._onDrop),T(s,"touchend",n._onDrop),T(s,"touchcancel",n._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ie.draggable=!0),re("delayStart",this,{evt:e}),!o.delay||o.delayOnTouchOnly&&!t||this.nativeDraggable&&(g||b))r();else{if(Qe.eventCanceled)return void this._onDrop();T(s,"mouseup",n._disableDelayedDrag),T(s,"touchend",n._disableDelayedDrag),T(s,"touchcancel",n._disableDelayedDrag),T(s,"mousemove",n._delayedDragTouchMoveHandler),T(s,"touchmove",n._delayedDragTouchMoveHandler),o.supportPointer&&T(s,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(r,o.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ie&&et(ie),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._disableDelayedDrag),D(e,"touchend",this._disableDelayedDrag),D(e,"touchcancel",this._disableDelayedDrag),D(e,"mousemove",this._delayedDragTouchMoveHandler),D(e,"touchmove",this._delayedDragTouchMoveHandler),D(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?T(document,"pointermove",this._onTouchMove):T(document,t?"touchmove":"mousemove",this._onTouchMove):(T(ie,"dragend",this),T(le,"dragstart",this._onDragStart));try{document.selection?lt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(a){}},_dragStarted:function(e,t){if(Ce=!1,le&&ie){re("dragStarted",this,{evt:t}),this.nativeDraggable&&T(document,"dragover",Ye);var a=this.options;!e&&C(ie,a.dragClass,!1),C(ie,a.ghostClass,!0),Qe.active=this,e&&this._appendGhost(),ne({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(xe){this._lastX=xe.clientX,this._lastY=xe.clientY,We();var e=document.elementFromPoint(xe.clientX,xe.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(xe.clientX,xe.clientY),e===t)break;t=e}if(ie.parentNode[X]._isOutsideThisEl(e),t)do{if(t[X]){var a=void 0;if(a=t[X]._onDragOver({clientX:xe.clientX,clientY:xe.clientY,target:e,rootEl:t}),a&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Xe()}},_onTouchMove:function(e){if(ye){var t=this.options,a=t.fallbackTolerance,r=t.fallbackOffset,n=e.touches?e.touches[0]:e,i=se&&$(se,!0),o=se&&i&&i.a,s=se&&i&&i.d,l=Re&&qe&&z(qe),c=(n.clientX-ye.clientX+r.x)/(o||1)+(l?l[0]-Ee[0]:0)/(o||1),u=(n.clientY-ye.clientY+r.y)/(s||1)+(l?l[1]-Ee[1]:0)/(s||1);if(!Qe.active&&!Ce){if(a&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<a)return;this._onDragStart(e,!0)}if(se){i?(i.e+=c-(Oe||0),i.f+=u-(we||0)):i={a:1,b:0,c:0,d:1,e:c,f:u};var p="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");N(se,"webkitTransform",p),N(se,"mozTransform",p),N(se,"msTransform",p),N(se,"transform",p),Oe=c,we=u,xe=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!se){var e=this.options.fallbackOnBody?document.body:le,t=E(ie,!0,Re,!0,e),a=this.options;if(Re){qe=e;while("static"===N(qe,"position")&&"none"===N(qe,"transform")&&qe!==document)qe=qe.parentNode;qe!==document.body&&qe!==document.documentElement?(qe===document&&(qe=F()),t.top+=qe.scrollTop,t.left+=qe.scrollLeft):qe=F(),Ee=z(qe)}se=ie.cloneNode(!0),C(se,a.ghostClass,!1),C(se,a.fallbackClass,!0),C(se,a.dragClass,!0),N(se,"transition",""),N(se,"transform",""),N(se,"box-sizing","border-box"),N(se,"margin",0),N(se,"top",t.top),N(se,"left",t.left),N(se,"width",t.width),N(se,"height",t.height),N(se,"opacity","0.8"),N(se,"position",Re?"absolute":"fixed"),N(se,"zIndex","100000"),N(se,"pointerEvents","none"),Qe.ghost=se,e.appendChild(se),N(se,"transform-origin",Te/parseInt(se.style.width)*100+"% "+De/parseInt(se.style.height)*100+"%")}},_onDragStart:function(e,t){var a=this,r=e.dataTransfer,n=a.options;re("dragStart",this,{evt:e}),Qe.eventCanceled?this._onDrop():(re("setupClone",this),Qe.eventCanceled||(pe=W(ie),pe.draggable=!1,pe.style["will-change"]="",this._hideClone(),C(pe,this.options.chosenClass,!1),Qe.clone=pe),a.cloneId=lt((function(){re("clone",a),Qe.eventCanceled||(a.options.removeCloneOnHide||le.insertBefore(pe,ie),a._hideClone(),ne({sortable:a,name:"clone"}))})),!t&&C(ie,n.dragClass,!0),t?(Ne=!0,a._loopId=setInterval(a._emulateDragOver,50)):(D(document,"mouseup",a._onDrop),D(document,"touchend",a._onDrop),D(document,"touchcancel",a._onDrop),r&&(r.effectAllowed="move",n.setData&&n.setData.call(a,r,ie)),T(document,"drop",a),N(ie,"transform","translateZ(0)")),Ce=!0,a._dragStartId=lt(a._dragStarted.bind(a,t,e)),T(document,"selectstart",a),_e=!0,y&&N(document.body,"user-select","none"))},_onDragOver:function(e){var t,a,r,n,i=this.el,o=e.target,s=this.options,c=s.group,u=Qe.active,p=ge===c,d=s.sort,f=ve||u,h=this,m=!1;if(!Ie){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),o=k(o,s.draggable,i,!0),P("dragOver"),Qe.eventCanceled)return m;if(ie.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||h._ignoreWhileAnimating===o)return z(!1);if(Ne=!1,u&&!s.disabled&&(p?d||(r=oe!==le):ve===this||(this.lastPutMode=ge.checkPull(this,u,ie,e))&&c.checkPut(this,u,ie,e))){if(n="vertical"===this._getDirection(e,o),t=E(ie),P("dragOverValid"),Qe.eventCanceled)return m;if(r)return oe=le,F(),this._hideClone(),P("revert"),Qe.eventCanceled||(ce?le.insertBefore(ie,ce):le.appendChild(ie)),z(!0);var b=B(i,s.draggable);if(!b||rt(e,n,this)&&!b.animated){if(b===ie)return z(!1);if(b&&i===e.target&&(o=b),o&&(a=E(o)),!1!==Ze(le,i,ie,t,o,a,e,!!o))return F(),i.appendChild(ie),oe=i,M(),z(!0)}else if(b&&at(e,n,this)){var g=L(i,0,s,!0);if(g===ie)return z(!1);if(o=g,a=E(o),!1!==Ze(le,i,ie,t,o,a,e,!1))return F(),i.insertBefore(ie,g),oe=i,M(),z(!0)}else if(o.parentNode===i){a=E(o);var v,y,x=0,O=ie.parentNode!==i,w=!Ue(ie.animated&&ie.toRect||t,o.animated&&o.toRect||a,n),T=n?"top":"left",D=I(o,"top","top")||I(ie,"top","top"),_=D?D.scrollTop:void 0;if(Se!==o&&(v=a[T],Pe=!1,Fe=!w&&s.invertSwap||O),x=nt(e,o,a,n,w?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Fe,Se===o),0!==x){var S=R(ie);do{S-=x,y=oe.children[S]}while(y&&("none"===N(y,"display")||y===se))}if(0===x||y===o)return z(!1);Se=o,ke=x;var j=o.nextElementSibling,q=!1;q=1===x;var $=Ze(le,i,ie,t,o,a,e,q);if(!1!==$)return 1!==$&&-1!==$||(q=1===$),Ie=!0,setTimeout(tt,30),F(),q&&!j?i.appendChild(ie):o.parentNode.insertBefore(ie,q?j:o),D&&V(D,0,_-D.scrollTop),oe=ie.parentNode,void 0===v||Fe||(je=Math.abs(v-E(o)[T])),M(),z(!0)}if(i.contains(ie))return z(!1)}return!1}function P(s,c){re(s,h,l({evt:e,isOwner:p,axis:n?"vertical":"horizontal",revert:r,dragRect:t,targetRect:a,canSort:d,fromSortable:f,target:o,completed:z,onMove:function(a,r){return Ze(le,i,ie,t,a,E(a),e,r)},changed:M},c))}function F(){P("dragOverAnimationCapture"),h.captureAnimationState(),h!==f&&f.captureAnimationState()}function z(t){return P("dragOverCompleted",{insertion:t}),t&&(p?u._hideClone():u._showClone(h),h!==f&&(C(ie,ve?ve.options.ghostClass:u.options.ghostClass,!1),C(ie,s.ghostClass,!0)),ve!==h&&h!==Qe.active?ve=h:h===Qe.active&&ve&&(ve=null),f===h&&(h._ignoreWhileAnimating=o),h.animateAll((function(){P("dragOverAnimationComplete"),h._ignoreWhileAnimating=null})),h!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(o===ie&&!ie.animated||o===i&&!o.animated)&&(Se=null),s.dragoverBubble||e.rootEl||o===document||(ie.parentNode[X]._isOutsideThisEl(e.target),!t&&Ge(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function M(){he=R(ie),be=R(ie,s.draggable),ne({sortable:h,name:"change",toEl:i,newIndex:he,newDraggableIndex:be,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){D(document,"mousemove",this._onTouchMove),D(document,"touchmove",this._onTouchMove),D(document,"pointermove",this._onTouchMove),D(document,"dragover",Ge),D(document,"mousemove",Ge),D(document,"touchmove",Ge)},_offUpEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._onDrop),D(e,"touchend",this._onDrop),D(e,"pointerup",this._onDrop),D(e,"touchcancel",this._onDrop),D(document,"selectstart",this)},_onDrop:function(e){var t=this.el,a=this.options;he=R(ie),be=R(ie,a.draggable),re("drop",this,{evt:e}),oe=ie&&ie.parentNode,he=R(ie),be=R(ie,a.draggable),Qe.eventCanceled||(Ce=!1,Fe=!1,Pe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ct(this.cloneId),ct(this._dragStartId),this.nativeDraggable&&(D(document,"drop",this),D(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),y&&N(document.body,"user-select",""),N(ie,"transform",""),e&&(_e&&(e.cancelable&&e.preventDefault(),!a.dropBubble&&e.stopPropagation()),se&&se.parentNode&&se.parentNode.removeChild(se),(le===oe||ve&&"clone"!==ve.lastPutMode)&&pe&&pe.parentNode&&pe.parentNode.removeChild(pe),ie&&(this.nativeDraggable&&D(ie,"dragend",this),et(ie),ie.style["will-change"]="",_e&&!Ce&&C(ie,ve?ve.options.ghostClass:this.options.ghostClass,!1),C(ie,this.options.chosenClass,!1),ne({sortable:this,name:"unchoose",toEl:oe,newIndex:null,newDraggableIndex:null,originalEvent:e}),le!==oe?(he>=0&&(ne({rootEl:oe,name:"add",toEl:oe,fromEl:le,originalEvent:e}),ne({sortable:this,name:"remove",toEl:oe,originalEvent:e}),ne({rootEl:oe,name:"sort",toEl:oe,fromEl:le,originalEvent:e}),ne({sortable:this,name:"sort",toEl:oe,originalEvent:e})),ve&&ve.save()):he!==fe&&he>=0&&(ne({sortable:this,name:"update",toEl:oe,originalEvent:e}),ne({sortable:this,name:"sort",toEl:oe,originalEvent:e})),Qe.active&&(null!=he&&-1!==he||(he=fe,be=me),ne({sortable:this,name:"end",toEl:oe,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){re("nulling",this),le=ie=oe=se=ce=pe=ue=de=ye=xe=_e=he=be=fe=me=Se=ke=ve=ge=Qe.dragged=Qe.ghost=Qe.clone=Qe.active=null,Le.forEach((function(e){e.checked=!0})),Le.length=Oe=we=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ie&&(this._onDragOver(e),Ke(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],a=this.el.children,r=0,n=a.length,i=this.options;r<n;r++)e=a[r],k(e,i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||ot(e));return t},sort:function(e,t){var a={},r=this.el;this.toArray().forEach((function(e,t){var n=r.children[t];k(n,this.options.draggable,r,!1)&&(a[e]=n)}),this),t&&this.captureAnimationState(),e.forEach((function(e){a[e]&&(r.removeChild(a[e]),r.appendChild(a[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return k(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var a=this.options;if(void 0===t)return a[e];var r=ee.modifyOption(this,e,t);a[e]="undefined"!==typeof r?r:t,"group"===e&&Ve(a)},destroy:function(){re("destroy",this);var e=this.el;e[X]=null,D(e,"mousedown",this._onTapStart),D(e,"touchstart",this._onTapStart),D(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(D(e,"dragover",this),D(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),$e.splice($e.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!de){if(re("hideClone",this),Qe.eventCanceled)return;N(pe,"display","none"),this.options.removeCloneOnHide&&pe.parentNode&&pe.parentNode.removeChild(pe),de=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(de){if(re("showClone",this),Qe.eventCanceled)return;ie.parentNode!=le||this.options.group.revertClone?ce?le.insertBefore(pe,ce):le.appendChild(pe):le.insertBefore(pe,ie),this.options.group.revertClone&&this.animate(ie,pe),N(pe,"display",""),de=!1}}else this._hideClone()}},Be&&T(document,"touchmove",(function(e){(Qe.active||Ce)&&e.cancelable&&e.preventDefault()})),Qe.utils={on:T,off:D,css:N,find:P,is:function(e,t){return!!k(e,t,e,!1)},extend:H,throttle:J,closest:k,toggleClass:C,clone:W,index:R,nextTick:lt,cancelNextTick:ct,detectDirection:He,getChild:L},Qe.get=function(e){return e[X]},Qe.mount=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Qe.utils=l(l({},Qe.utils),e.utils)),ee.mount(e)}))},Qe.create=function(e,t){return new Qe(e,t)},Qe.version=h;var ut,pt,dt,ft=[];function ht(){ft.forEach((function(e){clearInterval(e.pid)})),ft=[]}J((function(e,t,a,r){if(t.scroll){var n,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=F(),u=!1;pt!==a&&(pt=a,ht(),ut=t.scroll,n=t.scrollFn,!0===ut&&(ut=A(a,!0)));var p=0,d=ut;do{var f=d,h=E(f),m=h.top,b=h.bottom,g=h.left,v=h.right,y=h.width,x=h.height,O=void 0,w=void 0,T=f.scrollWidth,D=f.scrollHeight,_=N(f),S=f.scrollLeft,k=f.scrollTop;f===c?(O=y<T&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),w=x<D&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(O=y<T&&("auto"===_.overflowX||"scroll"===_.overflowX),w=x<D&&("auto"===_.overflowY||"scroll"===_.overflowY));var j=O&&(Math.abs(v-i)<=s&&S+y<T)-(Math.abs(g-i)<=s&&!!S),q=w&&(Math.abs(b-o)<=s&&k+x<D)-(Math.abs(m-o)<=s&&!!k);if(!ft[p])for(var C=0;C<=p;C++)ft[C]||(ft[C]={});ft[p].vx==j&&ft[p].vy==q&&ft[p].el===f||(ft[p].el=f,ft[p].vx=j,ft[p].vy=q,clearInterval(ft[p].pid),0==j&&0==q||(u=!0,ft[p].pid=setInterval(function(){r&&0===this.layer&&Qe.active._onTouchMove(dt);var t=ft[this.layer].vy?ft[this.layer].vy*l:0,a=ft[this.layer].vx?ft[this.layer].vx*l:0;"function"===typeof n&&"continue"!==n.call(Qe.dragged.parentNode[X],a,t,e,dt,ft[this.layer].el)||V(ft[this.layer].el,a,t)}.bind({layer:p}),24))),p++}while(t.bubbleScroll&&d!==c&&(d=A(d,!1)));u}}),30);var mt=function(e){var t=e.originalEvent,a=e.putSortable,r=e.dragEl,n=e.activeSortable,i=e.dispatchSortableEvent,o=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=a||n;o();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(u)&&(i("spill"),this.onSpill({dragEl:r,putSortable:a}))}};function bt(){}function gt(){}bt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,a=e.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var r=L(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),a&&a.animateAll()},drop:mt},p(bt,{pluginName:"revertOnSpill"}),gt.prototype={onSpill:function(e){var t=e.dragEl,a=e.putSortable,r=a||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:mt},p(gt,{pluginName:"removeOnSpill"});var vt=Qe,yt="step",xt={name:"api-detail-step",data:function(){return{tabIndex:0,stepList:[],currentTab:"",maxIndex:0}},inheritAttrs:!1,props:{data:{type:Array,default:function(){return{}}},disabled:{type:Boolean,default:!1},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{stepItem:o["default"]},computed:{tabCount:function(){return this.stepList&&this.stepList.length||0},originId:function(){return this.$route.query.originId}},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},originId:function(){this.maxIndex=0}},methods:{initData:function(){var e=this;if(this.stepList=this.data||[],this.stepList.length>0){var t=[];this.stepList.forEach((function(e){t.push(Number(e.name.split(yt)[1]))}));var a=Math.max.apply(Math,t);this.maxIndex=this.maxIndex>a?this.maxIndex:a,this.currentTab=this.stepList.filter((function(t){return t.name===e.currentTab})).length>0?this.currentTab:this.stepList[0].name}else this.currentTab=""},emitData:function(){this.$emit("update:data",this.stepList)},validate:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.emitData(),t=!0,!(this.stepList&&this.stepList.length>0)){e.next=9;break}return a=[],this.$refs.stepItem.forEach((function(e){a.push(e.validate())})),e.next=7,Promise.all(a).then((function(){t=!0})).catch((function(){t=!1}));case 7:e.next=10;break;case 9:t=!0;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleAdd:function(){this.currentTab="".concat(yt).concat(++this.maxIndex),this.stepList.push({name:this.currentTab,stop:!1,dataMapping:{},requests:[]})},handleDelete:function(e){var t=this;this.$confirm("确定删除步骤【".concat(e,"】?"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.stepList.findIndex((function(t){return t.name==e}));a>-1&&(t.stepList.splice(a,1),t.stepList.length>0&&t.currentTab===e?t.currentTab=t.stepList[t.stepList.length-1].name:0===t.stepList.length&&(t.currentTab="".concat(yt).concat(t.maxIndex+1)))}))}},mounted:function(){var e=this;vt.create(document.querySelector("#tabSort .el-tabs__nav"),{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",dragClass:"sortable-chosen",onEnd:function(t){var a=e.stepList.splice(t.oldIndex,1)[0];e.stepList.splice(t.newIndex,0,a)}})}},Ot=xt,wt=(a("da31"),a("2877")),Tt=Object(wt["a"])(Ot,r,n,!1,null,null,null);t["default"]=Tt.exports},7964:function(e,t,a){},"7c76":function(e,t,a){},"7ede":function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return p}));a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-test/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-test/detail"),method:"get",params:{id:e}})},u=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-test/remove"),method:"post",params:{ids:e}})},p=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-test/save"),method:"post",data:e})}},8065:function(e,t,a){},"81d7":function(e,t,a){"use strict";a("ef00")},8352:function(e,t,a){},"83b0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.reload?a("avue-crud",{staticClass:"param-table",attrs:{option:e.option,data:e.data,"table-loading":e.loading},on:{"row-del":e.rowDel,"row-update":e.addUpdate},scopedSlots:e._u([{key:"key",fn:function(t){var r=t.row,n=t.size;return[r.$cellEdit?a("div",[a("el-input",{staticStyle:{"padding-right":"6px"},attrs:{size:n,placeholder:"请输入字段(必填)",clearable:""},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"row.key"}}),a("el-tooltip",{staticClass:"tooltip",attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[e._v("\n            JSON和XML字段支持多级，用点分隔，如 user.name 或 user.address.city；"),a("br"),e._v("\n            form-data和x-www-form-urlencoded字段不支持多级；\n          ")])]),a("i",{staticClass:"el-icon-question"})])],1):a("div",[e._v(" "+e._s(r.key))])]}},{key:"paramType",fn:function(t){var r=t.row,n=t.size;return[r.$cellEdit?a("el-select",{attrs:{size:n,placeholder:"请选择类型(必填)"},on:{change:function(t){return e.paramTypeChange(r)}},model:{value:r.paramType,callback:function(t){e.$set(r,"paramType",t)},expression:"row.paramType"}},e._l(e.paramType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("div",[e._v("\n      "+e._s(e.getParamTypeName(r.paramType))+"\n    ")])]}},{key:"dataType",fn:function(t){var r=t.row,n=t.size;return[r.$cellEdit?a("div",["fixed"===r.paramType?a("el-select",{attrs:{size:n,placeholder:"请选择数据类型(必填)",clearable:""},on:{change:function(t){return e.dataTypeChange(r)}},model:{value:r.dataType,callback:function(t){e.$set(r,"dataType",t)},expression:"row.dataType"}},e._l(e.fixedDataType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):"quote"===r.paramType||"fn"===r.paramType?a("el-select",{staticStyle:{"padding-right":"6px"},attrs:{size:n,placeholder:"请选择数据类型(非必填)",clearable:""},on:{change:function(t){return e.dataTypeChange(r)}},model:{value:r.dataType,callback:function(t){e.$set(r,"dataType",t)},expression:"row.dataType"}},e._l(e.quoteDataType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"quote"===r.paramType?a("el-tooltip",{staticClass:"tooltip",attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[e._v("\n          引用值的数据类型为非必填，默认使用引用值原来的类型；"),a("br"),e._v("\n          如果选择了数据类型，系统会将引用值强转为所选类型，"),a("br"),e._v("\n          请确保引用值可以被强转为所选数据类型，如果强转失败会抛异常。"),a("br"),e._v("\n          如：引用值为abc, 数据类型选int时会导致强转失败。\n        ")])]),a("i",{staticClass:"el-icon-question"})]):e._e()],1):a("div",[e._v(" "+e._s(r.dataType))])]}},{key:"value",fn:function(t){var r=t.row,n=t.size;return[r.$cellEdit?a("div",["script"===r.paramType?a("el-button",{attrs:{type:"text",size:n},on:{click:function(t){return e.openScript(r)}}},[e._v("\n        "+e._s(r.value||"新增脚本")+"\n      ")]):"fixed"===r.paramType&&"boolean"===r.dataType?a("el-select",{attrs:{placeholder:"请选择字段值(必填)",size:n,clearable:""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}},[a("el-option",{attrs:{label:"true",value:!0}}),a("el-option",{attrs:{label:"false",value:!1}})],1):"fixed"===r.paramType&&"number"===r.dataType?a("el-input",{attrs:{size:n,placeholder:"请输入字段值(必填)",type:"number",clearable:""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}}):a("el-input",{staticStyle:{"padding-right":"6px"},attrs:{size:n,placeholder:"请输入字段值(必填)",clearable:""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}}),"quote"===r.paramType?a("quote-tooltip"):e._e(),"fn"===r.paramType?a("div",{staticClass:"fun-desc"},[e._v("\n        函数列表请参考： \n        "),a("el-link",{staticClass:"link",attrs:{type:"primary",href:"https://www.fizzgate.com/guide/aggregate/function.html",target:"_blank"}},[e._v("函数文档")])],1):e._e()],1):!r.$cellEdit&&"script"===r.paramType&&e.disabled?a("div",{staticClass:"script-view",on:{click:function(t){return e.openScript(r)}}},[e._v("\n      "+e._s(r.value||"无")+"\n    ")]):a("div",[e._v(" "+e._s(r.value))]),"script"===r.paramType?a("script-dialog",{attrs:{visible:e.scriptVisible,disabled:e.disabled,"business-type":e.businessType,callback:e.scriptCallback,id:e.scriptId,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:visible":function(t){e.scriptVisible=t},"update:id":function(t){e.scriptId=t}}}):e._e()]}}],null,!1,3140453166)}):e._e()},n=[],i=(a("6762"),a("2fdb"),a("7514"),a("456d"),a("ac6a"),a("53ca")),o=(a("28a5"),a("c5f6"),a("d263"),a("2fa9")),s=a("cc38"),l=a("e683"),c=a("c54a"),u="raw",p={name:"params-table",props:{fixed:{type:[Object,Array],default:function(){return{}}},quote:{type:[Object,Array],default:function(){return{}}},disabled:{type:Boolean,default:!1},businessType:{type:String},rules:{type:Object},multipleValues:{type:Boolean,default:!1},isDelScriptWithHttp:{type:Boolean,default:!0}},data:function(){return{reload:!1,loading:!1,scriptVisible:!1,scriptId:"",scriptRow:{},scriptContent:"",fixedDataType:l["f"],quoteDataType:l["h"],paramType:l["g"],data:[],option:{addBtn:!1,editBtn:!1,cancelBtn:!1,refreshBtn:!1,columnBtn:!1,cellBtn:!0,addBtnText:"添加",addRowBtn:!this.disabled,menu:!this.disabled,column:[{label:"字段",prop:"key",slot:!0,cell:!0,rules:[{required:!0,message:"请输入字段",trigger:"blur"}]},{label:"类型",prop:"paramType",type:"select",slot:!0,cell:!0,rules:[{required:!0,message:"请选择类型",trigger:"blur"}]},{label:"数据类型",prop:"dataType",slot:!0,cell:!0},{label:"值",prop:"value",cell:!0,slot:!0}]}}},components:{scriptDialog:o["default"],quoteTooltip:s["default"]},computed:{dataObj:function(){return{fixed:this.fixed,quote:this.quote}}},watch:{rules:{immediate:!0,deep:!0,handler:function(e){e&&this.initOption()}},dataObj:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},disabled:function(e,t){e!==t&&(this.option.addRowBtn=!e,this.option.menu=!e)},multipleValues:{immediate:!0,handler:function(){this.emitData()}}},methods:{initOption:function(){var e=this;this.option.column=this.option.column.map((function(t){if("key"===t.prop){var a=e.rules&&e.rules["key"]||[];t.rules=t.rules.concat(a)}if("value"===t.prop){var r=e.rules&&e.rules["value"]||[];t.rules=(t.rules||[]).concat(r)}return t}))},addUpdate:function(e,t,a,r){return"fixed"!==e.paramType||"json"!==e.dataType||Object(c["m"])(e.value)?"fixed"!==e.paramType||e.dataType?e.value||!1===e.value||0===e.value?"fn"===e.paramType&&"fn."!==e.value.substring(0,3)?(this.$message.error("第".concat(t+1,'行: 函数类型的字段值应该以 "fn." 开头')),r(),!1):("fixed"===e.paramType&&"number"===e.dataType&&(e.value=Number(e.value)),this.emitData(),r(),void a()):(this.$message.error("第".concat(t+1,"行: 字段值不能为空")),r(),!1):(this.$message.error("第".concat(t+1,"行: 固定值类型字段请选择数据类型")),r(),!1):(this.$message.error("第".concat(t+1,"行: json类型字段值格式不正确！")),r(),!1)},renderQuoteItem:function(e,t){if("string"===typeof t){var a=t.split(" "),r=this.quoteDataType.filter((function(e){return e.value===a[0]}));a=r.length>0?[r[0].value,t.substring(r[0].value.length+1)]:[t];var n=a[a.length-1]&&"fn."===a[a.length-1].substring(0,3);return{key:e,paramType:n?"fn":"quote",dataType:a.length>1?a[0]:u,value:a[a.length-1]}}if("object"===Object(i["a"])(t))return{key:e,paramType:"script",dataType:"",value:t}},initData:function(e){var t=this,a=e.fixed,r=e.quote;this.reload=!1;var n=[];Object(c["d"])(a,"object")?Object.keys(a).forEach((function(e){var t=Object(c["c"])(a[e])?"json":Object(i["a"])(a[e])||"",r=Object(c["c"])(a[e])?JSON.stringify(a[e]):a[e];n.push({key:e,paramType:"fixed",dataType:t,value:r})})):Object(c["d"])(a,"array")&&a.forEach((function(e){var t=Object(c["c"])(e.value)?"json":Object(i["a"])(e.value)||"",a=Object(c["c"])(e.value)?JSON.stringify(e.value):e.value;n.push({key:e.key,paramType:"fixed",dataType:t,value:a})})),Object(c["d"])(r,"object")?Object.keys(r).forEach((function(e){n.push(t.renderQuoteItem(e,r[e]))})):Object(c["d"])(r,"array")&&r.forEach((function(e){n.push(t.renderQuoteItem(e.key,e.value))})),this.data=n,this.reload=!0},handleData:function(){if(this.multipleValues){var e=[],t=[];return this.data.forEach((function(a){if("fixed"===a.paramType){var r="json"===a.dataType?JSON.parse(a.value):a.value;e.push({key:a.key,value:r})}else"quote"===a.paramType||"fn"===a.paramType?t.push({key:a.key,value:a.dataType&&a.dataType!==u?"".concat(a.dataType," ").concat(a.value):a.value}):t.push({key:a.key,value:a.value})})),{fixed:e,quote:t}}var a={},r={};return this.data.forEach((function(e){"fixed"===e.paramType?a[e.key]="json"===e.dataType?JSON.parse(e.value):e.value:"quote"===e.paramType||"fn"===e.paramType?r[e.key]=e.dataType&&e.dataType!==u?"".concat(e.dataType," ").concat(e.value):e.value:r[e.key]=e.value})),{fixed:a,quote:r}},getParamTypeName:function(e){var t=this.paramType.find((function(t){return t.value===e}))||{};return t.label||""},getScriptId:function(e){if(!e)return this.scriptId="","";var t="string"===typeof e?JSON.parse(e):e;return this.scriptId=t["aggregate_config_script_id"]||"",this.scriptId},dataTypeChange:function(e){"fixed"===e.paramType&&e.value?e.value=null:["quote","fn"].includes(e.paramType)&&!e.dataType&&(e.dataType=u)},paramTypeChange:function(e){["quote","fn"].includes(e.paramType)?e.dataType=u:e.dataType&&(e.dataType=""),e.value&&(e.value=null)},openScript:function(e){this.scriptRow=e,this.scriptId=this.getScriptId(e.value||""),this.scriptVisible=!0},scriptCallback:function(){this.scriptRow.value=this.scriptId?{aggregate_config_script_id:this.scriptId}:"",this.data[this.scriptRow.$index]=Object.assign({},this.scriptRow)},emitData:function(){var e=this.handleData(),t=e.fixed,a=e.quote;this.$emit("update:fixed",t),this.$emit("update:quote",a)},rowDel:function(e,t){this.isDelScriptWithHttp||"script"!==e.paramType||this.$store.commit("SET_WILL_DEL_SCRIPT_IDS",e.value.aggregate_config_script_id),this.data.splice(t,1),this.emitData()}}},d=p,f=(a("7539"),a("af7b"),a("2877")),h=Object(f["a"])(d,r,n,!1,null,"c38081b6",null);t["default"]=h.exports},8602:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",{staticClass:"aggregate-api"},[a("avue-crud",{ref:"crud",attrs:{"before-open":e.beforeOpen,data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList,"cell-class-name":"api-cell"},on:{"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"currentState",fn:function(t){var r=t.row;return[r.debugMode?a("el-tag",{staticStyle:{"margin-bottom":"6px"},attrs:{size:"small"}},[e._v("Debug")]):e._e(),a("api-state-tag",{attrs:{"is-modified":r.isModified,"current-state":r.currentState,"approval-state":r.approvalState}})]}},{key:"menu",fn:function(t){var r=t.row,n=t.type,i=t.size;return[e.permissionList.viewBtn?a("el-button",{attrs:{icon:"el-icon-view",size:i,type:n},on:{click:function(t){return e.goDetail(r,"view")}}},[e._v("查看\n      ")]):e._e(),e.permissionList.editBtn&&1!==r.approvalState&&2!==r.approvalState&&3!==r.approvalState?a("el-button",{attrs:{icon:"el-icon-edit",size:i,type:n},on:{click:function(t){return e.goDetail(r,"edit")}}},[e._v("编辑\n      ")]):e._e(),e.permissionList.delBtn?a("el-button",{attrs:{icon:"el-icon-delete",size:i,type:n},on:{click:function(t){return e.rowDel(r)}}},[e._v("删除\n      ")]):e._e(),a("el-button",{attrs:{icon:"el-icon-box",size:i,type:n},on:{click:function(t){return e.rowTest(r)}}},[e._v("测试\n      ")]),e.permissionList.offlineBtn&&3===r.approvalState?a("el-button",{attrs:{icon:"el-icon-bottom",size:i,type:n},on:{click:function(t){return e.offline(r)}}},[e._v("下线\n      ")]):e._e(),e.permissionList.publishBtn&&2===r.approvalState?a("el-button",{attrs:{icon:"el-icon-s-promotion",size:i,type:n},on:{click:function(t){return e.publish(r)}}},[e._v("发布\n      ")]):e._e(),0!==r.currentState?a("el-button",{attrs:{icon:"el-icon-s-operation",size:i,type:n},on:{click:function(t){return e.publishHistory(r)}}},[e._v("发布历史\n      ")]):e._e()]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("template",{slot:"menuLeft"},[e.permissionList.importBtn?a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-upload2",plain:""},on:{click:e.handleImport}},[e._v("导 入\n      ")]):e._e(),e.permissionList.exportBtn?a("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-download",plain:""},on:{click:e.handleExport}},[e._v("导 出\n      ")]):e._e(),e.permissionList.applyBtn?a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleApply}},[e._v("发布|下线申请\n      ")]):e._e(),e.permissionList.debugBtn?a("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(t){return e.handleDebug(1)}}},[e._v("打开调试模式\n      ")]):e._e(),e.permissionList.debugBtn?a("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(t){return e.handleDebug(0)}}},[e._v("关闭调试模式\n      ")]):e._e()],1)],2),a("el-dialog",{attrs:{title:"导入配置","append-to-body":"",visible:e.importDialog,"show-close":!1,width:"600px"},on:{"update:visible":function(t){e.importDialog=t}}},[a("div",[a("el-upload",{ref:"upload",attrs:{accept:"application/json",limit:1,"file-list":e.fileList,"on-change":e.handleChange,"on-remove":e.handleRemove,"on-exceed":e.handleExceed,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传json文件")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticStyle:{padding:"12px 0"}},[a("el-checkbox",{model:{value:e.importData.force,callback:function(t){e.$set(e.importData,"force",t)},expression:"importData.force"}},[e._v("强制覆盖")])],1),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitUpload}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:e.closeImportDialog}},[e._v("取 消")])],1)]),a("publish-dialog",{attrs:{visible:e.publishDialog.visible,name:e.publishDialog.name,id:e.publishDialog.id,callback:e.refreshChange},on:{"update:visible":function(t){return e.$set(e.publishDialog,"visible",t)}}}),a("apply-dialog",{attrs:{visible:e.applyDialog.visible,list:e.applyDialog.list,callback:e.refreshChange},on:{"update:visible":function(t){return e.$set(e.applyDialog,"visible",t)}}})],1)},n=[],i=(a("8e6e"),a("456d"),a("7f7f"),a("ac6a"),a("ade3")),o=a("708f"),s=a("f874"),l=a("5880"),c=a("047b"),u=a("247e"),p=a("5a57");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},selectionList:[],option:{dialogWidth:900,border:!0,index:!0,selection:!0,tip:!1,editBtn:!1,delBtn:!1,columnBtn:!1,menuPosition:"right",column:[{label:"所属服务",prop:"serviceName",search:!0},{label:"接口名",prop:"name",minWidth:120,search:!0},{label:"方法",prop:"method",width:80},{label:"路径",prop:"path",minWidth:120,search:!0},{label:"开发人员",prop:"developer"},{label:"状态",prop:"currentState",slot:!0,width:100,align:"center",search:!0,type:"select",dicData:s["a"]},{label:"版本号",prop:"version",width:80}]},data:[],publishDialog:{visible:!1,title:"接口",name:"",id:""},applyDialog:{visible:!1,list:[]},importDialog:!1,fileList:[],files:null,importData:{force:!1},importHeaders:{"Content-Type":"multipart/form-data"}}},computed:f(f({},Object(l["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.aggregate_api_add,!1),viewBtn:this.vaildData(this.permission.aggregate_api_view,!1),delBtn:this.vaildData(this.permission.aggregate_api_delete,!1),editBtn:this.vaildData(this.permission.aggregate_api_edit,!1),publishBtn:this.vaildData(this.permission.aggregate_api_publish,!1),offlineBtn:this.vaildData(this.permission.aggregate_api_offline,!1),importBtn:this.vaildData(this.permission.aggregate_api_import,!1),exportBtn:this.vaildData(this.permission.aggregate_api_export,!1),applyBtn:this.vaildData(this.permission.aggregate_api_apply,!1),debugBtn:this.vaildData(this.permission.aggregate_api_debug,!1)}},ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")},serviceName:function(){return this.$route.query.serviceName||""}}),components:{publishDialog:c["default"],applyDialog:u["default"],apiStateTag:p["default"]},beforeRouteUpdate:function(e,t,a){e.fullPath!==t.fullPath&&(this.option.column=this.option.column.map((function(e){return e.searchValue&&(e.searchValue=""),e})),this.query={},a(),this.onLoad(this.page,Object.assign({},e.query)))},watch:{serviceName:{immediate:!0,handler:function(e){e&&(this.query.serviceName=e,this.option.column[0].searchValue=e)}},data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{goDetail:function(e,t){if(this.form=e,"add"===t||this.form.id){var a="/aggregate/detail/".concat(t);this.$router.push({path:a,query:{originId:this.form.id}})}else this.$message.error("数据缺失，无法操作！")},handleApply:function(){this.applyDialog.visible=!0},offline:function(e){var t=this;this.$confirm("确定下线【".concat(e.name,"】此接口吗?"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["i"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"下线成功"})}))},publish:function(e){e.id?(this.publishDialog.visible=!0,this.publishDialog.name=e.name,this.publishDialog.id=e.id):this.$message.error("数据缺失，无法发布！")},publishHistory:function(e){e.id?this.$router.push({path:"/aggregate/history",query:{originId:e.id}}):this.$message.error("数据缺失，无法查看发布历史！")},handleImport:function(){this.importDialog=!0},handleChange:function(e,t){this.files=t&&t[0]},handleRemove:function(e,t){this.files=t&&t[0]},handleExceed:function(){this.$message.warning("文件超出个数限制，每次仅允许导入一个文件!")},closeImportDialog:function(){this.importDialog=!1,this.fileList=[],this.files=null},beforeUpload:function(e){var t=e&&e.raw,a=t&&t.name||"",r=t&&t.type||"",n=r.indexOf("json")>-1||!1;return a?n||(this.$message.warning("上传模板只能是json格式!"),!1):(this.$message.warning("请选择要上传的文件！"),!1)},submitUpload:function(){var e=this,t=this.beforeUpload(this.files);if(!t)return!1;var a=this.files.raw,r=a.name,n=new FormData;n.append("file",a,r),n.append("force",this.importData.force),Object(o["h"])(n).then((function(){e.$message.success("导入成功"),e.importDialog=!1,e.onLoad(e.page)}))},handleExport:function(){var e=this;0!==this.selectionList.length?this.$confirm("确定将选择数据导出?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["d"])(e.ids)})).then((function(){e.onLoad(e.page),e.$message({type:"success",message:"导出成功"}),e.$refs.crud.toggleSelection()})):this.$message.warning("请选择至少一条数据")},rowDel:function(e){var t=this;this.$confirm("确定删除【".concat(e.name,"】此接口吗?"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["l"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},rowTest:function(e){var t=this.$route;this.$router.push({path:"/aggregate/test",query:{originId:e.id,redirect:encodeURIComponent(t.fullPath)}})},handleDebug:function(e){var t=this;0!==this.selectionList.length?this.$confirm(e?"确定打开调试模式?":"确定关闭调试模式?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return e?Object(o["j"])(t.ids):Object(o["c"])(t.ids)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"模式调整成功"}),t.$refs.crud.toggleSelection()})):this.$message.warning("请选择至少一条数据")},handleDelete:function(){var e=this;0!==this.selectionList.length?this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["l"])(e.ids)})).then((function(){e.onLoad(e.page),e.$message({type:"success",message:"删除成功"}),e.$refs.crud.toggleSelection()})):this.$message.warning("请选择至少一条数据")},beforeOpen:function(e,t){if("add"===t||this.form.id){var a="/aggregate/detail/".concat(t);this.$router.push({path:a,query:{originId:this.form.id}})}else this.$message.error("数据缺失，无法操作！")},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud&&this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(o["g"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1,t.selectionClear()}))}}},m=h,b=(a("7162"),a("2877")),g=Object(b["a"])(m,r,n,!1,null,null,null);t["default"]=g.exports},8890:function(e,t,a){"use strict";a("7631")},"892a":function(e,t,a){"use strict";a.r(t);a("a481"),a("7f7f");var r,n,i=a("65d4"),o=a("9653"),s={name:"log-detail",mixins:[i["default"]],data:function(){return{disabled:!0,businessType:"log"}},methods:{getDetail:function(){var e=this;if(!this.originId)return this.formData={},void(this.baseConfigs={});Object(o["a"])(this.originId).then((function(t){e.formData=t.data.data||{};var a=Object.assign({},e.formData),r=a.id,n=void 0===r?"":r,i=a.serviceId,o=void 0===i?"":i,s=a.name,l=void 0===s?"":s,c=a.method,u=void 0===c?"":c,p=a.path,d=void 0===p?"":p,f=a.developer,h=void 0===f?"":f,m=a.description,b=void 0===m?"":m,g=a.serviceName,v=void 0===g?"":g;d=d.replace("/proxy/".concat(v,"/"),""),e.baseConfigs={id:n,serviceId:o,name:l,method:u,path:d,developer:h,description:b,serviceName:v}}))}}},l=s,c=a("2877"),u=Object(c["a"])(l,r,n,!1,null,"b4acce16",null);t["default"]=u.exports},"8c58":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,size:"small"}},[e.disabled?e._e():a("el-button",{staticClass:"add-btn",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("添加")]),e.reload?a("el-table",{ref:"multipleTable",staticClass:"value-table",attrs:{data:e.form.list,size:"small"},on:{"selection-change":e.handleSelectionChange}},[e.disabled?e._e():a("el-table-column",{attrs:{type:"selection",width:"30",selectable:e.selectable}}),a("el-table-column",{attrs:{prop:"key",label:"字段"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,n=t.$index;return[e.disabled?a("span",[e._v(e._s(r.key))]):a("el-form-item",{attrs:{prop:"list."+n+".key",rules:e.form.rules.key,"show-message":!1}},[e.isUpload?a("el-input",{model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"row.key"}},[a("el-select",{staticClass:"input-with-select",attrs:{slot:"append",placeholder:"请选择"},on:{change:function(e){r.value=""}},slot:"append",model:{value:r.type,callback:function(t){e.$set(r,"type",t)},expression:"row.type"}},[a("el-option",{attrs:{label:"Text",value:"Text"}}),a("el-option",{attrs:{label:"File",value:"File"}})],1)],1):a("el-input",{model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"row.key"}})],1)]}}],null,!1,806158917)}),a("el-table-column",{attrs:{prop:"value",label:"值"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,n=t.$index;return[a("el-form-item",{attrs:{prop:"list."+n+".value",rules:r.required?e.form.rules.value:[],"show-message":!1}},[a("div",{staticClass:"value-row"},[e.isUpload&&"File"===r.type&&!e.disabled?a("div",[a("span",{staticClass:"upload"},[e._v("\n                Select Files\n                "),a("input",{staticClass:"upload-input",attrs:{type:"file",multiple:"multiplt"},on:{change:function(t){return e.getFile(t,n)}}})])]):e._e(),"File"===r.type||e.disabled?a("span",[e._v(e._s(r.value))]):a("el-input",{staticClass:"value-input",model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"row.value"}})],1)])]}}],null,!1,196387330)}),e.disabled?e._e():a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,n=t.$index;return[a("el-button",{attrs:{size:"small",type:"text",disabled:r.required},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])]}}],null,!1,602089605)})],1):e._e()],1)},n=[],i=(a("8e6e"),a("7f7f"),a("ade3")),o=(a("20d6"),a("456d"),a("ac6a"),a("c54a"));function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var c={name:"valuesTable",props:{data:{type:[Object,Array],default:function(){return[]}},disabled:{type:Boolean,default:!1},isUpload:{type:Boolean,default:!1}},data:function(){return{reload:!1,multipleSelection:[],form:{list:[],rules:{key:[{required:!0,message:"请输入字段",trigger:"blur"}],value:[{required:!0,message:"请输入字段值或上传文件",trigger:"blur"}]}},isFirst:!0}},watch:{isUpload:{immediate:!0,handler:function(){var e=this.data.length>=this.form.list.length?this.data:this.form.list;this.initData(e)}}},methods:{addRow:function(){var e={key:"",value:"",type:"Text"};this.form.list.push(e),this.toggleSelection([e])},handleDelete:function(e){this.form.list.splice(e,1)},handleSelectionChange:function(e){this.multipleSelection=e},initData:function(e){var t=this;if(this.reload=!1,Object(o["d"])(e,"object")){var a=[];Object.keys(e).forEach((function(t){a.push({key:t,value:void 0===e[t]?"":e[t]})})),this.form.list=a}else{var r=[];e.forEach((function(e){t.isUpload&&!e.type&&(e.type="Text"),(t.isUpload||"File"!==e.type)&&(void 0===e.value&&(e.value=""),r.push(e))})),this.form.list=r}this.reload=!0,this.$nextTick((function(){t.toggleSelection(t.form.list),t.isFirst=!1}))},handleData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=[];return this.form.list.forEach((function(r){var n=e.isUpload?{files:r.files,type:r.type}:{},i=e.multipleSelection.findIndex((function(e){return e===r}))>-1;(!t&&i||t)&&a.push(l({key:r.key,value:r.value,required:r.required},n))})),a},selectable:function(e){return!e.required},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e,!0)})):this.$refs.multipleTable.clearSelection()},getFile:function(e,t){for(var a=this,r=e.target.files,n=[],i=0;i<r.length;i++)n.push(r[i].name);var o=this.multipleSelection.findIndex((function(e){return e===a.form.list[t]})),s=l(l({},this.form.list[t]),{},{value:n.join(","),files:r});this.form.list.splice(t,1,s),o>-1&&this.toggleSelection([s])},emitData:function(){var e=this.handleData();this.$emit("update:data",e),this.$emit("updateData",e)},getCheckedData:function(){return this.handleData(!1)||[]},getAllData:function(){return this.handleData(!0)||[]},validate:function(){var e=this;return new Promise((function(t,a){e.$refs.form.validate((function(e){e?t():a("请完善表单！")}))}))}},mounted:function(){var e=this,t=[];Array.isArray(this.data)?t=this.data.length>=this.form.list.length?this.data:this.form.list:Object.keys(this.data).forEach((function(a){t.push({key:a,value:e.data[a]})})),this.initData(t)}},u=c,p=(a("0209"),a("2877")),d=Object(p["a"])(u,r,n,!1,null,null,null);t["default"]=d.exports},"8e9c":function(e,t,a){"use strict";a("db22")},"921f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"xml-info",attrs:{title:"XML和JSON间的转换规则",center:"","append-to-body":"",visible:e.visible,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("ul",[a("li",[e._v("每个元素（节点）都会转换成一个JSON对象, 子元素转换为JSON对象的字段")]),a("li",[e._v("元素的属性名转换为JSON对象的一个字段，字段名会加上连字符前缀")]),a("li",[e._v("当元素有属性时元素的内容转换为JSON对象的#text字段")])]),a("el-table",{attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"xml",label:"XML"}}),a("el-table-column",{attrs:{prop:"json",label:"JSON"}})],1)],1)},n=[],i={name:"xml-info",data:function(){return{tableData:[{xml:'<?xml version="1.0" encoding="utf-8"?>\n<library>\n    <owner>John Doe</owner>\n    <book id="007">James Bond</book>\n    <book id="000">Book for the dummies</book>\n</library>',json:'转换为JSON:\n{\n  "library": {\n    "owner": "John Doe",\n    "book": [\n      {\n        "-id": "007",\n        "#text": "James Bond"\n      },\n      {\n        "-id": "000",\n        "#text": "Book for the dummies"\n      }\n    ]\n  }\n}'},{xml:'<?xml version="1.0" encoding="utf-8"?>\n<library>\n    <owner>John Doe</owner>\n    <date>2021-03-31</date>\n</library>',json:'转换为JSON:\n{\n  "library": {\n    "owner": "John Doe",\n    "date": "2021-03-31"\n  }\n}'},{xml:'<?xml version="1.0" encoding="utf-8"?>\n<library>\n    <book>James Bond</book>\n</library>',json:'默认转换为JSON:\n{\n  "library": { "book": "James Bond" }\n}\n\n可通过指明数组节点路径/library/book转换为JSON:\n{\n  "library": { "book": [“James Bond”] }\n}'}]}},props:{visible:{type:Boolean,default:!1}},methods:{handleClose:function(e){this.$emit("update:visible",!1),e&&e()}}},o=i,s=(a("36a5"),a("2877")),l=Object(s["a"])(o,r,n,!1,null,null,null);t["default"]=l.exports},9288:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"exec-break"},[a("h3",{staticClass:"header"},[a("i",{staticClass:"el-icon-edit-outline avue-group__icon"}),e._v(e._s(e.title)+"\n    "),a("span",{staticClass:"explain"},[e._v("\n      "+e._s(e.info)+"\n    ")]),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],staticClass:"el-icon-circle-plus-outline add-btn",on:{click:e.add}})]),a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:e.conditions.length>0,expression:"conditions.length > 0"}],attrs:{"tab-position":"top",closable:!e.disabled,lazy:"",type:"border-card",size:"small"},on:{"tab-remove":e.remove},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.conditions,(function(t,r){return a("el-tab-pane",{key:t._uuid,attrs:{label:""+e.title+(r+1),name:""+e.title+(r+1)}},[a("compare-form",{ref:"compareForm",refInFor:!0,attrs:{data:t,disabled:e.disabled},on:{emitData:function(t){return e.conditions.splice(r,1,t)}}})],1)})),1),a("avue-empty",{directives:[{name:"show",rawName:"v-show",value:0===e.conditions.length,expression:"conditions.length === 0"}]})],1)},n=[],i=(a("5df3"),a("ac6a"),a("28a5"),a("c5f6"),a("e815")),o={name:"execBreak",components:{compareForm:i["default"]},props:{data:Object,disabled:Boolean,title:String,info:String},data:function(){return{activeTab:"",conditions:[],rules:{},uuid:1}},watch:{data:{deep:!0,immediate:!0,handler:function(e){var t=this;if(0===this.conditions.length&&e.map((function(e){return e._uuid=++t.uuid,e})),this.conditions=Object.assign([],e)||[],this.conditions.length>0){if(this.activeTab){var a=Number(this.activeTab.split(this.title)[1])-1;if(a<this.conditions.length)return}this.activeTab="".concat(this.title).concat(this.conditions.length)}}}},methods:{add:function(){this.conditions.push({_uuid:++this.uuid,type:"condition",desc:"",value1:{type:"",value:""},operator:"",value2:{type:"",value:""}}),this.activeTab="".concat(this.title).concat(this.conditions.length)},remove:function(e){var t=Number(e.split(this.title)[1])-1;this.conditions.splice(t,1),this.conditions.length>0&&this.activeTab&&t+1===Number(this.activeTab.split(this.title)[1])&&(this.activeTab="".concat(this.title).concat(this.conditions.length)),this.emitData()},validate:function(){var e=this;return new Promise((function(t,a){if(e.conditions&&e.conditions.length>0){var r=[];e.$refs.compareForm.forEach((function(e){r.push(e.validate())})),Promise.all(r).then((function(){e.emitData(),t()})).catch((function(){e.$message({showClose:!0,message:"请完善".concat(e.title,"！"),type:"warning"}),a()}))}else t()}))},emitData:function(){this.$emit("update:data",this.conditions),this.$emit("emitData",this.conditions)}}},s=o,l=(a("6093"),a("2877")),c=Object(l["a"])(s,r,n,!1,null,"b10afece",null);t["default"]=c.exports},"936b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"api-header"},[e.serviceName?a("el-tag",[e._v("服务["+e._s(e.serviceName)+"]")]):e._e(),e._v(" \n  "),a("b",[e.apiName?a("span",[e._v("["+e._s(e.apiName)+"]")]):e._e(),e._v("\n    "+e._s(e.pageName)+"\n  ")])],1)},n=[],i=(a("7f7f"),{name:"index",props:{serviceName:{type:String,default:""},apiName:{type:String,default:""},pageName:{type:String,default:function(){return this.$route.name||""}}}}),o=i,s=a("2877"),l=Object(s["a"])(o,r,n,!1,null,"359ed195",null);t["default"]=l.exports},"942a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticClass:"data-params"},[e.hasBody?a("el-tab-pane",{attrs:{label:e.bodyName}},[e.getParamsKeys(e.fixedBody,e.body)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.fixedBody,e.body),max:10,type:"success"}},[e._v(" "+e._s(e.bodyName)+" ")])],1):e._e(),e._t("body"),a("params-table",{attrs:{"business-type":e.businessType,fixed:e.fixedBody,quote:e.body,rules:e.bodyRules,"multiple-values":e.multipleValues&&("multipart/form-data"===e.contentType||"application/x-www-form-urlencoded"===e.contentType),disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:fixed":function(t){e.fixedBody=t},"update:quote":function(t){e.body=t}}})],2):e._e(),e.hasHeader?a("el-tab-pane",{attrs:{label:e.headerName}},[e.getParamsKeys(e.fixedHeaders,e.headers)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.fixedHeaders,e.headers),max:10,type:"success"}},[e._v(" "+e._s(e.headerName)+" ")])],1):e._e(),e._t("header"),a("params-table",{attrs:{"business-type":e.businessType,fixed:e.fixedHeaders,quote:e.headers,rules:e.headerRules,"multiple-values":e.multipleValues,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:fixed":function(t){e.fixedHeaders=t},"update:quote":function(t){e.headers=t}}})],2):e._e(),e.hasQuery?a("el-tab-pane",{attrs:{label:e.queryName}},[e.getParamsKeys(e.fixedParams,e.params)>0?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{value:e.getParamsKeys(e.fixedParams,e.params),max:10,type:"success"}},[e._v(" "+e._s(e.queryName)+" ")])],1):e._e(),e._t("query"),a("params-table",{attrs:{"business-type":e.businessType,fixed:e.fixedParams,quote:e.params,rules:e.queryRules,"multiple-values":e.multipleValues,disabled:e.disabled,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:fixed":function(t){e.fixedParams=t},"update:quote":function(t){e.params=t}}})],2):e._e(),e.hasScript?a("el-tab-pane",{attrs:{label:"脚本"}},[e.scriptId?a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{attrs:{"is-dot":"",type:"paimary"}},[e._v("脚本")])],1):e._e(),a("el-form",{ref:"scriptForm",attrs:{model:e.scriptForm,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"脚本配置"}},[e.scriptId?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openScript()}}},[e._v("\n            "+e._s("{ aggregate_config_script_id: "+e.scriptId+" }")+"\n          ")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteScript(e.scriptId)}}},[e._v("\n            删除\n          ")])],1):a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){return e.openScript()}}},[e._v("\n          "+e._s(e.disabled?"无":"新增")+"\n        ")]),a("script-dialog",{attrs:{visible:e.scriptVisible,content:e.scriptContent,"business-type":e.businessType,disabled:e.disabled,id:e.scriptId,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:visible":function(t){e.scriptVisible=t},"update:content":function(t){e.scriptContent=t},"update:id":function(t){e.scriptId=t}}})],1)],1)],1):e._e()],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),o=a("83b0"),s=a("2fa9"),l=a("5880");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"data-request",data:function(){return{activeTab:"header",fixedHeaders:{},headers:{},fixedBody:{},body:{},fixedParams:{},params:{},script:{},scriptVisible:!1,scriptId:"",scriptContent:"",others:{}}},props:{data:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},headerName:{type:String,default:"请求头"},bodyName:{type:String,default:"请求体"},queryName:{type:String,default:"Query参数"},headerRules:{type:Object},bodyRules:{type:Object},queryRules:{type:Object},hasHeader:{type:Boolean,default:!0},hasBody:{type:Boolean,default:!0},hasQuery:{type:Boolean,default:!0},hasScript:{type:Boolean,default:!0},businessType:{type:String},isDelWithHttp:{type:Boolean,default:!0},multipleValues:{type:Boolean,default:!1},contentType:{type:String,default:""},isDelScriptWithHttp:{type:Boolean,default:!0}},computed:{dataObj:function(){var e=Object.assign({},this.others);return this.hasHeader&&(e.fixedHeaders=this.fixedHeaders,e.headers=this.headers),this.hasBody&&(e.fixedBody=this.fixedBody,e.body=this.body),this.hasQuery&&(e.fixedParams=this.fixedParams,e.params=this.params),this.hasScript&&(e.script=this.scriptId?{aggregate_config_script_id:this.scriptId}:{}),e}},components:{paramsTable:o["default"],scriptDialog:s["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},script:{immediate:!0,deep:!0,handler:function(e){var t=e&&"string"===typeof e?JSON.parse(e):e;this.scriptId=t["aggregate_config_script_id"]||""}},dataObj:{deep:!0,handler:function(){this.emitData()}}},methods:u(u({},Object(l["mapActions"])(["removeScript"])),{},{getParamsKeys:function(e,t){var a=Object.keys(e||{})||[],r=Object.keys(t||{})||[],n=a.concat(r)||[];return n.length},emitData:function(){this.$emit("update:data",this.dataObj)},initData:function(e){var t=this;e=e||this.data||{};var a=e,r=a.fixedHeaders,n=a.headers,i=a.fixedBody,o=a.body,s=a.script,l=a.fixedParams,c=a.params;this.fixedHeaders=r||{},this.headers=n||{},this.fixedBody=i||{},this.body=o||{},this.fixedParams=l||{},this.params=c||{},this.script=s||{},Object.keys(e).forEach((function(a){var r=["fixedHeaders","headers","fixedBody","body","script","fixedParams","params"].some((function(e){return e===a}));r||(t.others[a]=e[a])}))},openScript:function(){this.scriptVisible=!0},deleteScript:function(e){var t=this;this.$confirm("确定删除该脚本?",{type:"warning"}).then((function(){t.isDelScriptWithHttp?t.removeScript(e).then((function(){t.scriptId="",t.$message.success("删除成功")})):(t.$store.commit("SET_WILL_DEL_SCRIPT_IDS",e),t.scriptId="",t.$message.success("删除成功"))}))}})},d=p,f=(a("a2f9"),a("2877")),h=Object(f["a"])(d,r,n,!1,null,null,null);t["default"]=h.exports},9470:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"codeEditor",style:{height:e.height+"px"}},[a("code-viewer",{attrs:{ctype:e.type,contents:e.content,highlight:e.highlight,options:e.options,"read-only":e.disabled,onChange:e.onChange,dirty:e.dirty,ctrls:e.ctrls},on:{"update:contents":function(t){e.content=t}}})],1)},n=[],i=(a("c5f6"),a("fb4e")),o={name:"CodeEditor",components:{CodeViewer:i["default"]},props:{type:{type:String,default:"javascript"},content:{type:String,default:""},disabled:{type:Boolean,default:!1},height:{type:[Number,String],default:240},highlight:Object,options:{type:Object,default:function(){return{}}},onChange:{type:Function,default:function(){}},dirty:{default:!1,type:[Boolean,Number]},ctrls:Boolean},watch:{content:function(e){this.$emit("update:content",e),this.$emit("change",e)}}},s=o,l=(a("dbc0"),a("2877")),c=Object(l["a"])(s,r,n,!1,null,"6160ba68",null);t["default"]=c.exports},9607:function(e,t,a){"use strict";a("6b32")},9653:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-op-log/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-op-log/detail/").concat(e),method:"get",params:{id:e}})}},"970c":function(e,t,a){},"98f3":function(e,t,a){},"9a39":function(e,t,a){},"9aa2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",{staticClass:"aggregate-operation-log"},[a("avue-crud",{ref:"crud",attrs:{data:e.data,page:e.page,search:e.search,option:e.option,"table-loading":e.loading},on:{"update:page":function(t){e.page=t},"update:search":function(t){e.search=t},"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"opTimeSearch",fn:function(t){var r=t.size;return[a("datetime-range",{attrs:{defaultValue:e.search.opTime,"start-placeholder":"开始日期","end-placeholder":"结束日期",type:"datetime",size:r,defaultTime:["00:00:00","00:00:00"]},on:{"update:defaultValue":function(t){return e.$set(e.search,"opTime",t)},"update:default-value":function(t){return e.$set(e.search,"opTime",t)},change:function(t){return e.search.opTime=t}}})]}},{key:"opType",fn:function(t){var a=t.row;t.size;return[e._v("\n      "+e._s(e.getOperateStateName(a.opType))+"\n    ")]}},{key:"menu",fn:function(t){var r=t.row,n=t.type,i=t.size;return[a("el-button",{attrs:{icon:"el-icon-view",size:i,type:n},on:{click:function(t){return e.rowView(r)}}},[e._v("查看\n      ")])]}}])})],1)},n=[],i=(a("7514"),a("8e7d")),o=a("9653"),s=[{label:"新增",value:0},{label:"修改",value:1},{label:"发布",value:2},{label:"下线",value:3},{label:"回滚",value:4},{label:"删除",value:5}],l={name:"operation-log",components:{datetimeRange:i["default"]},data:function(){return{search:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{menuWidth:80,border:!0,index:!0,addBtn:!1,editBtn:!1,delBtn:!1,columnBtn:!1,menuPosition:"right",column:[{label:"所属服务",prop:"serviceName",search:!0},{label:"接口名",prop:"name",search:!0},{label:"方法",prop:"method",width:80},{label:"路径",prop:"path",minWidth:120,search:!0},{label:"操作人",prop:"opBy"},{label:"类型",prop:"opType",slot:!0,width:80,search:!0,type:"select",dicData:s},{label:"操作时间",prop:"opTime",searchRange:!0,search:!0,searchslot:!0,searchSpan:12,type:"datetime",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"版本号",prop:"version",width:80}]},data:[]}},watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{getOperateStateName:function(e){var t=s.find((function(t){return parseInt(t.value)===e}));return t&&t.label||e||"-"},rowView:function(e){e.id?this.$router.push({path:"/aggregate/logDetail",query:{originId:e.id}}):this.$message.error("数据缺失，无法操作！")},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){e.opTime&&e.opTime.length>0&&(e.opTimeStart=e.opTime[0]||"",e.opTimeEnd=e.opTime[1]||"",delete e.opTime),this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(o["b"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))}}},c=l,u=a("2877"),p=Object(u["a"])(c,r,n,!1,null,"40d054d6",null);t["default"]=p.exports},a2f9:function(e,t,a){"use strict";a("7c76")},a4a9:function(e,t,a){"use strict";a("e00e")},a50b:function(e,t,a){"use strict";a("e17c")},add5:function(e,t,a){"use strict";a("7964")},af60:function(e,t,a){},af7b:function(e,t,a){"use strict";a("6385")},b152:function(e,t,a){"use strict";a("9a39")},ba11:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("api-header",{attrs:{"service-name":e.serviceName,"api-name":e.apiName,"page-name":"接口发布历史版本"}})],1),a("avue-crud",{ref:"crud",attrs:{data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"publishType",fn:function(t){var r=t.row;return[0==r.publishType?a("el-tag",{attrs:{type:"success"}},[e._v("普通发布")]):e._e(),1==r.publishType?a("el-tag",{attrs:{type:"warning"}},[e._v("回滚")]):e._e()]}},{key:"menu",fn:function(t){var r=t.row,n=t.type,i=t.size,o=t.index;return[a("el-button",{attrs:{size:i,type:n},on:{click:function(t){return e.rowView(r)}}},[e._v("查看")]),0!==o&&e.permissionList.rollbackBtn?a("el-button",{attrs:{size:i,type:n},on:{click:function(t){return e.rowBack(r)}}},[e._v("回滚")]):e._e(),a("br"),0===o?a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("当前版本")]):e._e()]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("ade3")),o=a("2b3f"),s=a("5880"),l=a("936b");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{dialogWidth:900,border:!0,addBtn:!1,editBtn:!1,delBtn:!1,columnBtn:!1,menuWidth:100,column:[{label:"ID",prop:"id",width:50},{label:"所属服务",prop:"serviceName"},{label:"接口名",prop:"name"},{label:"方法",prop:"method",width:80},{label:"路径",prop:"path",minWidth:120},{label:"发布人",prop:"publisher",width:80},{label:"发布状态",prop:"publishType",slot:!0,width:92},{label:"发布日期",prop:"createTime"},{label:"备注",prop:"remark"},{label:"版本号",prop:"version",width:80}]},data:[]}},components:{apiHeader:l["default"]},computed:u(u({},Object(s["mapGetters"])(["permission"])),{},{permissionList:function(){return{rollbackBtn:this.vaildData(this.permission.aggregate_history_rollback,!1)}},originId:function(){return this.$route.query.originId||""},serviceName:function(){var e=this.data[0]||{};return e.serviceName||""},apiName:function(){var e=this.data[0]||{};return e.name||""}}),watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{rowView:function(e){this.$router.push({path:"/aggregate/historyDetail",query:{originId:e.id}})},rowBack:function(e){var t=this;this.$confirm("确定回滚至【ID-".concat(e.id,"】的发布记录吗?"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["c"])({id:e.id,remark:""})})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"回滚成功"})}))},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(o["b"])(e.currentPage,e.pageSize,Object.assign(a,this.query,{originId:this.originId,descs:"create_time"})).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))}}},d=p,f=a("2877"),h=Object(f["a"])(d,r,n,!1,null,null,null);t["default"]=h.exports},bbb7:function(e,t,a){"use strict";a("74fd")},beac:function(e,t,a){"use strict";a("e54b")},c6bd:function(e,t,a){},c983:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"add-btn-con"},[a("span",{staticClass:"label"},[e._v("添加组件")]),a("el-dropdown",{on:{command:e.commandHandle}},[a("el-button",{staticClass:"add-btn",attrs:{size:"small",type:"primary",plain:"",disabled:e.disabled}},[e._v("\n        选择组件"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{staticClass:"select-menu",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.optionsList,(function(t){return a("el-dropdown-item",{key:t.value,attrs:{command:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])})),1)],1)],1),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.components.length>0,expression:"components.length > 0"}],staticStyle:{width:"100%"},attrs:{data:e.components,border:"",size:"small"}},[a("el-table-column",{attrs:{prop:"date",label:"组件名","min-width":"70%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("descFilter")(t.row))+"\n        "),a("el-tooltip",{staticClass:"tooltip",attrs:{effect:"dark",content:e.tooltipInfo[t.row.type],placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])]}}])}),a("el-table-column",{attrs:{prop:"address",label:"操作","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.moveVisible(t.row,t.$index,"up")?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.move(t.$index,"up")}}},[a("i",{staticClass:"el-icon-top"}),e._v("上移\n        ")]):e._e(),e.moveVisible(t.row,t.$index,"down")?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.move(t.$index,"down")}}},[a("i",{staticClass:"el-icon-bottom"}),e._v("下移\n        ")]):e._e(),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.goDetail(t.row,"detail",t.$index)}}},[a("i",{staticClass:"el-icon-view"}),e._v("查看\n        ")]),e.disabled?e._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.goDetail(t.row,"edit",t.$index)}}},[a("i",{staticClass:"el-icon-edit"}),e._v("编辑\n        ")]),e.disabled?e._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteHandle(t.$index)}}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 删除\n        ")])]}}])})],1)],1),e.conditionVisible?a("condition-dialog",{attrs:{visible:e.conditionVisible,dialogType:e.dialogType,data:e.dialogData,disabled:e.disabled},on:{changeDrawer:function(t){e.command="",e.dialogData=null},emitData:e.getConditionData}}):e._e(),e.circleVisible?a("circleDialog",{attrs:{visible:e.circleVisible,dialogType:e.dialogType,data:e.dialogData,disabled:e.disabled},on:{changeDrawer:function(t){e.command="",e.dialogData=null},emitData:e.getCircleData}}):e._e()],1)},n=[],i=(a("28a5"),a("7f7f"),a("ac6a"),a("20d6"),a("44d0")),o=a("04b4"),s=[{value:"condition",label:"判断条件"},{value:"circle",label:"循环组件"}],l={name:"addComponent",props:{disabled:Boolean,data:Object},components:{conditionDialog:i["default"],circleDialog:o["default"]},data:function(){return{command:"",components:[],maxIndex:0,tooltipInfo:{condition:"当判断条件为true时执行该步骤",circle:"当数据源不为空时执行循环"},dialogData:null,dialogType:"",operaIndex:-1}},computed:{conditionVisible:function(){return this.command===s[0].value},circleVisible:function(){return this.command===s[1].value},optionsList:function(){var e=this.components.findIndex((function(e){return"circle"===e.type}));return e>-1?[s[0]]:s}},watch:{components:{immediate:!0,deep:!0,handler:function(){this.emitData()}},data:{immediate:!0,deep:!0,handler:function(e){this.components=e}}},filters:{descFilter:function(e){var t="condition"===e.type?"判断条件":"循环组件";return e.desc?"".concat(t,"  (").concat(e.desc,")"):t}},methods:{moveVisible:function(e,t,a){var r=this.components.filter((function(e){return e.type===s[0].value})).length||0;return"up"===a?0!==t&&e.type===s[0].value&&!this.disabled:t<r-1&&e.type===s[0].value&&!this.disabled},commandHandle:function(e){this.command=e,this.dialogType="add"},goDetail:function(e,t,a){this.command=e.type,this.dialogType=t,this.dialogData=e,this.operaIndex=a},getConditionData:function(e){var t=0;this.components.forEach((function(e,a){"condition"===e.type&&(t=++a,e.name&&parseInt(e.name.split("判断条件")[1])>a&&(t=e.name.split("判断条件")[1]))})),this.maxIndex=t,"add"===this.dialogType?1===this.optionsList.length?this.components.splice(this.components.length-1,0,e):this.components.splice(this.components.length,0,e):this.components.splice(this.operaIndex,1,e)},getCircleData:function(e){"add"===this.dialogType?this.components.push(e):this.components.splice(this.operaIndex,1,e)},move:function(e,t){var a=this.components[e];this.components.splice(e,1),"up"===t?this.components.splice(e-1,0,a):this.components.splice(e+1,0,a)},deleteHandle:function(e){var t=this;this.$confirm("确定删除该条件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.components.splice(e,1)}))},emitData:function(){this.$emit("update:data",this.components)}}},c=l,u=(a("add5"),a("f039"),a("2877")),p=Object(u["a"])(c,r,n,!1,null,"7e36b3ca",null);t["default"]=p.exports},cb79:function(e,t,a){},cc38:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tooltip",{staticClass:"tooltip",attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},e._l(e.tips,(function(t,r){return a("span",{key:r},[0!==r?a("br"):e._e(),e._v("\n      "+e._s(t.title)),a("br"),e._v("\n      "+e._s(t.msg)),a("br")])})),0),a("i",{staticClass:"el-icon-question"})])},n=[],i={name:"quoteTooltip",data:function(){return{tips:[{title:"获取入参请求头aaa的值",msg:"input.request.headers.aaa"},{title:"获取入参请求体bbb字段的值",msg:"input.request.body.bbb"},{title:"获取入参URL Query参数fff字段的值",msg:"input.request.params.fff"},{title:"获取步骤1里request1的请求头ccc的值",msg:"step1.request1.request.headers.ccc"},{title:"获取步骤1里request1的响应体ddd的值",msg:"step1.request1.response.body.ddd"},{title:"获取步骤1结果里eee的值",msg:"step1.result.eee"},{title:"获取步骤1里request1的响应码的值",msg:"step1.request1.response.httpStatus"},{title:"获取公共资源account.name的值",msg:"g.account.name"},{title:"默认值：input.request.body.bbb|123",msg:"管道符|后面是默认值，当引用值为空时返回默认值"}]}}},o=i,s=(a("b152"),a("2877")),l=Object(s["a"])(o,r,n,!1,null,"e43a0e30",null);t["default"]=l.exports},d4b0:function(e,t,a){},da31:function(e,t,a){"use strict";a("61cb")},db22:function(e,t,a){},dbc0:function(e,t,a){"use strict";a("af60")},e00e:function(e,t,a){},e17c:function(e,t,a){},e282:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-test-wrapper"},[a("el-container",{staticClass:"api-test-container"},[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:e.historyList.length>0,expression:"historyList.length > 0"}],attrs:{width:"240px"}},[a("div",{staticClass:"history-header"},[e._v("历史测试记录")]),a("el-menu",{staticClass:"history-list",attrs:{"default-active":e.menuActive},on:{open:e.handleOpen,close:e.handleClose}},e._l(e.historyList,(function(t,r){return a("el-menu-item",{key:r,attrs:{index:r},on:{click:function(a){return e.addHistoryTab(t)}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("\n            "+e._s(t.name)+"\n            "),a("transition",{attrs:{name:"fade"}},[a("el-button",{staticClass:"history-del-btn",attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return a.stopPropagation(),e.deleteHistory(t,r)}}})],1)],1)])})),1)],1),a("el-container",[a("el-header",[a("api-header",{attrs:{"service-name":e.serviceName,"api-name":e.apiName,"page-name":"接口测试"}}),a("div",[a("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返回")])],1)],1),a("el-main",[a("el-tabs",{attrs:{type:"card"},on:{edit:e.handleStepTabs},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.testList,(function(t,r){return a("el-tab-pane",{key:r,attrs:{name:r+1,closable:0!==r}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("el-badge",{staticClass:"item",attrs:{"is-dot":!t.id}},[e._v(e._s(t.name))])],1),a("test-item",{ref:"testItem",refInFor:!0,attrs:{data:t,domain:e.domain,refresh:e.addRefresh},on:{"update:data":function(e){t=e}}})],1)})),1)],1)],1)],1)],1)},n=[],i=(a("ac6a"),a("7f7f"),a("7ede")),o=a("708f"),s=a("936b"),l=a("efcc"),c={name:"test",data:function(){return{formData:{},currentTab:1,menuActive:"",tabIndex:1,testList:[{name:"New Test"}],historyList:[],domain:"",loading:!1}},computed:{originId:function(){return this.$route.query.originId||""},serviceName:function(){return this.formData.serviceName||""},apiName:function(){return this.formData.title||""},tabCount:function(){return this.testList&&this.testList.length||1}},created:function(){this.init()},components:{apiHeader:s["default"],testItem:l["default"]},beforeRouteUpdate:function(e,t,a){e.fullPath!==t.fullPath&&(a((function(e){e.originId||e.goBack()})),this.init())},methods:{init:function(){this.getList(),this.initData()},initData:function(){var e=this;if(this.currentTab=1,!this.originId)return this.formData={},void(this.testList=[{name:"New Test"}]);Object(o["f"])(this.originId).then((function(t){var a=t.data.data||{},r=a.id,n=a.method,i=a.path,o=a.name,s=a.serviceName,l=a.formalPathPrefix;e.formData={configId:r,method:n,path:i,title:o,serviceName:s,formalPathPrefix:l},e.testList[0]=Object.assign({name:e.formData.method+" "+e.formData.path,content:""},e.formData)}))},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.loading=!0,t.configId=this.originId,new Promise((function(a,r){Object(i["c"])(1,1e3,t).then((function(t){var r=t.data.data;e.domain=r.gatewayUrl,e.historyList=r.records,e.loading=!1,a(t)})).catch((function(e){r(e)}))}))},handleStepTabs:function(e,t){"add"===t&&(this.tabIndex=this.tabCount,this.currentTab=++this.tabIndex,this.testList.push({name:"New Test"})),"remove"===t&&(this.testList.splice(e-1,1),this.currentTab=e-1)},addHistoryTab:function(e){var t=this,a=!1;this.testList.forEach((function(r,n){r.id===e.id&&(a=!0,t.currentTab=n+1)})),a||Object(i["b"])(e.id).then((function(e){var a=e.data.data||{},r=a.configId,n=a.content,i=a.id,o=a.name;t.tabIndex=t.tabCount,t.currentTab=++t.tabIndex,t.testList.push(Object.assign({configId:r,content:n,id:i,name:o},t.formData))}))},addRefresh:function(){var e=this;this.handleStepTabs(this.currentTab,"remove"),this.initData(),this.getList().then((function(){if(e.historyList&&e.historyList.length>0){e.menuActive="0";var t=e.historyList&&e.historyList[0];e.addHistoryTab(t,e.currentTab)}}))},deleteHistory:function(e){var t=this;this.$confirm("确定删除该历史测试记录?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(i["d"])(e.id)})).then((function(){t.menuActive="0",t.getList(),t.testList.forEach((function(a,r){a.id===e.id&&t.handleStepTabs(r+1,"remove")})),t.$message({type:"success",message:"删除成功"})}))},goBack:function(){var e=decodeURIComponent(this.$route.query.redirect);this.$router.$avueRouter.closeTag(),this.$route.query.redirect&&e&&this.$router.push(e)},openCookies:function(){console.log("openCookies::::")}}},u=c,p=(a("7476"),a("2877")),d=Object(p["a"])(u,r,n,!1,null,null,null);t["default"]=d.exports},e54b:function(e,t,a){},e683:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return u}));var r=[{label:"固定值",value:"fixed"},{label:"引用值",value:"ref"}],n={fixed:[{label:"number",value:"number"},{label:"string",value:"string"},{label:"boolean",value:"boolean"}],ref:[{label:"int",value:"int"},{label:"long",value:"long"},{label:"float",value:"float"},{label:"double",value:"double"},{label:"string",value:"string"},{label:"boolean",value:"boolean"},{label:"array",value:"array"}]},i=[{label:"等于 =",value:"eq"},{label:"大于 >",value:"gt"},{label:"大于或等于 >=",value:"ge"},{label:"小于 <",value:"lt"},{label:"小于或等于 <=",value:"le"},{label:"不等于 !=",value:"ne"},{label:"包含",value:"contains"},{label:"不包含",value:"notContain"},{label:"包含任何一个",value:"containsAny"},{label:"is null",value:"isNull"},{label:"is not null",value:"isNotNull"},{label:"is blank",value:"isBlank"},{label:"is not blank",value:"isNotBlank"},{label:"is empty",value:"isEmpty"},{label:"is not empty",value:"isNotEmpty"}],o=[{label:"固定值",value:"fixed"},{label:"引用值",value:"quote"},{label:"脚本",value:"script"},{label:"函数",value:"fn"}],s=[{label:"raw",value:"raw"},{label:"int",value:"int"},{label:"long",value:"long"},{label:"float",value:"float"},{label:"double",value:"double"},{label:"string",value:"string"},{label:"boolean",value:"boolean"}],l=[{label:"number",value:"number"},{label:"string",value:"string"},{label:"boolean",value:"boolean"},{label:"json",value:"json"}],c=[{label:"固定值",value:"fixed"},{label:"引用值",value:"ref"},{label:"函数",value:"func"}],u=[{label:"100 - Continue",value:100},{label:"101 - Switching Protocols",value:101},{label:"102 - Processing",value:102},{label:"103 - Checkpoint",value:103},{label:"200 - OK",value:200},{label:"201 - Created",value:201},{label:"202 - Accepted",value:202},{label:"203 - Non-Authoritative Information",value:203},{label:"204 - No Content",value:204},{label:"205 - Reset Content",value:205},{label:"206 - Partial Content",value:206},{label:"207 - Multi-Status",value:207},{label:"208 - Already Reported",value:208},{label:"226 - IM Used",value:226},{label:"300 - Multiple Choices",value:300},{label:"301 - Moved Permanently",value:301},{label:"302 - Found",value:302},{label:"302 - Moved Temporarily",value:302},{label:"303 - See Other",value:303},{label:"304 - Not Modified",value:304},{label:"305 - Use Proxy",value:305},{label:"307 - Temporary Redirect",value:307},{label:"308 - Permanent Redirect",value:308},{label:"400 - Bad Request",value:400},{label:"401 - Unauthorized",value:401},{label:"402 - Payment Required",value:402},{label:"403 - Forbidden",value:403},{label:"404 - Not Found",value:404},{label:"405 - Method Not Allowed",value:405},{label:"406 - Not Acceptable",value:406},{label:"407 - Proxy Authentication Required",value:407},{label:"408 - Request Timeout",value:408},{label:"409 - Conflict",value:409},{label:"410 - Gone",value:410},{label:"411 - Length Required",value:411},{label:"412 - Precondition Failed",value:412},{label:"413 - Payload Too Large",value:413},{label:"413 - Request Entity Too Large",value:413},{label:"414 - URI Too Long",value:414},{label:"414 - Request-URI Too Long",value:414},{label:"415 - Unsupported Media Type",value:415},{label:"416 - Requested range not satisfiable",value:416},{label:"417 - Expectation Failed",value:417},{label:"418 - I'm a teapot",value:418},{label:"419 - Insufficient Space On Resource",value:419},{label:"420 - Method Failure",value:420},{label:"421 - Destination Locked",value:421},{label:"422 - Unprocessable Entity",value:422},{label:"423 - Locked",value:423},{label:"424 - Failed Dependency",value:424},{label:"425 - Too Early",value:425},{label:"426 - Upgrade Required",value:426},{label:"428 - Precondition Required",value:428},{label:"429 - Too Many Requests",value:429},{label:"431 - Request Header Fields Too Large",value:431},{label:"451 - Unavailable For Legal Reasons",value:451},{label:"500 - Internal Server Error",value:500},{label:"501 - Not Implemented",value:501},{label:"502 - Bad Gateway",value:502},{label:"503 - Service Unavailable",value:503},{label:"504 - Gateway Timeout",value:504},{label:"505 - HTTP Version not supported",value:505},{label:"506 - Variant Also Negotiates",value:506},{label:"507 - Insufficient Storage",value:507},{label:"508 - Loop Detected",value:508},{label:"509 - Bandwidth Limit Exceeded",value:509},{label:"510 - Not Extended",value:510},{label:"511 - Network Authentication Required",value:511}]},e815:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"small",disabled:e.disabled}},[a("el-form-item",{attrs:{label:"条件描述:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",placeholder:"如：是否会员"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("div",{staticClass:"form-item-required"},[a("el-form-item",{attrs:{label:"值1:"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"value1.type"}},[a("el-select",{attrs:{placeholder:"固定值/引用值"},on:{change:function(t){return e.changeHandle("value1")}},model:{value:e.form.value1.type,callback:function(t){e.$set(e.form.value1,"type",t)},expression:"form.value1.type"}},e._l(e.valueType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"fixed"===e.form.value1.type?"value1.fixedDataType":"value1.refDataType"}},["fixed"===e.form.value1.type?a("el-select",{attrs:{placeholder:"ref"===e.form.value1.type?"数据类型（非必填）":"fixed"===e.form.value1.type?"数据类型（必填）":"请选择数据类型",clearable:""},on:{change:function(t){return e.dataTypeChange("value1")}},model:{value:e.form.value1.fixedDataType,callback:function(t){e.$set(e.form.value1,"fixedDataType",t)},expression:"form.value1.fixedDataType"}},e._l(e.dataType1,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("el-select",{attrs:{placeholder:"ref"===e.form.value1.type?"数据类型（非必填）":"fixed"===e.form.value1.type?"数据类型（必填）":"请选择数据类型",clearable:""},on:{change:function(t){return e.dataTypeChange("value1")}},model:{value:e.form.value1.refDataType,callback:function(t){e.$set(e.form.value1,"refDataType",t)},expression:"form.value1.refDataType"}},e._l(e.dataType1,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"value1.value"}},["boolean"===e.form.value1.fixedDataType&&"fixed"===e.form.value1.type?a("el-select",{attrs:{placeholder:"字段值",size:e.size,clearable:""},model:{value:e.form.value1.value,callback:function(t){e.$set(e.form.value1,"value",t)},expression:"form.value1.value"}},e._l(e.booleanOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):"number"===e.form.value1.fixedDataType&&"fixed"===e.form.value1.type?a("el-input",{attrs:{"controls-position":"right",clearable:"",placeholder:"字段值",type:"number"},model:{value:e.form.value1.value,callback:function(t){e.$set(e.form.value1,"value",t)},expression:"form.value1.value"}}):a("el-input",{attrs:{placeholder:"字段值"},model:{value:e.form.value1.value,callback:function(t){e.$set(e.form.value1,"value",t)},expression:"form.value1.value"}})],1)],1),a("div",{staticClass:"tooltip"},["ref"===e.form.value1.type?a("quote-tooltip",{staticClass:"tooltip"}):e._e()],1)])])],1),a("el-form-item",{attrs:{label:"比较符:",prop:"operator"}},[a("el-select",{model:{value:e.form.operator,callback:function(t){e.$set(e.form,"operator",t)},expression:"form.operator"}},e._l(e.operatorSymbol,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.showValue2(e.form.operator)?a("div",{staticClass:"form-item-required"},[a("el-form-item",{attrs:{label:"值2:"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"value2.type"}},[a("el-select",{attrs:{placeholder:"固定值/引用值"},on:{change:function(t){return e.changeHandle("value2")}},model:{value:e.form.value2.type,callback:function(t){e.$set(e.form.value2,"type",t)},expression:"form.value2.type"}},e._l(e.valueType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"fixed"===e.form.value2.type?"value2.fixedDataType":"value2.refDataType"}},["fixed"===e.form.value2.type?a("el-select",{attrs:{placeholder:"ref"===e.form.value2.type?"数据类型（非必填）":"fixed"===e.form.value2.type?"数据类型（必填）":"请选择数据类型",clearable:""},on:{change:function(t){return e.dataTypeChange("value2")}},model:{value:e.form.value2.fixedDataType,callback:function(t){e.$set(e.form.value2,"fixedDataType",t)},expression:"form.value2.fixedDataType"}},e._l(e.dataType2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("el-select",{attrs:{placeholder:"ref"===e.form.value2.type?"数据类型（非必填）":"fixed"===e.form.value2.type?"数据类型（必填）":"请选择数据类型",clearable:""},on:{change:function(t){return e.dataTypeChange("value2")}},model:{value:e.form.value2.refDataType,callback:function(t){e.$set(e.form.value2,"refDataType",t)},expression:"form.value2.refDataType"}},e._l(e.dataType2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"col"},[a("el-form-item",{attrs:{label:"",prop:"value2.value"}},["boolean"===e.form.value2.fixedDataType&&"fixed"===e.form.value2.type?a("el-select",{attrs:{placeholder:"字段值",size:e.size,clearable:""},model:{value:e.form.value2.value,callback:function(t){e.$set(e.form.value2,"value",t)},expression:"form.value2.value"}},e._l(e.booleanOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):"number"===e.form.value2.fixedDataType&&"fixed"===e.form.value2.type?a("el-input",{attrs:{clearable:"",placeholder:"字段值",type:"number"},model:{value:e.form.value2.value,callback:function(t){e.$set(e.form.value2,"value",t)},expression:"form.value2.value"}}):a("el-input",{attrs:{placeholder:"字段值"},model:{value:e.form.value2.value,callback:function(t){e.$set(e.form.value2,"value",t)},expression:"form.value2.value"}})],1)],1),a("div",{staticClass:"tooltip"},["ref"===e.form.value2.type?a("quote-tooltip"):e._e()],1)])])],1):e._e()],1)},n=[],i=(a("456d"),a("ac6a"),a("c5f6"),a("6762"),a("28a5"),a("e683")),o=a("cc38"),s=a("307b"),l={name:"compareForm",components:{quoteTooltip:o["default"]},props:{data:{type:Object,default:function(){return{}}},disabled:Boolean,rule:{type:Object,default:function(){}}},data:function(){return{booleanOptions:[{label:"true",value:!0},{label:"false",value:!1}],form:{type:"condition",desc:"",value1:{type:"",value:""},operator:"",value2:{type:"",value:""}},rules:{"value1.type":[{required:!0,message:"请选择【固定值/引用值】",trigger:"change"}],"value1.fixedDataType":[{validator:this.validateDataType,trigger:"change"}],"value1.refDataType":[{validator:this.validateDataType,trigger:"change"}],"value1.value":[{required:!0,message:"【值】不为空",trigger:"blur"},{required:!0,message:"【值】不为空",trigger:"change"}],operator:[{required:!0,message:"请选择【比较符】",trigger:"change"}],"value2.type":[{required:!0,message:"请选择【固定值/引用值】",trigger:"change"}],"value2.fixedDataType":[{validator:this.validateDataType,trigger:"change"}],"value2.refDataType":[{validator:this.validateDataType,trigger:"change"}],"value2.value":[{required:!0,message:"【值】不为空",trigger:"blur"},{required:!0,message:"【值】不为空",trigger:"change"}]},valueType:i["c"],operatorSymbol:i["b"]}},watch:{rule:{immediate:!0,deep:!0,handler:function(){this.rules=Object.assign(this.rules,this.rule)}}},computed:{dataType1:function(){try{return this.form.value1.type?i["a"][this.form.value1.type]:[]}catch(e){return[]}},dataType2:function(){try{return this.form.value2.type?i["a"][this.form.value2.type]:[]}catch(e){return[]}}},methods:{validateDataType:function(e,t,a){var r="value1"===e.field.split(".")[0]?this.form.value1.type:this.form.value2.type;"fixed"===r&&(t||a(new Error("【数据类型】不为空！"))),a()},showValue2:function(e){if(e){var t=["isNull","isNotNull","isBlank","isNotBlank","isEmpty","isNotEmpty"];return!t.includes(e)}return!0},handleData:function(){var e=Object(s["a"])(this.form),t=["isNull","isNotNull","isBlank","isNotBlank","isEmpty","isNotEmpty"];return"fixed"===e.value1.type&&"number"===e.value1.fixedDataType&&(e.value1.value=Number(e.value1.value)),Object.keys(e.value1).forEach((function(t){var a=e.value1[t];""===a&&delete e.value1[t]})),t.includes(e.operator)?delete e.value2:("fixed"===e.value2.type&&"number"===e.value2.fixedDataType&&(e.value2.value=Number(e.value2.value)),Object.keys(e.value2).forEach((function(t){var a=e.value2[t];""===a&&delete e.value2[t]}))),e},emitData:function(){var e=this.handleData();this.$emit("update:data",e),this.$emit("emitData",e)},validate:function(){var e=this;return new Promise((function(t,a){e.$refs.form.validate((function(r){r?(e.emitData(),t()):a()}))}))},changeHandle:function(e){this.form[e].fixedDataType&&(this.form[e].fixedDataType=""),this.form[e].refDataType&&(this.form[e].refDataType=""),this.form[e].value=""},dataTypeChange:function(e){"fixed"===this.form[e].type&&this.form[e].value&&(this.form[e].value=null)}},mounted:function(){"{}"!==JSON.stringify(this.data)&&(this.form=Object(s["a"])(this.data))}},c=l,u=(a("329b"),a("2877")),p=Object(u["a"])(c,r,n,!1,null,"4f8f66ba",null);t["default"]=p.exports},e931:function(e,t,a){"use strict";a.r(t);a("a481"),a("7f7f");var r,n,i=a("65d4"),o=a("2b3f"),s={name:"history-detail",mixins:[i["default"]],data:function(){return{disabled:!0,businessType:"history"}},methods:{getDetail:function(){var e=this;if(!this.originId)return this.formData={},void(this.baseConfigs={});Object(o["a"])(this.originId).then((function(t){e.formData=t.data.data||{};var a=Object.assign({},e.formData),r=a.id,n=void 0===r?"":r,i=a.serviceId,o=void 0===i?"":i,s=a.name,l=void 0===s?"":s,c=a.method,u=void 0===c?"":c,p=a.path,d=void 0===p?"":p,f=a.developer,h=void 0===f?"":f,m=a.description,b=void 0===m?"":m,g=a.serviceName,v=void 0===g?"":g;d=d.replace("/proxy/".concat(v,"/"),""),e.baseConfigs={id:n,serviceId:o,name:l,method:u,path:d,developer:h,description:b,serviceName:v}}))}}},l=s,c=a("2877"),u=Object(c["a"])(l,r,n,!1,null,"9bd3495e",null);t["default"]=u.exports},ec8f:function(e,t,a){},ef00:function(e,t,a){},efcc:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"testForm",staticClass:"test-item-form",attrs:{size:"small",model:e.testForm,rules:e.rules,disabled:e.disabled}},[a("el-form-item",{attrs:{prop:"name"}},[a("el-input",{attrs:{placeholder:"自动生成测试用例的名称，格式 POST/GET URL,  用户可手动输入或修改"},model:{value:e.testForm.name,callback:function(t){e.$set(e.testForm,"name",t)},expression:"testForm.name"}},[a("template",{slot:"prepend"},[e._v("标题")])],2)],1),a("div",{staticClass:"proxy-type"},[a("el-radio",{attrs:{label:"proxytest"},model:{value:e.proxyType,callback:function(t){e.proxyType=t},expression:"proxyType"}},[e._v("测试接口")]),a("el-radio",{attrs:{label:"proxy"},model:{value:e.proxyType,callback:function(t){e.proxyType=t},expression:"proxyType"}},[e._v("正式接口")])],1),a("el-form-item",{staticClass:"test-request",attrs:{prop:"path"}},[a("el-input",{attrs:{placeholder:"请输入字段值（例：0 或 zh)"},model:{value:e.testForm.path,callback:function(t){e.$set(e.testForm,"path",t)},expression:"testForm.path"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"方法",disabled:""},slot:"prepend",model:{value:e.testForm.method,callback:function(t){e.$set(e.testForm,"method",t)},expression:"testForm.method"}},e._l(e.apiMethod,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-button",{attrs:{size:"small",loading:e.sendLoading,type:"primary"},on:{click:function(t){return e.handleAction("send")}}},[e._v("发送")]),a("el-button",{attrs:{size:"small",loading:e.saveLoading,type:"primary",plain:""},on:{click:function(t){return e.handleAction("save")}}},[e._v("保存")])],1),a("el-form-item",[a("el-tabs",["GET"!==e.testForm.method?a("el-tab-pane",{attrs:{label:"请求体",lazy:!0}},[a("el-radio",{attrs:{label:"JSON"},model:{value:e.bodyType,callback:function(t){e.bodyType=t},expression:"bodyType"}}),a("el-radio",{attrs:{label:"form-data"},model:{value:e.bodyType,callback:function(t){e.bodyType=t},expression:"bodyType"}}),a("el-radio",{attrs:{label:"x-www-form-urlencoded"},model:{value:e.bodyType,callback:function(t){e.bodyType=t},expression:"bodyType"}}),a("el-radio",{attrs:{label:"XML"},model:{value:e.bodyType,callback:function(t){e.bodyType=t},expression:"bodyType"}}),"JSON"===e.bodyType?a("data-editor",{attrs:{content:e.body,height:300,disabled:e.disabled},on:{"update:content":function(t){e.body=t}}}):"form-data"===e.bodyType||"x-www-form-urlencoded"===e.bodyType?a("values-table",{ref:"formBody",attrs:{data:e.formBody,"is-upload":"form-data"===e.bodyType,disabled:e.disabled},on:{"update:data":function(t){e.formBody=t}}}):"XML"===e.bodyType?a("code-editor",{attrs:{type:"xml",content:e.xmlBody,height:300},on:{"update:content":function(t){e.xmlBody=t}}}):e._e()],1):e._e(),a("el-tab-pane",{attrs:{label:"请求头"}},[a("el-checkbox",{model:{value:e.returnContext,callback:function(t){e.returnContext=t},expression:"returnContext"}},[e._v("返回Context")]),a("values-table",{ref:"headers",attrs:{data:e.headers,disabled:e.disabled},on:{"update:data":function(t){e.headers=t}}})],1),a("el-tab-pane",{attrs:{label:"Query参数"}},[a("values-table",{ref:"query",attrs:{data:e.query,disabled:e.disabled},on:{"update:data":function(t){e.query=t}}})],1)],1)],1),a("div",{staticClass:"response-hr",class:"response-hr-"+e.responseState},[e._v("Response 响应结果")]),a("el-form-item",[a("el-tabs",[a("el-tab-pane",{attrs:{label:"响应体"}},[a("el-radio-group",{staticStyle:{cursor:"not-allowed","pointer-events":"none"},model:{value:e.responseBodyType,callback:function(t){e.responseBodyType=t},expression:"responseBodyType"}},[a("el-radio",{attrs:{label:"JSON"}}),a("el-radio",{attrs:{label:"XML"}}),a("el-radio",{attrs:{label:"ELSE"}},[e._v("其他类型")])],1),"JSON"===e.responseBodyType?[a("code-highlight",{attrs:{id:"json",language:"json",code:e.jsonResponseBody,height:300}})]:"XML"===e.responseBodyType?[a("code-highlight",{attrs:{id:"xml",language:"xml",code:e.xmlResponseBody,height:300}})]:[a("el-input",{attrs:{type:"textarea",autosize:{minRows:12,maxRows:20},readonly:""},model:{value:e.responseBody,callback:function(t){e.responseBody=t},expression:"responseBody"}})]],2),a("el-tab-pane",{attrs:{label:"响应头"}},[e.renderResHeaderCom?a("values-table",{attrs:{data:e.responseHeaders,disabled:""},on:{"update:data":function(t){e.responseHeaders=t}}}):e._e()],1)],1)],1)],1)},n=[],i=(a("8e6e"),a("456d"),a("6762"),a("2fdb"),a("28a5"),a("a481"),a("ac6a"),a("ade3")),o=a("942a"),s=a("83b0"),l=a("8c58"),c=(a("6b54"),a("cebe")),u=a.n(c),p=a("323e"),d=a.n(p),f=(a("a5d8"),a("ff40")),h=u.a.create({timeout:2e4,withCredentials:!0});d.a.configure({showSpinner:!1}),h.interceptors.request.use((function(e){return d.a.start(),e}),(function(e){return Promise.reject(e)})),h.interceptors.response.use((function(e){d.a.done();var t=e.status;return 200!==t?Promise.reject(e):e}),(function(e){return"[object Error]"===Object.prototype.toString.call(e)&&Object(f["a"])({message:"请求出错了：".concat(e),type:"error"}),d.a.done(),Promise.reject(new Error(e))}));var m=h,b=a("5880"),g=a("7ede"),v=(a("4917"),a("3b2b"),a("386d"),a("c54a"));function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(var a in e)Object(v["a"])(e,a)&&""!==a&&(Object(v["b"])(e[a])&&(e[a]=e[a].join(",")),t+="".concat(a,"=").concat(e[a],"&"));return t.slice(0,-1)}var x=a("4627"),O=a("d480"),w=a("9470");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={name:"test-item",data:function(){return{editorHeight:400,testForm:{},rules:{name:[{required:!0,message:"请填写测试用例名称",trigger:"blur"}]},returnContext:!1,proxyType:"proxytest",bodyType:"JSON",headers:{},body:{},formBody:[],xmlBody:"",query:{},sendLoading:!1,saveLoading:!1,responseState:"",responseBody:null,responseHeaders:{},responseBodyType:"",renderResHeaderCom:!0}},computed:D(D({},Object(b["mapGetters"])(["apiMethod"])),{},{serviceName:function(){return this.data.serviceName||""},request:function(){var e=this.encodeValuesQuery(this.query)||"",t=this.headers||{},a={};if(t=this.handleHeaders(t),"form-data"===this.bodyType){Object(v["d"])(this.formBody,"object")&&this.$refs.formBody.emitData();var r=new FormData;this.formBody.forEach((function(e){if(e.type&&"File"===e.type&&e.files)for(var t=0;t<e.files.length;t++)r.append(e.key,e.files[t]);else e.key&&e.value&&r.append(e.key,e.value)})),a=r}else"x-www-form-urlencoded"===this.bodyType?(Object(v["d"])(this.formBody,"object")&&this.$refs.formBody.emitData(),a=this.encodeValuesQuery(this.formBody)):a="XML"===this.bodyType?this.xmlBody||"":this.body||{};return{headers:t,body:a,query:e}},content:function(){var e=this.getValueTableParams(!0),t=e.formBody,a=e.query,r=e.headers,n="XML"===this.bodyType?this.xmlBody:"JSON"===this.bodyType?this.body:t;return JSON.stringify({headers:this.formatContent(r),body:"form-data"===this.bodyType||"x-www-form-urlencoded"===this.bodyType?this.formatContent(n):n,query:this.formatContent(a),proxyType:this.proxyType,returnContext:this.returnContext,bodyType:this.bodyType})},jsonResponseBody:function(){if(this.responseBody){var e=this.responseBody;return Object(v["d"])(this.responseBody,"object")&&(e=Object.assign({},this.responseBody)),JSON.stringify(e,null,"  ")}return""},xmlResponseBody:function(){var e=this.responseBody||"";return e=e.replace(/></g,">\n<"),e}}),props:{data:{type:Array,default:function(){return[]}},domain:{type:String,default:""},refresh:{type:Function},disabled:{type:Boolean,default:!1}},components:{dataParams:o["default"],paramsTable:s["default"],valuesTable:l["default"],dataEditor:x["default"],codeHighlight:O["default"],codeEditor:w["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(){this.initData()}},proxyType:{handler:function(e){this.testForm.path=this.domain+this.changePath(this.data.path,e)}},domain:{handler:function(e){this.testForm.path=e+this.changePath(this.data.path,this.proxyType)}}},methods:{formatContent:function(e){if(Object(v["d"])(e,"array"))for(var t=0;t<e.length;t++)delete e[t].$index,""===e[t].key&&(e.splice(t,1),t--);else if(Object(v["d"])(e,"object"))for(var a in e)""===a&&delete e[a];return e},encodeValuesQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Object(v["d"])(e,"array")){var t=[];return e.forEach((function(e){e.key&&e.value&&t.push("".concat(e.key,"=").concat(e.value))})),t.join("&")}return y(e)},checkResponseBodyType:function(e){return e=e.split(";"),e=e.map((function(e){return e.toLowerCase()})),e.includes("application/xml")||e.includes("text/xml")?"XML":e.includes("application/json")?"JSON":"ELSE"},handleHeaders:function(e){var t={};return Object(v["d"])(e,"array")&&e.forEach((function(e){e.key&&(t[e.key]?t[e.key]=t[e.key]+","+e.value:t[e.key]=e.value)})),this.returnContext?t.returnContext=!0:t.returnContext&&delete t.returnContext,"GET"===this.testForm.method||t["Content-Type"]||("form-data"===this.bodyType?t["Content-Type"]="multipart/form-data":"x-www-form-urlencoded"===this.bodyType?t["Content-Type"]="application/x-www-form-urlencoded":"XML"===this.bodyType?t["Content-Type"]="application/xml":t["Content-Type"]="application/json"),t},handleAction:function(e){var t=this,a=this.getValueTableParams(!1),r=a.formBody,n=a.query,i=a.headers;this.formBody=r,this.query=n,this.headers=i,this.$nextTick((function(){var a=Object(v["k"])(t.body);if(!a)return t.$message.error("请求体JSON格式有误"),!1;"save"===e&&t.handleSave(),"send"===e&&t.validateUpload()&&t.handleSend()}))},getValueTableParams:function(e){var t=e?"getAllData":"getCheckedData",a=this.$refs.formBody&&this.$refs.formBody[t]()||[],r=this.$refs.query&&this.$refs.query[t]()||[],n=this.$refs.headers&&this.$refs.headers[t]()||[];return{formBody:a,query:r,headers:n}},validateUpload:function(){if("form-data"===this.bodyType){var e=[];if(this.formBody.forEach((function(t,a){t.type&&"File"===t.type&&t.files&&t.files.length!==t.value.split(",").length&&e.push(a+1)})),e.length>0)return this.$message({showClose:!0,message:"第".concat(e.join(","),"行 未上传文件！"),type:"warning"}),!1}return!0},handleSend:function(){var e=this;this.clearResponse(),this.sendLoading=!0;var t=this.testForm.method,a=this.testForm.path+(this.request.query?"?".concat(this.request.query):""),r=this.request.headers||{},n=this.request.body||{};m({url:a,method:t,headers:r,data:n}).then((function(t){e.responseState="success",e.responseBody=t.data,e.responseHeaders=t.headers,e.responseBodyType=e.checkResponseBodyType(t.headers["content-type"]),e.sendLoading=!1})).catch((function(t){console.error(t),e.responseState="error",e.responseBody=t.data,e.responseHeaders=t.headers,t.headers&&t.headers["content-type"]&&(e.responseBodyType=e.checkResponseBodyType(t.headers["content-type"])),e.sendLoading=!1})).then((function(){e.renderResHeaderCom=!1,e.$nextTick((function(){e.renderResHeaderCom=!0}))}))},changePath:function(e,t){return e?(e="proxytest"===t?e.replace("/proxy/".concat(this.serviceName,"/"),"/_proxytest/".concat(this.serviceName,"/")):e.replace("/proxy/".concat(this.serviceName,"/"),"".concat(this.data.formalPathPrefix,"/").concat(this.serviceName,"/")),e):e},handleSave:function(){var e=this;this.saveLoading=!0;var t=Object.assign({},this.testForm);t.content=this.content,Object(g["a"])(t).then((function(){e.$message.success("测试用例保存成功"),e.refresh()})).finally((function(){e.saveLoading=!1}))},initData:function(){var e=Object.assign({},this.data),t=e.content||"{}";try{t=JSON.parse(t)}catch(h){console.log("[error in test data]",h)}var a=t,r=a.headers,n=void 0===r?{}:r,i=a.body,o=void 0===i?{}:i,s=a.query,l=void 0===s?{}:s,c=a.proxyType,u=void 0===c?"proxytest":c,p=a.returnContext,d=a.bodyType;if(this.returnContext=p||n.returnContext||!1,delete n.returnContext,d)this.bodyType=d;else{var f=(n["Content-Type"]||"").split(";");f.includes("application/xml")?(this.bodyType="XML",f.splice(f.indexOf("application/xml"),1)):f.includes("multipart/form-data")?(this.bodyType="form-data",f.splice(f.indexOf("multipart/form-data"),1)):f.includes("application/x-www-form-urlencoded")?(this.bodyType="x-www-form-urlencoded",f.splice(f.indexOf("application/x-www-form-urlencoded"),1)):f.includes("application/json")&&(this.bodyType="JSON",f.splice(f.indexOf("application/json"),1)),n["Content-Type"]=f.join(";"),n["Content-Type"]||delete n["Content-Type"]}"XML"===this.bodyType?this.xmlBody=o:"form-data"===this.bodyType||"x-www-form-urlencoded"===this.bodyType?this.formBody=o:this.body=o,this.headers=n,this.query=l,this.proxyType=u,e.path=this.domain+this.changePath(e.path,this.proxyType),this.testForm=e},validate:function(){var e=this;return new Promise((function(t,a){e.$refs.testForm.validate((function(e){e?t():a()}))}))},clearResponse:function(){var e=this;this.responseState="",this.responseBody="",this.responseBodyType="",this.responseHeaders={},this.renderResHeaderCom=!1,this.$nextTick((function(){e.renderResHeaderCom=!0}))}}},S=_,k=(a("1c28"),a("2877")),j=Object(k["a"])(S,r,n,!1,null,null,null);t["default"]=j.exports},f039:function(e,t,a){"use strict";a("c6bd")},f231:function(e,t,a){"use strict";a("4aa1")},f6d3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-detail-response"},[a("el-form",{ref:"form",attrs:{size:"small",model:e.response,rules:e.rules}},[a("el-form-item",{staticClass:"http-status",attrs:{label:"HTTP状态码",prop:"httpStatus"}},[a("el-form-item",{staticClass:"http-status-col",attrs:{prop:"httpStatus.type"}},[a("el-select",{attrs:{placeholder:"固定值/引用值/函数",clearable:"",disabled:e.disabled},on:{change:function(t){return e.dataTypeChange(e.response.httpStatus.type)}},model:{value:e.response.httpStatus.type,callback:function(t){e.$set(e.response.httpStatus,"type",t)},expression:"response.httpStatus.type"}},e._l(e.httpStatus_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),"fixed"===e.response.httpStatus.type?a("el-form-item",{staticClass:"http-status-col http-status-value",attrs:{prop:"httpStatus.value","show-message":!1}},[a("el-select",{attrs:{clearable:"",disabled:e.disabled},model:{value:e.response.httpStatus.value,callback:function(t){e.$set(e.response.httpStatus,"value",t)},expression:"response.httpStatus.value"}},e._l(e.httpStatus,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"ref"===e.response.httpStatus.type?a("el-form-item",{staticClass:"http-status-col http-status-value",attrs:{prop:"httpStatus.value","show-message":!1}},[a("el-input",{attrs:{placeholder:"请输入字段值(必填)",disabled:e.disabled},model:{value:e.response.httpStatus.value,callback:function(t){e.$set(e.response.httpStatus,"value",t)},expression:"response.httpStatus.value"}}),a("quote-tooltip",{staticClass:"quote-tooltip"})],1):e._e(),"func"===e.response.httpStatus.type?a("el-form-item",{staticClass:"http-status-col http-status-value",attrs:{prop:"httpStatus.value","show-message":!1}},[a("el-input",{attrs:{placeholder:"请输入字段值(必填)",disabled:e.disabled},model:{value:e.response.httpStatus.value,callback:function(t){e.$set(e.response.httpStatus,"value",t)},expression:"response.httpStatus.value"}}),a("div",{staticClass:"fun-desc"},[e._v("函数列表请参考： \n                "),a("el-link",{staticClass:"link",attrs:{type:"primary",href:"https://www.fizzgate.com/guide/aggregate/function.html",target:"_blank"}},[e._v("函数文档")])],1)],1):e._e()],1),a("data-params",e._b({attrs:{"header-name":"响应头","body-name":"响应体","has-query":!1,data:e.response,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){e.response=t}}},"data-params",e.$attrs,!1),[a("template",{slot:"body"},[a("el-form-item",{attrs:{label:"内容类型",prop:"contentType"}},[a("el-radio-group",{model:{value:e.response.contentType,callback:function(t){e.$set(e.response,"contentType",t)},expression:"response.contentType"}},[a("el-radio",{attrs:{label:"application/json"}},[e._v("JSON")]),a("el-radio",{attrs:{label:"application/xml"}},[e._v("XML")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"application/xml"===e.response.contentType,expression:"response.contentType === 'application/xml'"}],staticClass:"key-tips"},[e._v("\n                按JSON配置，网关会把JSON转换为XML，请参考\n                "),a("el-link",{on:{click:function(t){e.xmlInoVisible=!0}}},[e._v("XML和JSON间的转换规则")])],1)],1)],1)],2)],1),a("xml-info",{attrs:{visible:e.xmlInoVisible},on:{"update:visible":function(t){e.xmlInoVisible=t}}})],1)},n=[],i=(a("96cf"),a("1da1")),o=a("942a"),s=a("921f"),l=a("e683"),c=a("cc38"),u={name:"api-detail-response",data:function(){return{response:{httpStatus:{value:200,type:"fixed",fixedDataType:"number"}},xmlInoVisible:!1,httpStatus_type:l["e"],httpStatus:l["d"],rules:{"httpStatus.type":[{required:!0,message:"必填"}],"httpStatus.value":[{required:!0,message:"必填",trigger:"blur"}]}}},inheritAttrs:!1,props:{data:{type:Object,default:function(){return{}}},isDelScriptWithHttp:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},computed:{dataObj:function(){return{response:this.response}}},components:{dataParams:o["default"],xmlInfo:s["default"],quoteTooltip:c["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(e){this.initData(e)}},dataObj:{deep:!0,handler:function(){this.emitData()}}},methods:{emitData:function(){this.$emit("update:data",this.dataObj)},initData:function(e){e=e||this.data,this.response=e&&e.response||{},this.response.httpStatus||(this.response.httpStatus={value:200,type:"fixed",fixedDataType:"number"}),this.response.contentType||(this.response.contentType="application/json")},dataTypeChange:function(e){var t=this;delete this.response.httpStatus.fixedDataType,delete this.response.httpStatus.refDataType,"fixed"===e?(this.response.httpStatus.value=200,this.response.httpStatus.fixedDataType="number"):"ref"===e?(this.response.httpStatus.value="",this.response.httpStatus.refDataType="int"):this.$set(this.response.httpStatus,"value",""),this.$nextTick((function(){t.$refs.form.clearValidate()}))},validate:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.emitData(),t=!0,a="",e.next=5,this.$refs.form.validate((function(e){e||(t=!1,a="请完善配置输出！")}));case 5:return t&&"func"===this.response.httpStatus.type&&"fn."!==this.response.httpStatus.value.substring(0,3)&&(t=!1,a='HTTP状态码: 函数类型的字段值应该以 "fn." 开头!'),e.abrupt("return",{validate:t,message:a});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},p=u,d=(a("8e9c"),a("2877")),f=Object(d["a"])(p,r,n,!1,null,"ef268530",null);t["default"]=f.exports},fa97:function(e,t,a){"use strict";a("421d")},fd89:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"add-component"},[a("add-component",{attrs:{data:e.requestForm.components,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm,"components",t)}}})],1),a("el-form",{ref:"requestForm",staticClass:"request-item-form",attrs:{size:"small",model:e.requestForm,rules:e.rules,disabled:e.disabled,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"接口类型",prop:"type",required:""}},[a("el-radio-group",{on:{change:e.handleTypeChange},model:{value:e.requestForm.type,callback:function(t){e.$set(e.requestForm,"type",t)},expression:"requestForm.type"}},[a("el-radio",{attrs:{label:"REQUEST"}},[e._v("RESTful")]),a("el-radio",{attrs:{label:"DUBBO"}},[e._v("Dubbo")]),a("el-radio",{attrs:{label:"GRPC"}},[e._v("gRPC")])],1)],1),"DUBBO"===e.requestForm.type||"GRPC"===e.requestForm.type?[a("el-form-item",{key:"serviceName",attrs:{label:"服务名",prop:"serviceName"}},[a("el-input",{staticStyle:{width:"50%","margin-right":"10px"},attrs:{placeholder:"请选择接口",disabled:""},model:{value:e.requestForm.serviceName,callback:function(t){e.$set(e.requestForm,"serviceName",t)},expression:"requestForm.serviceName"}}),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showRpcSelector=!0}}},[e._v("选择接口")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showRpcAdd=!0}}},[e._v("新增接口")])],1),a("el-form-item",{key:"method",attrs:{label:"方法名",prop:"method"}},[a("el-input",{attrs:{disabled:""},model:{value:e.requestForm.method,callback:function(t){e.$set(e.requestForm,"method",t)},expression:"requestForm.method"}})],1),"DUBBO"===e.requestForm.type?[a("el-form-item",{attrs:{label:"版本",prop:"version"}},[a("el-input",{attrs:{disabled:""},model:{value:e.requestForm.version,callback:function(t){e.$set(e.requestForm,"version",t)},expression:"requestForm.version"}}),a("span",{staticClass:"key-tips"},[e._v("Dubbo服务的版本号")])],1),a("el-form-item",{attrs:{label:"分组",prop:"group"}},[a("el-input",{attrs:{disabled:""},model:{value:e.requestForm.group,callback:function(t){e.$set(e.requestForm,"group",t)},expression:"requestForm.group"}}),a("span",{staticClass:"key-tips"},[e._v("Dubbo服务的分组")])],1),a("el-form-item",{attrs:{label:"参数类型",prop:"paramTypes"}},[a("el-input",{attrs:{type:"textarea",disabled:""},model:{value:e.requestForm.paramTypes,callback:function(t){e.$set(e.requestForm,"paramTypes",t)},expression:"requestForm.paramTypes"}})],1)]:e._e()]:[a("el-form-item",{key:"method",attrs:{label:"请求方法",prop:"method"}},[a("el-select",{attrs:{placeholder:"请选择请求方法",clearable:""},model:{value:e.requestForm.method,callback:function(t){e.$set(e.requestForm,"method",t)},expression:"requestForm.method"}},e._l(e.apiMethod,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.showNewURL||e.newUrlTrigger?[a("el-form-item",{key:"protocol",attrs:{label:"协议",prop:"protocol"}},[a("el-select",{attrs:{placeholder:"请选择协议",clearable:""},model:{value:e.requestForm.protocol,callback:function(t){e.$set(e.requestForm,"protocol",t)},expression:"requestForm.protocol"}},[a("el-option",{attrs:{label:"HTTP",value:"http"}}),a("el-option",{attrs:{label:"HTTPS",value:"https"}})],1)],1),a("el-form-item",{key:"serviceType",attrs:{label:"服务类型",prop:"serviceType"}},[a("el-radio-group",{on:{change:e.serviceTypeChange},model:{value:e.requestForm.serviceType,callback:function(t){e.$set(e.requestForm,"serviceType",t)},expression:"requestForm.serviceType"}},[a("el-radio",{attrs:{label:1}},[e._v("服务发现")]),a("el-radio",{attrs:{label:2}},[e._v("HTTP服务\n              "),a("el-tooltip",{attrs:{placement:"top"}},[a("span",{attrs:{slot:"content"},slot:"content"},[e._v("RPC管理->服务声明里维护的HTTP服务实例")]),a("i",{staticClass:"el-icon-question"})])],1)],1)],1),1===e.requestForm.serviceType?[a("el-form-item",{attrs:{label:"注册中心：",prop:"registryName"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择 注册中心",clearable:""},on:{change:e.changeRegister},model:{value:e.requestForm.registryName,callback:function(t){e.$set(e.requestForm,"registryName",t)},expression:"requestForm.registryName"}},e._l(e.registerList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.value,value:e.value}})})),1)],1),a("el-form-item",{key:"serviceName",attrs:{label:"服务名：",prop:"serviceName"}},[a("el-select",{staticClass:"service-name-select",attrs:{placeholder:"请选择服务名",filterable:"",clearable:""},model:{value:e.requestForm.serviceName,callback:function(t){e.$set(e.requestForm,"serviceName",t)},expression:"requestForm.serviceName"}},e._l(e.serviceList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.value,value:e.value}})})),1)],1)]:2===e.requestForm.serviceType?[a("el-form-item",{key:"serviceName",attrs:{label:"服务名：",prop:"serviceName"}},[a("el-select",{staticClass:"service-name-select",attrs:{placeholder:"请选择服务名",filterable:"",clearable:""},model:{value:e.requestForm.serviceName,callback:function(t){e.$set(e.requestForm,"serviceName",t)},expression:"requestForm.serviceName"}},e._l(e.httpServiceOptions,(function(t,r){return a("el-option",{key:r,attrs:{label:e.renderServiceName(t),value:t.service}})})),1),!e.disabled&&e.permissionList.serviceAddBtn?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:function(t){e.showHttpServiceAdd=!0}}},[e._v("新增HTTP服务\n            ")]):e._e()],1)]:e._e(),a("el-form-item",{key:"path",attrs:{label:"API路径",prop:"path"}},[a("el-input",{attrs:{clearable:""},model:{value:e.requestForm.path,callback:function(t){e.$set(e.requestForm,"path",t)},expression:"requestForm.path"}}),a("span",{staticClass:"key-tips"},[e._v("输入接口路径，如：/api/getMebInfo； 路径支持引用参数，如：/user/{step1.request1.response.body.id}/info 或 /user/{step1.request1.response.body.id|123}，管道符|后为默认值")])],1)]:e._e(),e.showNewURL?e._e():a("fieldset",{staticStyle:{"margin-bottom":"10px"}},[a("legend",[e._v("接口URL(旧) -\n          "+e._s(e.newUrlTrigger?"请使用以上新的字段配置接口URL":"请使用新的字段配置接口URL")+"\n          "),e.newUrlTrigger?e._e():a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"mini",plain:""},on:{click:function(t){e.newUrlTrigger=!0}}},[e._v("使用URL新字段\n          ")])],1),a("el-form-item",{attrs:{label:"默认URL",prop:"url"}},[a("el-input",{attrs:{placeholder:"请输入默认URL（例：http://10.12.13.114/we-meb/api/getMebInfo",clearable:""},model:{value:e.requestForm.url,callback:function(t){e.$set(e.requestForm,"url",t)},expression:"requestForm.url"}},[a("el-tooltip",{attrs:{slot:"append",placement:"top"},slot:"append"},[a("span",{attrs:{slot:"content"},slot:"content"},[e._v("\n                URL格式(支持http和https协议)："),a("br"),e._v("\n                服务发现：http://service-name/path_to_api, 如：http://member-service/api/member/info"),a("br"),e._v("\n                直接调用：http://IP[:port]/path_to_api, 如：http://10.2.3.101:8080/api/member/info"),a("br"),e._v("\n                域名调用：http://FQDN[:port]/path_to_api, 如：http://member.abc.com/api/member/info"),a("br")]),a("el-button",{attrs:{icon:"el-icon-question"}})],1)],1)],1),a("el-form-item",{attrs:{label:"开发环境URL",prop:"devUrl"}},[a("el-input",{attrs:{placeholder:"请输入开发环境URL（例：http://10.12.13.114/we-meb/api/getMebInfo",clearable:""},model:{value:e.requestForm.devUrl,callback:function(t){e.$set(e.requestForm,"devUrl",t)},expression:"requestForm.devUrl"}})],1),a("el-form-item",{attrs:{label:"测试环境URL",prop:"testUrl"}},[a("el-input",{attrs:{placeholder:"请输入测试环境URL（例：http://10.12.13.114/we-meb/api/getMebInfo",clearable:""},model:{value:e.requestForm.testUrl,callback:function(t){e.$set(e.requestForm,"testUrl",t)},expression:"requestForm.testUrl"}})],1),a("el-form-item",{attrs:{label:"预生产环境URL",prop:"preUrl"}},[a("el-input",{attrs:{placeholder:"请输入预生产环境URL（例：http://10.12.13.114/we-meb/api/getMebInfo",clearable:""},model:{value:e.requestForm.preUrl,callback:function(t){e.$set(e.requestForm,"preUrl",t)},expression:"requestForm.preUrl"}})],1),a("el-form-item",{attrs:{label:"生产环境URL",prop:"prodUrl"}},[a("el-input",{attrs:{placeholder:"请输入生产环境URL（例：http://10.12.13.114/we-meb/api/getMebInfo",clearable:""},model:{value:e.requestForm.prodUrl,callback:function(t){e.$set(e.requestForm,"prodUrl",t)},expression:"requestForm.prodUrl"}})],1)],1)],a("el-form-item",{staticClass:"form-item-with-unit",attrs:{label:"超时时间",prop:"timeout"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,placeholder:"例：10000"},model:{value:e.requestForm.timeout,callback:function(t){e.$set(e.requestForm,"timeout",t)},expression:"requestForm.timeout"}}),a("span",{staticClass:"unit"},[e._v("毫秒")])],1),a("el-form-item",{staticClass:"form-item-with-unit",attrs:{label:"失败重试",prop:"numRetries"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.requestForm.numRetries,callback:function(t){e.$set(e.requestForm,"numRetries",t)},expression:"requestForm.numRetries"}}),a("span",{staticClass:"unit"},[e._v("次")])],1),a("el-form-item",{staticClass:"form-item-with-unit",attrs:{label:"重试间隔",prop:"retryInterval"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.requestForm.retryInterval,callback:function(t){e.$set(e.requestForm,"retryInterval",t)},expression:"requestForm.retryInterval"}}),a("span",{staticClass:"unit"},[e._v("毫秒")])],1),a("el-form-item",{attrs:{label:"Fallback",prop:"fallback"}},[a("el-select",{attrs:{clearable:""},model:{value:e.requestForm.fallback.mode,callback:function(t){e.$set(e.requestForm.fallback,"mode",t)},expression:"requestForm.fallback.mode"}},[a("el-option",{attrs:{label:"stop",value:"stop"}}),a("el-option",{attrs:{label:"continue",value:"continue"}})],1)],1),e.requestForm.fallback&&"continue"===e.requestForm.fallback.mode?a("el-form-item",{attrs:{label:"Fallback响应Json",prop:"fallback.defaultResult"}},[a("el-input",{attrs:{type:"textarea",placeholder:"当Fallback=continue时填写"},model:{value:e.requestForm.fallback.defaultResult,callback:function(t){e.$set(e.requestForm.fallback,"defaultResult",t)},expression:"requestForm.fallback.defaultResult"}})],1):e._e(),a("el-form-item",{attrs:{label:"请求预处理",prop:"condition"}},[a("el-checkbox",{on:{change:e.conditionChange},model:{value:e.requestForm.conditionFlag,callback:function(t){e.$set(e.requestForm,"conditionFlag",t)},expression:"requestForm.conditionFlag"}},[e._v("设置预处理（预处理脚本返回true时才执行请求）\n      ")]),e.requestForm.conditionFlag?a("el-form-item",{attrs:{label:"脚本配置"}},[e.scriptId?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openScript()}}},[e._v("\n            "+e._s("{ aggregate_config_script_id: "+e.scriptId+" }")+"\n          ")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteScript(e.scriptId)}}},[e._v("\n            删除\n          ")])],1):a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){return e.openScript()}}},[e._v("\n          "+e._s(e.disabled?"无":"新增")+"\n        ")]),a("script-dialog",{attrs:{visible:e.scriptVisible,callback:e.scriptCallback,"business-type":e.businessType,disabled:e.disabled,id:e.scriptId,isDelScriptWithHttp:e.isDelScriptWithHttp},on:{"update:visible":function(t){e.scriptVisible=t},"update:id":function(t){e.scriptId=t}}})],1):e._e()],1),"DUBBO"===e.requestForm.type?[a("el-form-item",{attrs:{label:"配置入参"}},[a("data-params",{key:"bubboRequest",staticClass:"highlight-border",attrs:{"header-name":"隐式参数","body-name":"方法参数","body-rules":e.dubboRules,"business-type":e.businessType,"has-query":!1,data:e.requestForm.dataMapping.request,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"request",t)}}},[a("template",{slot:"body"},[a("span",{staticClass:"key-tips"},[e._v("\n              Dubbo方法参数的字段名格式为pN，如: 第一个参数为p1, 第二个参数为p2; 如果参数是一个对象且要指定对象里某一个属性的值可输入pN.[attrName], 如：p1.userId\n            ")])])],2)],1),a("el-form-item",{attrs:{label:"配置响应"}},[a("data-params",{key:"bubboResponse",staticClass:"highlight-border",attrs:{"body-name":"响应","business-type":e.businessType,"has-query":!1,"has-header":!1,data:e.requestForm.dataMapping.response,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"response",t)}}})],1)]:"GRPC"===e.requestForm.type?[a("el-form-item",{attrs:{label:"配置入参"}},[a("data-params",{key:"grpcRequest",staticClass:"highlight-border",attrs:{"header-name":"元数据","body-name":"参数","business-type":e.businessType,"has-query":!1,data:e.requestForm.dataMapping.request,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"request",t)}}})],1),a("el-form-item",{attrs:{label:"配置响应"}},[a("data-params",{key:"grpcResponse",staticClass:"highlight-border",attrs:{"body-name":"响应","business-type":e.businessType,"has-header":!1,"has-query":!1,data:e.requestForm.dataMapping.response,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"response",t)}}})],1)]:[a("el-form-item",{attrs:{label:"配置入参"}},[a("data-params",{key:"restRequest",staticClass:"highlight-border",attrs:{"business-type":e.businessType,"has-body":"GET"!==e.requestForm.method,data:e.requestForm.dataMapping.request,"multiple-values":!0,"content-type":e.requestForm.dataMapping.request.contentType,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"request",t)}}},[a("template",{slot:"body"},[a("el-form-item",{attrs:{label:"内容类型",prop:"contentType"}},[a("el-radio-group",{model:{value:e.requestForm.dataMapping.request.contentType,callback:function(t){e.$set(e.requestForm.dataMapping.request,"contentType",t)},expression:"requestForm.dataMapping.request.contentType"}},[a("el-radio",{attrs:{label:"application/json"}},[e._v("JSON")]),a("el-radio",{attrs:{label:"application/xml"}},[e._v("XML")]),a("el-radio",{attrs:{label:"multipart/form-data"}},[e._v("form-data")]),a("el-radio",{attrs:{label:"application/x-www-form-urlencoded"}},[e._v("x-www-form-urlencoded")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"application/xml"===e.requestForm.dataMapping.request.contentType,expression:"requestForm.dataMapping.request.contentType === 'application/xml'"}],staticClass:"key-tips"},[e._v("\n                入参按JSON配置，网关会把JSON转换为XML，请参考\n                "),a("el-link",{on:{click:function(t){e.xmlInoVisible=!0}}},[e._v("XML和JSON间的转换规则")])],1)],1)],1)],2)],1),a("el-form-item",{attrs:{label:"配置响应"}},[a("data-params",{key:"restResponse",staticClass:"highlight-border",attrs:{"header-name":"响应头","body-name":"响应体","business-type":e.businessType,"has-query":!1,data:e.requestForm.dataMapping.response,isDelScriptWithHttp:e.isDelScriptWithHttp,disabled:e.disabled},on:{"update:data":function(t){return e.$set(e.requestForm.dataMapping,"response",t)}}},[a("template",{slot:"body"},[a("el-form-item",{attrs:{label:"内容类型",prop:"contentType"}},[a("el-radio-group",{model:{value:e.requestForm.dataMapping.response.contentType,callback:function(t){e.$set(e.requestForm.dataMapping.response,"contentType",t)},expression:"requestForm.dataMapping.response.contentType"}},[a("el-radio",{attrs:{label:"auto"}},[e._v("Auto")]),a("el-radio",{attrs:{label:"application/json"}},[e._v("JSON")]),a("el-radio",{attrs:{label:"application/xml"}},[e._v("XML")]),a("el-radio",{attrs:{label:"text/plain"}},[e._v("Text")])],1),a("div",{staticClass:"key-tips"},[e._v("\n                Content-Type类型，默认根据响应头自动识别，如果响应头的Content-Type和响应内容类型不匹配时可手动选择内容类型。\n                当内容类型为XML时网关接收后会把它转换为JSON, 响应体按转换后的JSON格式配置即可\n              ")])],1),"application/xml"===e.requestForm.dataMapping.response.contentType?a("el-form-item",{attrs:{label:"数组节点路径",prop:"xmlArrPaths"}},[a("el-input",{attrs:{clearable:""},model:{value:e.requestForm.dataMapping.response.xmlArrPaths,callback:function(t){e.$set(e.requestForm.dataMapping.response,"xmlArrPaths",t)},expression:"requestForm.dataMapping.response.xmlArrPaths"}}),a("span",{staticClass:"key-tips"},[e._v("\n                输入XML响应体里数组节点的路径, 多个路径用逗号分隔，如：/root/data/user 用于指明user标签可能有多个要转换成一个JSON数组，\n                而不是转换成一个JSON对象。此字段仅在响应体为XML时有效。\n                "),a("el-link",{on:{click:function(t){e.xmlInoVisible=!0}}},[e._v("XML和JSON间的转换规则")])],1)],1):e._e()],1)],2)],1)]],2),a("rpc-api-selector",{ref:"rpcApiSelector",attrs:{visible:e.showRpcSelector,type:e.requestForm.type},on:{"update:visible":function(t){e.showRpcSelector=t},confirm:e.getRpcApi}}),a("rpc-api-detail",{attrs:{type:"add",title:"新增RPC接口",visible:e.showRpcAdd,callback:e.addRpcCallback},on:{"update:visible":function(t){e.showRpcAdd=t}}}),a("http-service-detail",{attrs:{type:"add",title:"新增HTTP服务","service-type":3,visible:e.showHttpServiceAdd,callback:e.getHttpServiceOptions},on:{"update:visible":function(t){e.showHttpServiceAdd=t}}}),a("xml-info",{attrs:{visible:e.xmlInoVisible},on:{"update:visible":function(t){e.xmlInoVisible=t}}})],1)},n=[],i=(a("8e6e"),a("456d"),a("ac6a"),a("c5f6"),a("ade3")),o=a("2fa9"),s=a("942a"),l=a("921f"),c=a("5880"),u=a("16cd"),p=a("c54a"),d=a("7b22"),f=a("3bfd"),h=a("1763"),m=a("74a0"),b=a("b874"),g=a("c983"),v=a("0a6a");function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={name:"step-request-item",data:function(){return{requestForm:{components:[]},rules:{method:[{required:!0,message:"必填",trigger:"change"}],serviceName:[{required:!0,message:"必填",trigger:"change"}],protocol:[{required:!0,message:"必填",trigger:"change"}],serviceType:[{required:!0,message:"必填",trigger:"change"}],path:[{required:!0,message:"必填",trigger:"blur"}],"fallback.defaultResult":[{validator:function(e,t,a){t&&!Object(p["k"])(t)?a(new Error("请输入正确格式的JSON")):a()},trigger:"blur"}],registryName:[{required:!0,message:"必填",trigger:"change"}]},scriptVisible:!1,scriptId:"",dubboRules:{key:[{pattern:/^p(\d)+(\.(([A-Za-z\d])+))?$/,message:"dubbo类型的接口参数格式为: pN",trigger:"blur"}]},showRpcSelector:!1,showRpcAdd:!1,newUrlTrigger:!1,showHttpServiceAdd:!1,httpServiceOptions:[],xmlInoVisible:!1,registerList:[],serviceList:[]}},computed:x(x({},Object(c["mapGetters"])(["apiMethod","permission"])),{},{permissionList:function(){return{serviceAddBtn:this.vaildData(this.permission.rpc_service_add,!1)}},showNewURL:function(){return!(!this.requestForm.protocol&&(this.requestForm.url||this.requestForm.devUrl||this.requestForm.testUrl||this.requestForm.preUrl||this.requestForm.prodUrl))}}),props:{data:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},businessType:{type:String},isDelScriptWithHttp:{type:Boolean,default:!0}},components:{scriptDialog:o["default"],dataParams:s["default"],rpcApiSelector:h["default"],rpcApiDetail:m["default"],httpServiceDetail:b["default"],xmlInfo:l["default"],addComponent:g["default"]},watch:{data:{immediate:!0,deep:!0,handler:function(){this.initData()}},"data.registryName":{deep:!0,immediate:!0,handler:function(){this.getDiscoveryServiceOptions(this.data.registryName)}}},created:function(){this.getHttpServiceOptions(),this.getRegisterNameList()},methods:x(x({},Object(c["mapActions"])(["removeScript"])),{},{renderServiceName:function(e){return e.description?"".concat(e.service,"  (").concat(e.description,")"):e.service},serviceTypeChange:function(e){this.requestForm.serviceName&&this.$set(this.requestForm,"serviceName",""),2==e&&this.$set(this.requestForm,"registryName","")},getHttpServiceOptions:function(){var e=this;Object(d["b"])({type:3}).then((function(t){e.httpServiceOptions=t.data.data.records||[]}))},initData:function(){var e=this.data||{};this.scriptId&&(e.conditionFlag=!0),e.fallback||(e.fallback={}),e.dataMapping||(e.dataMapping={request:{},response:{}}),"REQUEST"===e.type&&(e.dataMapping.request&&!e.dataMapping.request.contentType&&this.$set(e.dataMapping.request,"contentType","application/json"),e.dataMapping.response&&!e.dataMapping.response.contentType&&this.$set(e.dataMapping.response,"contentType","auto")),e.condition||(e.condition={}),e.components||(e.components=[]);var t="string"===typeof e.condition?JSON.parse(e.condition):e.condition;this.scriptId=t&&t["aggregate_config_script_id"]||"",this.requestForm=e},handleData:function(){return""===this.requestForm.timeout?delete this.requestForm.timeout:this.requestForm.timeout&&(this.requestForm.timeout=Number(this.requestForm.timeout)),this.requestForm.fallback&&""===this.requestForm.fallback.mode&&delete this.requestForm.fallback.mode,2==this.requestForm.serviceType&&delete this.requestForm.registryName,Object(u["b"])(this.requestForm)},emitData:function(){this.$emit("update:data",this.handleData())},validate:function(){var e=this;return this.emitData(),new Promise((function(t,a){e.$refs.requestForm.validate((function(e){e?t():a()}))}))},openScript:function(){this.scriptVisible=!0},conditionChange:function(e){e||(this.requestForm.condition={})},scriptCallback:function(){this.requestForm.condition=this.scriptId?{aggregate_config_script_id:this.scriptId}:{}},deleteScript:function(e){var t=this;this.$confirm("确定删除该脚本?",{type:"warning"}).then((function(){if(!t.isDelScriptWithHttp)return t.$store.commit("SET_WILL_DEL_SCRIPT_IDS",e),void t.delCallback();t.removeScript(e).then((function(){t.delCallback()}))}))},delCallback:function(){this.scriptId="",this.requestForm.condition={},this.$message.success("删除成功")},handleTypeChange:function(){this.requestForm.method&&this.$set(this.requestForm,"method",""),this.requestForm.serviceName&&this.$set(this.requestForm,"serviceName",""),this.requestForm.version&&this.$set(this.requestForm,"version",""),this.requestForm.group&&this.$set(this.requestForm,"group",""),this.requestForm.paramTypes&&this.$set(this.requestForm,"paramTypes","")},getRpcApi:function(e){var t=e[0]||{};this.$set(this.requestForm,"serviceName",t.service||""),this.$set(this.requestForm,"method",t.method||""),this.$set(this.requestForm,"version",t.version||""),this.$set(this.requestForm,"group",t.group||""),this.$set(this.requestForm,"paramTypes",t.paramTypes||"")},addRpcCallback:function(){this.$refs.rpcApiSelector.onLoad()},getRegisterNameList:function(){var e=this;Object(v["d"])().then((function(t){if(200===t.data.code){var a=t.data.data;a.forEach((function(t){e.registerList.push({label:t,value:t})}))}}))},changeRegister:function(e){this.$set(this.requestForm,"serviceName",""),this.getDiscoveryServiceOptions(e)},getDiscoveryServiceOptions:function(e){var t=this;e?Object(f["d"])({registryName:e}).then((function(e){var a=e.data.data||[];t.serviceList=[],a.forEach((function(e){t.serviceList.push({label:e,value:e})}))})):this.serviceList=[]}})},w=O,T=(a("bbb7"),a("11f5"),a("2877")),D=Object(T["a"])(w,r,n,!1,null,"6668fa28",null);t["default"]=D.exports}}]);