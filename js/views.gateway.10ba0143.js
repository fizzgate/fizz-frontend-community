/*!
 * Fizz-Admin v3.2.0-beta1
 * (c) 2020-2024 Joker-Lee
 * AGPL v3 Licensed.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views.gateway"],{"07ce":function(e,t,a){},1499:function(e,t,a){},"181c":function(e,t,a){},2101:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("el-tabs",{staticClass:"tab-con",on:{"tab-click":e.handleClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"已安装扩展",name:"active"}},[t("avue-crud",{ref:"crud",attrs:{"before-open":e.beforeOpen,data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"row-del":e.rowDel,"row-update":e.rowUpdate,"row-save":e.rowSave,"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"isDynamic",fn:function(a){var n=a.row;return[t("el-tag",{attrs:{type:3==n.type||4==n.type?"success":""},on:{click:e.showServeList}},[3==n.type||4==n.type?t("i",{staticClass:"el-icon-info"}):e._e(),e._v("\n            "+e._s(3==n.type||4==n.type?"是":"否")+"\n          ")])]}},{key:"isMarket",fn:function(a){var n=a.row;return[t("el-tag",[e._v("\n        "+e._s(n.isMarket?"是":"否")+"\n       ")])]}},{key:"menu",fn:function(a){var n=a.type,i=a.size,r=a.row;return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.delPermission(r.type),expression:"delPermission(row.type)"}],attrs:{icon:"el-icon-delete",size:i,type:n},on:{click:function(t){return e.rowDel(r)}}},[e._v(" "+e._s(r.isMarket?"卸载":"删除"))]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.permissionList.editBtn&&!r.isMarket,expression:"permissionList.editBtn && !row.isMarket"}],attrs:{icon:"el-icon-edit",size:i,type:n},on:{click:function(t){return e.rowEdit(r,e.index)}}},[e._v("编辑")])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),t("el-tab-pane",{attrs:{label:"官方扩展市场",name:"market"}},[t("market")],1)],1),t("el-dialog",{attrs:{"append-to-body":"",width:"900px",top:"20px","close-on-click-modal":!1,title:e.detailDialog.title,visible:e.detailDialog.visible},on:{"update:visible":function(t){return e.$set(e.detailDialog,"visible",t)}}},[t("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules,size:"small",disabled:"view"===e.detailDialog.type,"label-width":"140px"}},[t("el-form-item",{attrs:{label:"扩展名称",prop:"engName"}},[t("el-input",{attrs:{placeholder:"请输入扩展名称",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.engName,callback:function(t){e.$set(e.dialogForm,"engName",t)},expression:"dialogForm.engName"}}),t("span",[e._v("扩展名称由英文字母、下划线或数字组成, 不能以数字开头，如：memberAuth,  member_auth_v1")])],1),t("el-form-item",{attrs:{label:"扩展分类",prop:"type"}},["edit"!==e.detailDialog.type?t("el-select",{attrs:{placeholder:"请选择扩展分类",disabled:e.editDisabled},model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type"}},e._l(e.editAblePluginTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("el-select",{attrs:{placeholder:"请选择扩展分类",disabled:""},model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type"}},e._l(e.pluginTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"扩展描述",prop:"chnName"}},[t("el-input",{attrs:{placeholder:"请输入扩展描述",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.chnName,callback:function(t){e.$set(e.dialogForm,"chnName",t)},expression:"dialogForm.chnName"}}),t("span",[e._v("如：会员登录校验")])],1),e.isPlugin?t("el-form-item",{attrs:{label:"默认执行顺序",prop:"order"}},[t("el-input",{attrs:{placeholder:"请输入默认执行顺序",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.order,callback:function(t){e.$set(e.dialogForm,"order",t)},expression:"dialogForm.order"}})],1):e._e(),e.isPlugin?t("el-form-item",{attrs:{label:"表单定义",prop:"config"}},[t("data-editor",{key:e.detailDialog.type,attrs:{content:e.dialogForm.config,height:300,disabled:"view"===e.detailDialog.type||e.editDisabled},on:{"update:content":function(t){return e.$set(e.dialogForm,"config",t)}}}),t("span",[e._v("\n          路由级别的自定义属性，定义规范请参考：\n          "),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showFormTips()}}},[e._v("表单规范说明")])],1)],1):e._e(),e.isPlugin?t("el-form-item",{attrs:{label:"自定义配置",prop:"fixedConfig"}},[t("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.dialogForm.fixedConfig,callback:function(t){e.$set(e.dialogForm,"fixedConfig",t)},expression:"dialogForm.fixedConfig"}}),t("span",{staticClass:"key-tips"},[e._v("插件级别的自定义配置信息 "),t("tooltip-custom",{staticClass:"link",attrs:{title:"插件实例"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"使用说明",prop:"instruction"}},[t("el-input",{attrs:{type:"textarea",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.instruction,callback:function(t){e.$set(e.dialogForm,"instruction",t)},expression:"dialogForm.instruction"}})],1),e.isDynamic?t("el-form-item",{attrs:{label:"节点端包",prop:"filename"}},[t("div",[t("span",{staticClass:"file-con"},["edit"===e.detailDialog.type?t("span",{on:{click:function(t){return e.downloadFile(e.detailDialog.filename,!1)}}},[e._v("\n              "+e._s(e.dialogForm.filename))]):t("span",[e._v("\n              "+e._s(e.dialogForm.filename)+"\n            ")])]),t("el-upload",{staticClass:"avatar-uploader",attrs:{"auto-upload":!1,disabled:e.disabled,"show-file-list":!1,"on-change":function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return e.handleFileChangeIcon.apply(e,a.concat([!1]))},accept:".jar"}},[t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("div",{staticClass:"key-tips"},[t("a",{attrs:{href:"https://gitee.com/fizzgate/fizz-dynamic-plugin"}},[e._v("下载代码模板")])])],1)]):e._e(),e.isDynamic?t("el-form-item",{attrs:{label:"管理端包",prop:"adminFilename"}},[t("div",[t("span",{staticClass:"file-con"},["edit"===e.detailDialog.type?t("span",{on:{click:function(t){return e.downloadFile(e.detailDialog.adminFilename,!0)}}},[e._v("\n              "+e._s(e.dialogForm.adminFilename))]):t("span",[e._v("\n              "+e._s(e.dialogForm.adminFilename)+"\n            ")])]),t("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:e.disabled,"auto-upload":!1,"show-file-list":!1,"on-change":function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return e.handleFileChangeIcon.apply(e,a.concat([!0]))},accept:".zip"}},[t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("div",{staticClass:"key-tips"},[t("a",{attrs:{href:"https://gitee.com/fizzgate/fizz-dynamic-plugin"}},[e._v("下载代码模板")])])],1)]):e._e()],1),"view"!==e.detailDialog.type?t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",loading:e.detailDialog.loading},on:{click:e.submitForm}},[e._v("保 存\n      ")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.detailDialog.visible=!1}}},[e._v("取 消")])],1):e._e(),t("el-dialog",{attrs:{width:"600px",title:"插件表单规范说明",visible:e.tipsDialog.visible,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.tipsDialog,"visible",t)}}},[t("code-highlight",{attrs:{height:"400",code:e.tipsDialog.content}})],1)],1),e.pluginServerVisible?t("pluginServerDialog",{attrs:{visible:e.pluginServerVisible,services:e.services},on:{changeVisible:function(t){e.pluginServerVisible=!1}}}):e._e()],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("aef6"),a("7f7f"),a("6762"),a("2fdb"),a("bd86")),o=a("6420"),s=a("627c"),l=a("dd62"),c=a("5880"),u=a("c54a"),d=a("4627"),p=a("d480"),g=a("6c1d"),f=a("7b82");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b=[{label:"内置插件",value:1},{label:"自定义插件",value:2},{label:"动态插件",value:3},{label:"动态组件",value:4}],v={data:function(){return{pluginServerVisible:!1,activeTab:"active",services:[],pluginTypes:b,editAblePluginTypes:[{label:"自定义插件",value:2},{label:"动态插件",value:3},{label:"动态组件",value:4}],form:{},dialogForm:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{dialogWidth:900,border:!0,index:!0,viewBtn:!0,editBtn:!1,columnBtn:!1,menuPosition:"right",column:[{label:"ID",prop:"id",width:160},{label:"扩展分类",prop:"type",type:"select",dicData:b,width:70},{label:"扩展名称",prop:"engName",search:!0,overHidden:!0,width:180},{label:"扩展描述",prop:"chnName",search:!0,overHidden:!0,width:110},{label:"默认执行顺序",prop:"order",hide:!0},{label:"动态扩展",prop:"isDynamic",slot:!0,overHidden:!0,align:"center",display:!1},{label:"来自市场",prop:"isMarket",slot:!0,align:"center",display:!1}]},data:[],rules:{engName:[{required:!0,message:"必填",trigger:"blur"},{pattern:/^[A-Za-z_][A-Za-z\d_\\.]*$/,message:"格式有误",trigger:"blur"}],chnName:[{required:!0,message:"必填",trigger:"blur"}],order:[{required:!0,message:"必填",trigger:"blur"},{pattern:/^\d+$/,message:"请输入自然数",trigger:"blur"}]},detailDialog:{visible:!1,title:"详情",type:"",loading:!1},tipsDialog:{title:"js",visible:!1,content:"111"}}},computed:m(m({isPlugin:function(){return 1==this.dialogForm.type||2==this.dialogForm.type||3==this.dialogForm.type},isDynamic:function(){return 3==this.dialogForm.type||4==this.dialogForm.type}},Object(c["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.gateway_plugin_add,!1),editBtn:this.vaildData(this.permission.gateway_plugin_edit,!1),viewBtn:this.vaildData(this.permission.gateway_plugin_view,!1),delBtn:!1}},editDisabled:function(){return"edit"===this.detailDialog.type&&1==this.dialogForm.type}}),watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},components:{pluginServerDialog:o["default"],market:f["default"],dataEditor:d["default"],codeHighlight:p["default"],tooltipCustom:l["default"]},methods:{showServeList:function(){var e=this;Object(s["f"])().then((function(t){200===t.data.code?(e.pluginServerVisible=!0,e.services=t.data.data):e.$message.error(t.data.msg)}))},downloadFile:function(e,t){Object(s["b"])({filename:e,isAdmin:t}).then((function(t){var a=t.headers["content-type"],n=new Blob([t.data],{type:a,encoding:"UTF-8"}),i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.download=e,i.click()}))},delPermission:function(e){return this.vaildData(this.permission.gateway_plugin_delete,!1)&&(2===e||3===e||4===e)},showFormTips:function(){this.tipsDialog.content=g["a"].pluginFormJS,this.tipsDialog.visible=!0},submitForm:function(){var e=this;this.$refs.dialogForm.validate((function(t){if(t){var a=e.dialogForm,n=Object(u["k"])(a.config);if(a.config&&!n)return e.$message.error("表单定义配置JSON格式有误"),!1;if(a.config&&!(a.config instanceof Array))return e.$message.error("表单定义配置需为数组格式结构"),!1;var i=Object.assign({},a);a.config&&a.config.length?i.config=JSON.stringify(a.config):i.config="","edit"===e.detailDialog.type?e.rowUpdate(i):e.rowSave(i)}}))},rowSave:function(e){var t=this;this.detailDialog.loading=!0,Object(s["a"])(e).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"保存成功"}),t.detailDialog.visible=!1}),(function(e){window.console.log(e)})).finally((function(){t.detailDialog.loading=!1}))},rowUpdate:function(e){var t=this;this.detailDialog.loading=!0,Object(s["h"])(e).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"修改成功"}),t.detailDialog.visible=!1}),(function(e){window.console.log(e)})).finally((function(){t.detailDialog.loading=!1}))},rowEdit:function(e,t){return this.$refs.crud.rowEdit(e,t)},rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["g"])([{id:e.id,type:e.type}])})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},beforeOpen:function(e,t){var a=this;switch(this.detailDialog.type=t,t){case"add":this.detailDialog.title="新增";break;case"edit":this.detailDialog.title="编辑";break;case"view":this.detailDialog.title="查看";break;default:this.detailDialog.title="详情";break}this.dialogForm={type:2},["edit","view"].includes(t)&&Object(s["c"])(this.form.id).then((function(e){a.form=e.data.data,a.dialogForm=Object.assign({},e.data.data||{}),a.detailDialog.visible=!0})),this.detailDialog.visible=!0},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(s["e"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))},handleFileChangeIcon:function(e,t,a){var n=this,i=e.raw;if(this.beforeFileUpload(i,a?".zip":".jar")){var r=i.name,o=new FormData;o.append("file",i,r),o.append("isAdmin",a),Object(s["i"])(o).then((function(e){e.data.data&&(n.$message.success("上传成功"),a?n.$set(n.dialogForm,"adminFilename",e.data.data):n.$set(n.dialogForm,"filename",e.data.data))}))}},isFile:function(e,t){if("string"===typeof e){var a=e.toLowerCase();return a.endsWith(t)}},beforeFileUpload:function(e,t){var a=this,n=a.isFile(e.name,t);return n||this.$message.error("只允许上传"+t),n}}},y=v,O=(a("87ab"),a("2877")),w=Object(O["a"])(y,n,i,!1,null,null,null);t["default"]=w.exports},"21c8":function(e,t,a){"use strict";a("1499")},2561:function(e,t,a){"use strict";a("181c")},"269f":function(e,t,a){},3355:function(e,t,a){},3425:function(e,t,a){},"35e2":function(e,t,a){"use strict";a("3355")},"3ecc":function(e,t,a){"use strict";a("07ce")},"3f28":function(e,t,a){"use strict";a("6e2c")},"419b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",{staticClass:"gateway-dict"},[t("avue-crud",{ref:"crud",attrs:{data:e.data,search:e.query,page:e.page,permission:e.permissionList,option:e.option,"table-loading":e.loading},on:{"update:search":function(t){e.query=t},"update:page":function(t){e.page=t},"row-del":e.rowDel,"row-update":e.rowUpdate,"row-save":e.rowSave,"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=a("5880"),s=a("c597"),l=a("dd69");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={name:"dict-history",data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{border:!0,index:!0,dialogClickModal:!1,viewBtn:!0,editBtn:!1,delBtn:!1,addBtn:!1,columnBtn:!1,menuPosition:"right",labelWidth:100,menuWidth:100,dialogWidth:800,column:[{label:"键(Key)",prop:"key",search:!0},{label:"值(Value)",prop:"value",search:!0},{label:"数据类型",prop:"type",type:"select",dicData:l["a"]},{label:"修改时间",prop:"createTime"}]},data:[],visible:!1}},computed:u(u({},Object(o["mapGetters"])(["permission"])),{},{permissionList:function(){return{viewBtn:this.vaildData(this.permission.gateway_history_dict_view,!1)}},gatewayParamId:function(){return this.$route.query.id||""}}),watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(s["c"])(e.currentPage,e.pageSize,Object.assign(a,this.query,{gatewayParamId:this.gatewayParamId})).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))},handleHistory:function(){}}},p=d,g=(a("e833"),a("2877")),f=Object(g["a"])(p,n,i,!1,null,"69ae7a3e",null);t["default"]=f.exports},"50d2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"网关实例","modal-append-to-body":!1,"append-to-body":!0,"close-on-click-modal":!1,width:"500px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"con"},[t("div",{staticClass:"con-header"},[t("el-radio-group",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[t("el-radio",{attrs:{label:1,disabled:!e.isShowIP}},[e._v("按实例IP")]),t("el-radio",{attrs:{label:2}},[e._v("按服务名")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:e.ipList,border:"",size:"small","max-height":"400"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),1===e.type?t("el-table-column",{attrs:{prop:"name",label:"IP"}}):e._e(),2===e.type?t("el-table-column",{attrs:{prop:"name",label:"服务名"}}):e._e()],1),0!==e.ipList.length||e.loading?e._e():t("p",{staticClass:"empty-text"},[t("i",{staticClass:"el-icon-warning"}),e._v("无可选的网关实例，请先启动网关节点\n    ")])],1),e.disabled?e._e():t("footer",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{size:"small",type:"primary",disabled:0===e.ipList.length},on:{click:e.submitHandle}},[e._v("确 定")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 取 消 ")])],1)])},i=[],r=(a("4f7f"),a("5df3"),a("1c4c"),a("7f7f"),a("ac6a"),a("e5ec")),o={name:"dictDetail",props:{visible:{type:Boolean,default:!1},id:{type:String},isShowIP:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(){this.$emit("changeVisible")}}},data:function(){return{loading:!1,ipList:[],multipleSelection:[],type:1,data:[]}},watch:{type:function(){this.renderTable()},data:function(){this.renderTable()}},methods:{submitHandle:function(){if(0!==this.multipleSelection.length){var e=[];this.multipleSelection.forEach((function(t){e.push(t.name)})),this.$emit("emitData",e),this.dialogVisible=!1}else this.$message.warning("请勾选数据！")},handleSelectionChange:function(e){this.multipleSelection=e},getHostList:function(){var e=this;this.loading=!0,Object(r["c"])().then((function(t){e.data=t.data.data,e.loading=!1})).catch((function(){e.loading=!1}))},renderTable:function(){var e=this;this.ipList.splice(0,this.ipList.length);var t=[];this.data.forEach((function(a){t.push(1===e.type?a.ip:a.serviceName)})),t=Array.from(new Set(t)),t.forEach((function(t){e.ipList.push({name:t})}))}},mounted:function(){this.getHostList(),this.type=this.isShowIP?1:2}},s=o,l=(a("e738"),a("2877")),c=Object(l["a"])(s,n,i,!1,null,"3fd5eb7c",null);t["default"]=c.exports},5568:function(e,t,a){},"627c":function(e,t,a){"use strict";a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"b",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"d",(function(){return h})),a.d(t,"f",(function(){return m}));a("8e6e"),a("ac6a"),a("456d");var n=a("bd86"),i=a("b5c6"),r=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(i["a"])({url:"".concat(r["a"],"/extension/page"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/detail/").concat(e),method:"get"})},u=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/remove"),method:"post",data:e})},d=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/save"),method:"post",data:e})},p=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/upload"),method:"post",timeout:0,data:e})},g=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/download"),method:"get",timeout:0,params:e})},f=function(e){return Object(i["a"])({url:"".concat(r["a"],"/extension/update"),method:"post",data:e})},h=function(){return Object(i["a"])({url:"".concat(r["a"],"/extension/aggregate/nodes"),method:"get"})},m=function(){return Object(i["a"])({url:"".concat(r["a"],"/extension/servers"),method:"get"})}},"62e9":function(e,t,a){},"630e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("avue-crud",{ref:"crud",attrs:{data:e.data,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"search-change":e.searchChange,"search-reset":e.searchReset,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"status",fn:function(a){return[a.row.status?t("el-tag",{attrs:{type:1===a.row.status?"success":"danger"}},[e._v("\n        "+e._s(e.renderStatus(a.row.status))+"\n      ")]):e._e()]}},{key:"menu",fn:function(a){var n=a.row;return[e.permissionList.routeBtn?t("el-button",{attrs:{icon:"el-icon-c-scale-to-original",size:"small",type:"text"},on:{click:function(t){return e.showRoute(n)}}},[e._v("查看路由列表")]):e._e(),e.permissionList.serviceBtn?t("el-button",{attrs:{icon:"el-icon-s-operation",size:"small",type:"text"},on:{click:function(t){return e.showService(n)}}},[e._v("服务编排配置")]):e._e()]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("3b8d")),o=a("bd86"),s=a("5880"),l=a("e5ec");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={name:"instance",components:{},data:function(){return{form:{},query:{},loading:!0,option:{border:!0,index:!0,dialogClickModal:!1,viewBtn:!1,editBtn:!1,addBtn:!1,delBtn:!1,columnBtn:!1,menuPosition:"right",labelWidth:100,column:[{label:"服务名",prop:"serviceName"},{label:"实例IP",prop:"ip"},{label:"端口",prop:"port"},{label:"状态",prop:"status",slot:!0},{label:"心跳时间",prop:"lastUpdateTime"},{label:"启动时间",prop:"startTime"}]},data:[]}},computed:u(u({},Object(s["mapGetters"])(["permission"])),{},{permissionList:function(){return{routeBtn:this.vaildData(this.permission.gateway_instance_route,!1),serviceBtn:this.vaildData(this.permission.gateway_instance_service,!1)}}}),methods:{renderStatus:function(e){var t="";return 1===e?t="正常":2===e&&(t="异常"),t},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.onLoad(e),t()},refreshChange:function(){this.onLoad(this.query)},onLoad:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a=this,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:{},this.loading=!0,Object(l["c"])(Object.assign(t,this.query)).then((function(e){a.loading=!1,a.data=e.data.data}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),showService:function(e){this.$router.push({path:"/gateway/config",query:{originId:e.instanceId}})},showRoute:function(e){this.$router.push({path:"/proxy/api",query:{instanceId:e.instanceId}})}}},p=d,g=a("2877"),f=Object(g["a"])(p,n,i,!1,null,"22f0c684",null);t["default"]=f.exports},6420:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"扩展服务器状态","modal-append-to-body":!1,"append-to-body":!0,"close-on-click-modal":!1,width:"550px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"dialog-main"},e._l(e.services,(function(a,n){return t("div",{key:n,staticClass:"url"},[e._v("\n     服务名："+e._s(a.serviceName)+" ,  实例："+e._s(a.ip+":"+a.port)+" , 业务状态："+e._s(e.getStatus(a.status))+"\n    ")])})),0)])},i=[],r=(a("c5f6"),{activated:"运行中",resolved:"启动中",unresolved:"未注册",deactivated:"未激活",broken:"启动失败"}),o={name:"pluginServerDialog",data:function(){return{code:""}},props:{visible:{type:Boolean,default:!1},id:{type:String|Number},services:{type:Array,default:function(){return[]}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(){this.$emit("changeVisible")}}},methods:{getStatus:function(e){return r[e]?r[e]:"未知状态"}},mounted:function(){}},s=o,l=(a("3ecc"),a("2877")),c=Object(l["a"])(s,n,i,!1,null,"4aa1dd90",null);t["default"]=c.exports},"6c1d":function(e,t,a){"use strict";t["a"]={pluginFormJS:'/*\r\n* plugin_config_design\r\n* 动态插件参考结构\r\n* */\r\n\r\nconst pluginConfig = [\r\n  {\r\n    /* 必有字段 */\r\n    "field": "inputVal",\r\n    "label": "输入框",\r\n    "component": "input", // input, select, radio, checkbox, textarea\r\n    "dataType": "string", // number(long, double), string, boolean, array\r\n    /* 可选字段 */\r\n    "desc": "字段的说明文字",\r\n    "placeholder": "placeholder文字",\r\n    "default": "Aa123", // 初始默认值\r\n    "options": [ // for select, radio, checkbox\r\n      {\r\n        "label": "选项1",\r\n        "value": 1  // number(long, double), string, boolean,\r\n      },\r\n      {\r\n        "label": "选项2",\r\n        "value": 2\r\n      }\r\n    ],\r\n    "rules": [ // min|max / range / length / regex pattern\r\n      { "required": true, "message": "输入框不能为空", "trigger": "change" }, // required 必填\r\n      // { "min": 3, "ma x": 5, "message": "长度在 3 到 5 个字符", "trigger": "change" }, // range 长度范围（for dataType："string"）\r\n      // { "len": 8, "message": "长度需 8 个字符", "trigger": "change" }, // length 长度限制（for dataType："string"）\r\n      // { "type": "number", "message": "请输入数字类型"}, // for dataType："number" 校验数值\r\n      // { "type": "integer", "message": "请输入整数数值", "trigger": "change" }, // for dataType："long" 校验整数\r\n      // { "type": "float", "message": "请输入浮点数数值", "trigger": "change" }, // for dataType："double" 校验浮点数\r\n      { "pattern": "^[A-Za-z\\\\d]+$", "message": "只能是字母或数字", "trigger": "change" } // regex pattern正则\r\n    ]\r\n  },\r\n  {\r\n    "field": "selectVal",\r\n    "label": "选择器",\r\n    "component": "select",\r\n    "dataType": "number",\r\n    "options": [\r\n      {\r\n        "label": "选项1",\r\n        "value": 1\r\n      },\r\n      {\r\n        "label": "选项2",\r\n        "value": 2\r\n      },\r\n      {\r\n        "label": "选项3",\r\n        "value": 3\r\n      }\r\n    ],\r\n    "desc": "选择器的说明文字",\r\n    "placeholder": "请选择",\r\n    "rules": [\r\n      { "required": true, "message": "选择器不能为空", "trigger": "change" }\r\n    ]\r\n  },\r\n  {\r\n    "field": "radioVal",\r\n    "label": "单选框",\r\n    "component": "radio",\r\n    "dataType": "boolean",\r\n    "default": true,\r\n    "options": [\r\n      {\r\n        "label": "是",\r\n        "value": true\r\n      },\r\n      {\r\n        "label": "否",\r\n        "value": false\r\n      }\r\n    ],\r\n    "desc": "单选框的说明文字",\r\n    "rules": [\r\n      { "required": true, "message": "请选择单选框", "trigger": "change" }\r\n    ]\r\n  },\r\n  {\r\n    "field": "radioVal2",\r\n    "label": "单选框",\r\n    "component": "radio",\r\n    "dataType": "Number",\r\n    "default": true,\r\n    "options": [\r\n      {\r\n        "label": "值1",\r\n        "value": 1,\r\n        "refs": [\'radio1\'] // 选中值1，显示 vIf 为 radio1 的表单\r\n      },\r\n      {\r\n        "label": "值2",\r\n        "value": 2,\r\n      }\r\n    ],\r\n    "desc": "单选框的说明文字",\r\n    "rules": [\r\n      { "required": true, "message": "请选择单选框", "trigger": "change" }\r\n    ]\r\n  },\r\n  {\r\n    "vIf": \'radio1\',\r\n    "field": "textVal",\r\n    "label": "文本框",\r\n    "component": "textarea",\r\n    "dataType": "string",\r\n    "desc": "文本框的说明文字",\r\n    "placeholder": "textarea文字",\r\n    "default": "一般放很长的文字",\r\n    "tooltipLabel": \'使用说明\',\r\n    "tooltipValue": "1.这是使用说明这是\\n2.使用说明这是使用说明",\r\n    "tooltipWidth": 200,\r\n    "rules": [\r\n      {\r\n        "required": true,\r\n        "message": "文本框不能为空",\r\n        "trigger": "change"\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    "field": "checkboxVal",\r\n    "label": "多选框",\r\n    "component": "checkbox",\r\n    "dataType": "array",\r\n    "options": [\r\n      {\r\n        "label": "选项1",\r\n        "value": 11\r\n      },\r\n      {\r\n        "label": "选项2",\r\n        "value": 22\r\n      },\r\n      {\r\n        "label": "选项3",\r\n        "value": 33\r\n      }\r\n    ],\r\n    "desc": "多选框的说明文字",\r\n    "rules": [\r\n      { "required": true, "message": "请选择多选框", "trigger": "change" }\r\n    ]\r\n  },\r\n  {\r\n    "field": "textVal",\r\n    "label": "文本框",\r\n    "component": "textarea",\r\n    "dataType": "string",\r\n    "desc": "文本框的说明文字",\r\n    "placeholder": "textarea文字",\r\n    "default": "一般放很长的文字",\r\n    "rules": [\r\n      {\r\n        "required": true,\r\n        "message": "文本框不能为空",\r\n        "trigger": "change"\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\n// TODO 注意！！\r\n// [pluginConfig]数组注释仅为示例说明，实际数组JSON不可包含注释\r\n// 组件 "checkbox" 的dataType = "array"\r\n// 组件 "radio/select" 的实际值类型等于options内的value值类型'}},"6cdf":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"formData",staticClass:"plugin-form",attrs:{disabled:e.disabled,model:e.formData,size:"small"}},[t("plugin-form-item",{attrs:{pluginConfig:e.pluginConfig,formData:e.formData}})],1)],1)},i=[],r=(a("6762"),a("2fdb"),a("75fc")),o=(a("7514"),a("ac6a"),a("456d"),a("7f7f"),a("c5f6"),a("16cd")),s=a("c54a"),l=a("80a3"),c={components:{pluginFormItem:l["default"]},data:function(){return{formData:{},pluginConfigCache:{},result:[]}},props:{disabled:{type:Boolean,default:!1},config:{type:[Array,String],required:!0},data:{type:[Array,Object]},order:{type:[String,Number]},name:{type:String}},computed:{pluginConfig:function(){var e=this.config||"";return e&&"string"===typeof e&&(e=JSON.parse(e)),this.renderData(e||[])},watchInit:function(){return{pluginConfig:this.pluginConfig,data:this.data}}},watch:{watchInit:{immediate:!0,deep:!0,handler:function(){this.initData()}}},methods:{validate:function(){var e=this;return this.handleData(),new Promise((function(t,a){e.$refs.formData.validate((function(n,i){if(e.order||Object(s["d"])(e.order,"number")||a("插件【".concat(e.name,"】: 执行顺序不能为空")),n)t();else{if(i){var r=Object.keys(i)[0],o=i[r][0]["message"]||"未完善插件配置";a("插件【".concat(e.name,"】: ").concat(o))}a()}}))}))},resetForm:function(e){this.$refs[e].resetFields()},handleData:function(){var e=this,t=[],a=Object.assign({},this.formData);Object.keys(a).forEach((function(n){var i=e.pluginConfigCache.find((function(e){return e.field===n}))||{};if("checkbox"===i.component&&!a[n].length)return!1;var r={item:n,type:i.dataType,value:JSON.stringify(a[n])};t.push(r)})),this.result=[],this.filterResult(this.pluginConfig,Object(o["c"])(t)),console.log(JSON.stringify(this.result,null,4)),this.$emit("update:data",this.result)},filterResult:function(e,t){var a=this;e.forEach((function(e){var n=t.filter((function(t){return t.item==e.field}));if(n.length>0){a.result=[].concat(Object(r["a"])(a.result),Object(r["a"])(n));var i=e.options;if(i&&i.length>0){var o=i.filter((function(e){return e.value==n[0].value}));o.length>0&&o[0].refData&&a.filterResult(o[0].refData,t)}}}))},initData:function(){var e=this,t={};this.pluginConfigCache.forEach((function(a){if("checkbox"===a.component&&(t[a.field]=[]),Object.keys(a).some((function(e){return"default"===e}))&&(t[a.field]=a.default),e.data&&e.data.length>0){var n=e.data.find((function(e){return e.item===a.field}));n&&(t[a.field]=JSON.parse(n.value))}})),this.formData=Object.assign({},this.formData,t)},getOpt:function(e,t){e=JSON.parse(JSON.stringify(e));var a=e.filter((function(e){return e.vIf===t}));return a.map((function(e){return delete e.vIf,e})),a},renderData:function(e){var t=this;this.pluginConfigCache=e;var a=function a(n){n.forEach((function(n){if(["radio","select","checkbox"].includes(n.component)){var i=n.options;i.map((function(n){n.refs&&n.refs.length>0&&(n.refData=[],n.refs.forEach((function(i){var o,s=t.getOpt(e,i);s.length>0&&(a(s),(o=n.refData).push.apply(o,Object(r["a"])(s)))})))}))}}))};return a(e),e.filter((function(e){return!e.vIf}))}}},u=c,d=(a("ffb0"),a("2877")),p=Object(d["a"])(u,n,i,!1,null,null,null);t["default"]=p.exports},"6ce4":function(e,t,a){"use strict";a("269f")},"6e2c":function(e,t,a){},"745d":function(e,t,a){"use strict";a.r(t);a("7f7f");var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[e.form.groupName?t("el-tag",[e._v(e._s(e.form.groupName))]):e._e(),e._v(" \n        "),t("b",[e._v(e._s(e.title))])],1),t("h3",[t("i",{staticClass:"el-icon-edit-outline avue-group__icon"}),e._v("基础信息")]),t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"small",disabled:e.disabled}},[t("el-form-item",{attrs:{label:"分组ID",prop:"groupId"}},[t("el-input",{attrs:{placeholder:"请输入 分组ID",disabled:"add"!==e.pageType},model:{value:e.form.groupId,callback:function(t){e.$set(e.form,"groupId",t)},expression:"form.groupId"}})],1),t("el-form-item",{attrs:{label:"分组名称",prop:"groupName"}},[t("el-input",{attrs:{placeholder:"请输入 分组名称"},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName",t)},expression:"form.groupName"}})],1),t("el-form-item",{attrs:{label:"容器部署",prop:"containerDeploy"}},[t("el-radio-group",{on:{change:e.changeConDeploy},model:{value:e.form.containerDeploy,callback:function(t){e.$set(e.form,"containerDeploy",t)},expression:"form.containerDeploy"}},[t("el-radio",{attrs:{label:1}},[e._v("是")]),t("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),t("el-form-item",{attrs:{label:"网关实例",prop:"instanceIps"}},[t("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:e.showIPDialog}},[e._v("添加")]),t("el-table",{staticStyle:{width:"400px"},attrs:{data:e.instanceIpsList,border:"",size:"small"}},[t("el-table-column",{attrs:{prop:"name",label:"ip/服务名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(t.row.name)+"\n                ")]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleClick(a.$index)}}},[e._v("删除")])]}}])})],1)],1)],1),t("plugin-config-con",{ref:"pluginConfigCon",attrs:{disabled:e.disabled,config:e.apiPlugins,showGroupTip:""},on:{emitData:function(t){return e.apiPlugins=t}}}),e.disabled?e._e():t("footer",[t("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.submitHandle}},[e._v("确 定")]),t("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v(" 取 消 ")])],1)],1),e.ipVisible?t("gatewayIPDialog",{attrs:{visible:e.ipVisible,isShowIP:0===e.form.containerDeploy},on:{emitData:e.changeIPInstance,changeVisible:function(t){e.ipVisible=!1}}}):e._e()],1)},i=[],r=(a("8e6e"),a("456d"),a("6762"),a("2fdb"),a("7514"),a("28a5"),a("bd86")),o=(a("ac6a"),a("5880")),s=a("16cd"),l=a("0468"),c=a("378a"),u=a("50d2");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={name:"gropDetail",components:{pluginConfigCon:c["default"],gatewayIPDialog:u["default"]},props:{type:{type:String,default:""}},watch:{instanceIpsList:{deep:!0,handler:function(){var e=[];this.instanceIpsList.forEach((function(t){e.push(t.name)})),this.$set(this.form,"instanceIps",e.join(","))}}},computed:p(p({},Object(o["mapGetters"])(["pluginOptions"])),{},{title:function(){var e="";switch(this.pageType){case"add":e="新增网关分组";break;case"edit":e="修改网关分组";break;case"view":e="网关分组详情";break}return e},id:function(){return this.$route.query.id},disabled:function(){return"view"===this.$route.params.actionType},pageType:function(){return this.$route.params.actionType}}),data:function(){return{loading:!1,form:{code:"",containerDeploy:0},rules:{groupId:[{required:!0,message:"必填",trigger:"blur"}],groupName:[{required:!0,message:"必填",trigger:"blur"}],instanceIps:[{required:!0,message:"必填",trigger:"blur"}],containerDeploy:[{required:!0,message:"必填",trigger:"change"}]},apiPlugins:[],ipVisible:!1,instanceIpsList:[]}},methods:p(p({},Object(o["mapActions"])(["getPluginOptions"])),{},{getDetail:function(){var e=this;Object(l["c"])(this.id).then((function(t){e.form=t.data.data,e.form.instanceIps&&e.form.instanceIps.split(",").forEach((function(t){e.instanceIpsList.push({name:t})})),e.initApiPlugins()}))},initApiPlugins:function(){var e=this;this.apiPlugins=[],this.form.gatewayGroupPlugins&&this.form.gatewayGroupPlugins.length&&this.form.gatewayGroupPlugins.forEach((function(t){var a=e.pluginOptions.find((function(e){return e.id===t.plugin}));a&&(t=p({apiPluginConfigs:t.gatewayGroupPluginConfigs},t),delete t.gatewayGroupPluginConfigs,e.apiPlugins.push(Object.assign({},a,t)))}))},handleClose:function(){this.$router.$avueRouter.closeTag(),this.$router.push({path:"/gateway/group"})},handleSubmitData:function(e){e=Object(s["c"])(e);var t=e.instanceIps.split(",");return t=t.map((function(e){return Object(s["b"])(e)})),t=t.join(","),e.instanceIps=t,e.gatewayGroupPlugins=[],this.apiPlugins.forEach((function(t){var a=p({gatewayGroupPluginConfigs:t.apiPluginConfigs},t);delete a.apiPluginConfigs,e.gatewayGroupPlugins.push(a)})),e},submitService:function(){var e=this,t="edit"===this.pageType?l["g"]:l["a"],a=this.handleSubmitData(this.form);this.loading=!0,t(a).then((function(){e.loading=!1,e.$message({type:"success",message:"保存成功"}),"add"===e.pageType&&e.handleClose()}),(function(t){e.loading=!1,window.console.log(t)}))},submitHandle:function(){var e=this;this.$refs.form.validate((function(t){t&&e.$refs.pluginConfigCon.validate().then((function(){e.submitService()}),(function(t){e.$message.error(t)}))}))},showIPDialog:function(){this.ipVisible=!0},changeIPInstance:function(e){var t=this,a={};this.instanceIpsList.forEach((function(e){a[e.name]=!0})),e.forEach((function(e){a[e]||t.instanceIpsList.push({name:e})}))},handleClick:function(e){this.instanceIpsList.splice(e,1)},changeConDeploy:function(){this.instanceIpsList=[]}}),created:function(){this.getPluginOptions()},mounted:function(){var e=this;this.getPluginOptions().then((function(){["edit","view"].includes(e.pageType)&&e.getDetail()}))}},f=g,h=(a("21c8"),a("2877")),m=Object(h["a"])(f,n,i,!1,null,"dd98ca92",null);t["default"]=m.exports},"7b82":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("avue-crud",{ref:"crud",attrs:{"before-open":e.beforeOpen,data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"row-del":e.rowDel,"row-update":e.rowUpdate,"row-save":e.rowSave,"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"downloadStatus",fn:function(a){var n=a.row;return[t("el-tag",[e._v("\n        "+e._s(e.calInstallStatus(n))+"\n       ")])]}},{key:"menu",fn:function(a){var n=a.type,i=a.size,r=a.row;return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.reinstallPermission(r),expression:"reinstallPermission(row)"}],attrs:{icon:"el-icon-download",size:i,type:n},on:{click:function(t){return e.install(r)}}},[e._v("重装")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.updatePermission(r),expression:"updatePermission(row)"}],attrs:{icon:"el-icon-download",size:i,type:n},on:{click:function(t){return e.install(r)}}},[e._v("更新")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.installPermission(r),expression:"installPermission(row)"}],attrs:{icon:"el-icon-download",size:i,type:n},on:{click:function(t){return e.install(r)}}},[e._v("安装")])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}}),t("el-dialog",{attrs:{"append-to-body":"",width:"900px",top:"20px","close-on-click-modal":!1,title:e.detailDialog.title,visible:e.detailDialog.visible},on:{"update:visible":function(t){return e.$set(e.detailDialog,"visible",t)}}},[t("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.rules,size:"small",disabled:"view"===e.detailDialog.type,"label-width":"140px"}},[t("el-form-item",{attrs:{label:"扩展名称",prop:"engName"}},[t("el-input",{attrs:{placeholder:"请输入扩展名称",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.engName,callback:function(t){e.$set(e.dialogForm,"engName",t)},expression:"dialogForm.engName"}}),t("span",[e._v("扩展名称由英文字母、下划线或数字组成, 不能以数字开头，如：memberAuth,  member_auth_v1")])],1),t("el-form-item",{attrs:{label:"扩展分类",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择扩展分类",disabled:""},model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type"}},e._l(e.pluginTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"扩展描述",prop:"chnName"}},[t("el-input",{attrs:{placeholder:"请输入扩展描述",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.chnName,callback:function(t){e.$set(e.dialogForm,"chnName",t)},expression:"dialogForm.chnName"}}),t("span",[e._v("如：会员登录校验")])],1),t("el-form-item",{attrs:{label:"默认执行顺序",prop:"order"}},[t("el-input",{attrs:{placeholder:"请输入默认执行顺序",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.order,callback:function(t){e.$set(e.dialogForm,"order",t)},expression:"dialogForm.order"}})],1),t("el-form-item",{attrs:{label:"表单定义",prop:"config"}},[t("data-editor",{key:e.detailDialog.type,attrs:{content:e.dialogForm.config,height:300,disabled:"view"===e.detailDialog.type||e.editDisabled},on:{"update:content":function(t){return e.$set(e.dialogForm,"config",t)}}}),t("span",[e._v("\n          路由级别的自定义属性，定义规范请参考：\n          "),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showFormTips()}}},[e._v("表单规范说明")])],1)],1),t("el-form-item",{attrs:{label:"自定义配置",prop:"fixedConfig"}},[t("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.dialogForm.fixedConfig,callback:function(t){e.$set(e.dialogForm,"fixedConfig",t)},expression:"dialogForm.fixedConfig"}}),t("span",{staticClass:"key-tips"},[e._v("扩展级别的自定义配置信息 "),t("tooltip-custom",{staticClass:"link",attrs:{title:"扩展实例"}})],1)],1),t("el-form-item",{attrs:{label:"使用说明",prop:"instruction"}},[t("el-input",{attrs:{type:"textarea",clearable:"",disabled:e.editDisabled},model:{value:e.dialogForm.instruction,callback:function(t){e.$set(e.dialogForm,"instruction",t)},expression:"dialogForm.instruction"}})],1)],1),"view"!==e.detailDialog.type?t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"small",loading:e.detailDialog.loading},on:{click:e.submitForm}},[e._v("保 存\n      ")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.detailDialog.visible=!1}}},[e._v("取 消")])],1):e._e(),t("el-dialog",{attrs:{width:"600px",title:"插件表单规范说明",visible:e.tipsDialog.visible,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.tipsDialog,"visible",t)}}},[t("code-highlight",{attrs:{height:"400",code:e.tipsDialog.content}})],1)],1)],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("6762"),a("2fdb"),a("bd86")),o=a("b5c6"),s=a("da71");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u=function(e,t,a){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/page"),method:"get",params:c(c({},a),{},{current:e,size:t})})},d=function(e){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/detail/").concat(e),method:"get"})},p=function(e){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/remove"),method:"post",params:{ids:e}})},g=function(e){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/install"),method:"post",data:e})},f=function(e){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/save"),method:"post",data:e})},h=function(e){return Object(o["a"])({url:"".concat(s["a"],"/extension/market/update"),method:"post",data:e})},m=a("dd62"),b=a("5880"),v=a("c54a"),y=a("4627"),O=a("d480"),w=a("6c1d");function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _=[{label:"内置插件",value:1},{label:"自定义插件",value:2},{label:"动态插件",value:3},{label:"动态组件",value:4}],k={data:function(){return{intervalTimer:null,activeTab:"active",pluginTypes:[{label:"内置插件",value:1},{label:"自定义插件",value:2},{label:"动态插件",value:3},{label:"动态组件",value:4}],form:{},dialogForm:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{dialogWidth:900,border:!0,index:!0,addBtn:!1,editBtn:!1,viewBtn:!0,columnBtn:!1,menuPosition:"right",column:[{label:"ID",prop:"id",width:160},{label:"扩展分类",prop:"type",type:"select",dicData:_,width:70},{label:"扩展名称",prop:"engName",search:!0,overHidden:!0,width:180},{label:"扩展描述",prop:"chnName",search:!0,overHidden:!0},{label:"安装状态",slot:!0,prop:"downloadStatus",overHidden:!0,width:160}]},data:[],rules:{engName:[{required:!0,message:"必填",trigger:"blur"},{pattern:/^[A-Za-z_][A-Za-z\d_\.]*$/,message:"格式有误",trigger:"blur"}],chnName:[{required:!0,message:"必填",trigger:"blur"}],order:[{required:!0,message:"必填",trigger:"blur"},{pattern:/^\d+$/,message:"请输入自然数",trigger:"blur"}]},detailDialog:{visible:!1,title:"详情",type:"",loading:!1},tipsDialog:{title:"js",visible:!1,content:"111"}}},computed:D(D({},Object(b["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.gateway_plugin_add,!1),editBtn:this.vaildData(this.permission.gateway_plugin_edit,!1),viewBtn:this.vaildData(this.permission.gateway_plugin_view,!1),delBtn:!1}},editDisabled:function(){return"edit"===this.detailDialog.type&&1==this.dialogForm.type}}),watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},mounted:function(){var e=this;e.intervalTimer=setInterval((function(){e.refreshChange()}),2e4)},unmounted:function(){clearInterval(self.intervalTimer)},components:{market:S,dataEditor:y["default"],codeHighlight:O["default"],tooltipCustom:m["default"]},methods:{calInstallStatus:function(e){var t="";if(e.installed)switch(e.downloadStatus){case 100:t="已安装";break;case 200:t="重装中";break;case 400:t="已安装（下载完成）";break;case 401:t="重装失败（下载失败）";break;default:t="未知状态";break}else switch(e.downloadStatus){case 100:t="未安装";break;case 200:t="安装中";break;case 400:t="已安装（下载完成）";break;case 401:t="安装失败（下载失败）";break;default:t="未知状态";break}return t},install:function(e){g(e).then((function(e){200==e.data.code&&console.log("安装中")})).catch((function(){}))},reinstallPermission:function(e){return!(e.needsUpdate||!e.installed)&&this.vaildData(this.permission.gateway_plugin_delete,!1)},updatePermission:function(e){return!!e.needsUpdate&&this.vaildData(this.permission.gateway_plugin_delete,!1)},installPermission:function(e){return!e.needsUpdate&&!e.installed&&this.vaildData(this.permission.gateway_plugin_delete,!1)},showFormTips:function(){this.tipsDialog.content=w["a"].pluginFormJS,this.tipsDialog.visible=!0},submitForm:function(){var e=this;this.$refs.dialogForm.validate((function(t){if(t){var a=e.dialogForm,n=Object(v["k"])(a.config);if(a.config&&!n)return e.$message.error("表单定义配置JSON格式有误"),!1;if(a.config&&!(a.config instanceof Array))return e.$message.error("表单定义配置需为数组格式结构"),!1;var i=Object.assign({},a);a.config&&a.config.length?i.config=JSON.stringify(a.config):i.config="","edit"===e.detailDialog.type?e.rowUpdate(i):e.rowSave(i)}}))},rowSave:function(e){var t=this;this.detailDialog.loading=!0,f(e).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"保存成功"}),t.detailDialog.visible=!1}),(function(e){window.console.log(e)})).finally((function(){t.detailDialog.loading=!1}))},rowUpdate:function(e){var t=this;this.detailDialog.loading=!0,h(e).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"修改成功"}),t.detailDialog.visible=!1}),(function(e){window.console.log(e)})).finally((function(){t.detailDialog.loading=!1}))},rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return p(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},beforeOpen:function(e,t){var a=this;switch(this.detailDialog.type=t,t){case"add":this.detailDialog.title="新增";break;case"edit":this.detailDialog.title="编辑";break;case"view":this.detailDialog.title="查看";break;default:this.detailDialog.title="详情";break}this.dialogForm={type:2},["edit","view"].includes(t)&&d(this.form.id).then((function(e){a.form=e.data.data,a.dialogForm=Object.assign({},e.data.data||{}),a.detailDialog.visible=!0})),this.detailDialog.visible=!0},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,u(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))}}},P=k,C=(a("cd29"),a("2877")),x=Object(C["a"])(P,n,i,!1,null,null,null),S=t["default"]=x.exports},"7df7":function(e,t,a){"use strict";a("62e9")},"80a3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[e.pluginConfig.length?e._l(e.pluginConfig,(function(a,n){return t("el-form-item",{key:n,attrs:{label:a.label,prop:a.field,rules:a.rules}},["input"===a.component?[["number","long","double"].some((function(e){return e===a.dataType}))?t("el-input",{attrs:{type:"number",placeholder:a.placeholder+"??",autocomplete:"off",clearable:""},model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,e._n(t))},expression:"formData[comp.field]"}}):t("el-input",{attrs:{placeholder:a.placeholder,autocomplete:"off",clearable:""},model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,t)},expression:"formData[comp.field]"}})]:e._e(),"select"===a.component?[t("el-select",{attrs:{placeholder:a.placeholder,clearable:""},model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,t)},expression:"formData[comp.field]"}},e._l(a.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]:e._e(),"radio"===a.component?[t("el-radio-group",{model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,t)},expression:"formData[comp.field]"}},e._l(a.options,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v("\n                "+e._s(a.label)+"\n              ")])})),1)]:e._e(),"checkbox"===a.component?[t("el-checkbox-group",{model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,t)},expression:"formData[comp.field]"}},e._l(a.options,(function(a){return t("el-checkbox",{key:a.value,attrs:{label:a.value}},[e._v("\n                "+e._s(a.label)+"\n              ")])})),1)]:e._e(),"textarea"===a.component?[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:6},placeholder:a.placeholder,autocomplete:"off",clearable:""},model:{value:e.formData[a.field],callback:function(t){e.$set(e.formData,a.field,t)},expression:"formData[comp.field]"}})]:e._e(),t("div",{staticStyle:{color:"#999","font-size":"12px"}},[e._v("\n            "+e._s(a.desc)+"\n             "),a.tooltipValue?t("el-popover",{attrs:{"popper-class":"tooltip-dark",placement:"top",title:a.tooltipLabel||"使用说明",width:a.tooltipWidth||500}},[t("div",{staticClass:"content"},[e._v("\n                  "+e._s(a.tooltipValue)+"\n                ")]),t("span",{attrs:{slot:"reference"},slot:"reference"},[e._v("("+e._s(a.tooltipLabel||"使用说明")+")")])]):e._e()],1),e.getRefData(e.formData[a.field],a).length>0?t("div",{staticClass:"cycle-con"},[t("plugin-form-item",{attrs:{pluginConfig:e.getRefData(e.formData[a.field],a),formData:e.formData}})],1):e._e()],2)})):[t("el-alert",{attrs:{title:"当前插件配置有误",type:"warning",closable:!1}})]],2)},i=[],r={name:"pluginFormItem",data:function(){return{}},props:{pluginConfig:{type:Array,default:function(){return[]}},formData:{type:Object,default:function(){return{}}}},methods:{getRefData:function(e,t){try{var a=t.options,n=a.filter((function(t){return t.value==e}))[0];if(n.refData&&n.refData.length>0){var i=n.refData.map((function(e){return delete e.ref,e}));return i}return[]}catch(r){}return[]}}},o=r,s=(a("7df7"),a("2877")),l=Object(s["a"])(o,n,i,!1,null,null,null);t["default"]=l.exports},"84cd":function(e,t,a){"use strict";a.r(t);a("7f7f");var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("el-alert",{attrs:{title:"网关本地缓存的已发布接口信息，版本号为网关实际使用的接口版本。",type:"warning",closable:!1}}),t("el-card",{staticClass:"box-card"},[t("header",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v("["+e._s(e.originId)+"] 网关详情")]),t("avue-crud",{ref:"crud",attrs:{data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList,"cell-class-name":"api-cell"},on:{"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"menu",fn:function(a){var n=a.row,i=a.type,r=a.size;return[t("el-button",{attrs:{icon:"el-icon-view",size:r,type:i},on:{click:function(t){return e.getDetail(n)}}},[e._v("查看\n        ")])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),t("el-dialog",{attrs:{title:"Config Json","append-to-body":"",top:"5vh",width:"900px",visible:e.configDialog},on:{"update:visible":function(t){e.configDialog=t}}},[e.form.serviceName?t("el-tag",[e._v("服务["+e._s(e.form.serviceName)+"]")]):e._e(),e._v(" \n    "),e.form.name?t("b",[e._v(" ["+e._s(e.form.name)+"] ")]):e._e(),t("el-divider"),t("code-highlight",{attrs:{language:"json",code:e.jsonCode,height:600}})],1)],1)},i=[],r=a("e5ec"),o=a("d480"),s={data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{size:"mini",dialogWidth:900,menuWidth:120,border:!0,index:!0,addBtn:!1,editBtn:!1,delBtn:!1,columnBtn:!1,menuPosition:"right",column:[{label:"所属服务",prop:"serviceName",search:!0},{label:"接口名",prop:"name",minWidth:120,search:!0},{label:"方法",prop:"method",width:80},{label:"路径",prop:"path",minWidth:120,search:!0},{label:"版本号",prop:"version",width:80}]},data:[],configDialog:!1,configJson:""}},computed:{originId:function(){return this.$route.query.originId||""},jsonCode:function(){var e="";if(this.configJson)try{e=JSON.parse(this.configJson)}catch(t){e=this.configJson||""}return JSON.stringify(e,null,"    ")}},components:{codeHighlight:o["default"]},watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{getDetail:function(e){var t=this;e.configId?(this.form=e,Object(r["a"])({instanceId:this.originId,configId:e.configId}).then((function(e){t.configJson=e.data.data||"",t.configDialog=!0}))):this.$message.error("数据缺失，无法操作！")},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,a.instanceId=this.originId,Object(r["b"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1,t.selectionClear()}))}}},l=s,c=(a("3f28"),a("2877")),u=Object(c["a"])(l,n,i,!1,null,"096e071c",null);t["default"]=u.exports},"87ab":function(e,t,a){"use strict";a("a04f")},"8e7d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"datatime-range",class:e.className},[t("div",{staticClass:"picker-item"},[t("el-date-picker",{attrs:{type:e.type,placeholder:e.startPlaceholder,align:"right","picker-options":e.startPickerOptions,clearable:e.startClear,readonly:e.readonly,"value-format":e.valueFormat,size:e.size,"default-time":e.defaultTime[0]},on:{change:e.changeTime},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),t("span",{staticClass:"interval"},[e._v("-")]),t("div",{staticClass:"picker-item"},[t("el-date-picker",{attrs:{type:e.type,placeholder:e.endPlaceholder,align:"right","picker-options":e.endPickerOptions,clearable:e.endClear,readonly:e.readonly,"value-format":e.valueFormat,size:e.size,"default-time":e.defaultTime[1]},on:{change:e.changeTime},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1)])},i=[],r=(a("6b54"),a("6762"),a("2fdb"),{name:"datatime-range",props:{className:{type:String,default:""},readonly:{type:Boolean,default:!1},size:{type:String,default:"small",validator:function(e){return-1!==["large","small","mini"].indexOf(e)}},type:{type:String,default:"datetime",validator:function(e){return-1!==["year","month","date","week","datetime"].indexOf(e)}},defaultValue:{type:Array,default:function(){return["",""]}},valueFormat:{type:String,default:"yyyy-MM-dd HH:mm:ss"},startOptions:{type:Object,default:function(){return{}}},endOptions:{type:Object,default:function(){return{}}},notMaxtTodayStart:{type:Boolean,default:!0},notMaxtTodayEnd:{type:Boolean,default:!0},startPlaceholder:{type:String,default:"请选择开始时间"},endPlaceholder:{type:String,default:"请选择结束时间"},defaultTime:{type:String|Array,default:function(e){return"string"===typeof e?[e,e]:e||["",""]}},clearable:{type:Boolean,default:!0},startClearable:{},endClearable:{}},computed:{startPickerOptions:function(){return["date","datetime"].includes(this.type)?Object.assign({},this.beginDate(),this.defaultOption,this.startOptions):Object.assign({},this.defaultOption,this.startOptions)},endPickerOptions:function(){return["date","datetime"].includes(this.type)?Object.assign({},this.processDate(),this.defaultOption,this.endOptions):Object.assign({},this.defaultOption,this.endOptions)}},data:function(){return{startTime:"",endTime:"",defaultOption:{},distance:0,startClear:!1,endClear:!1}},watch:{defaultValue:{immediate:!0,handler:function(){this.startTime=this.defaultValue[0]||"",this.endTime=this.defaultValue[1]||""}}},methods:{beginDate:function(){var e=this;return{disabledDate:function(t){var a=(new Date).getTime(),n=t.getTime();if(e.endTime){var i=new Date(e.endTime).getTime();return e.notMaxtTodayStart?Math.min(i,a)<n:i<n}if(e.notMaxtTodayStart)return a<n}}},processDate:function(){var e=this;return{disabledDate:function(t){var a=(new Date).getTime(),n=t.getTime();if(e.startTime){var i=new Date(e.startTime).getTime();return e.notMaxtTodayEnd?i-e.distance>n||n>a:i-e.distance>n}if(e.notMaxtTodayEnd)return a<n}}},changeTime:function(){if(this.distance=0,this.startTime&&"datetime"===this.type){var e=new Date(this.startTime);(e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0)&&(this.distance=864e5)}if(this.startTime&&this.endTime){var t=new Date(this.startTime).getTime(),a=new Date(this.endTime).getTime();if(t>a)return this.$message({showClose:!0,message:"开始时间不能大于结束时间！",type:"warning"}),void(this.startTime=this.endTime)}this.$emit("change",[this.startTime,this.endTime]),this.$emit("update:time",[this.startTime,this.endTime])}},mounted:function(){this.startClear="[object Boolean]"!==Object.prototype.toString.call(this.startClearable)?this.clearable:this.startClearable,this.endClear="[object Boolean]"!==Object.prototype.toString.call(this.endClearable)?this.clearable:this.endClearable}}),o=r,s=(a("35e2"),a("2877")),l=Object(s["a"])(o,n,i,!1,null,"4969b99b",null);t["default"]=l.exports},"8f4f":function(e,t,a){},"987a":function(e,t,a){"use strict";a("5568")},"9ee6":function(e,t,a){},a04f:function(e,t,a){},b084:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,"modal-append-to-body":!1,"append-to-body":!0,"close-on-click-modal":!1,width:"800px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"small",disabled:e.disabled}},[t("el-form-item",{attrs:{label:"键(Key)",prop:"key"}},[t("el-input",{attrs:{placeholder:"请输入 键(Key)"},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}}),t("span",{staticClass:"key-tips"},[e._v("Key只能包含字母、数字、下划线或中横线")])],1),t("el-form-item",{attrs:{label:"数据类型",prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择 数据类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.params_type,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("span",{staticClass:"key-tips"},[e._v("字典值的数据类型，支持boolean、number、string 和 json")])],1),t("el-form-item",{attrs:{label:"值(Value)",prop:"value"}},[t("el-input",{attrs:{placeholder:"请输入 值(Value)",type:"textarea",rows:5},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1)],1),e.disabled?e._e():t("footer",{staticStyle:{"text-align":"right"}},[t("el-button",{attrs:{size:"small",type:"primary",loading:e.loading},on:{click:e.submitHandle}},[e._v("确 定")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 取 消 ")])],1)],1)},i=[],r=(a("6762"),a("2fdb"),a("dd69")),o=a("c597"),s=a("c54a"),l=a("16cd"),c={name:"dictDetail",props:{visible:{type:Boolean,default:!1},type:{type:String,default:""},id:{type:String}},computed:{dialogVisible:{get:function(){return this.visible},set:function(){this.$emit("changeVisible")}},title:function(){var e="";switch(this.type){case"add":e="新增 公共资源";break;case"edit":e="修改 公共资源";break;case"view":e="公共资源 详情";break}return e}},data:function(){return{loading:!1,disabled:!1,form:{},rules:{key:[{required:!0,message:"必填",trigger:"blur"},{pattern:/^[0-9a-zA-Z_-]{1,}$/,message:"Key只能包含字母、数字、下划线或中横线",trigger:"blur"}],type:[{required:!0,message:"必填",trigger:"change"}],value:[{required:!0,message:"必填",trigger:"blur"}]},params_type:r["a"]}},methods:{submitHandle:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.form.value=Object(l["b"])(e.form.value);var a="";switch(e.form.type){case 1:["true","false"].includes(e.form.value)||(a="值(Value) 应为 true 或 false！");break;case 3:Object(s["l"])(e.form.value)||(a="值(Value) 应为 数字！");break;case 4:Object(s["m"])(e.form.value)||(a="值(Value) 应为json格式！");break}if(a)return void e.$message({type:"warning",message:a});var n="add"===e.type?o["a"]:o["f"];e.loading=!0,n(e.form).then((function(t){200===t.data.code?(e.$message({type:"success",message:"保存成功！"}),e.dialogVisible=!1,e.$emit("doSearch")):e.$message({type:"error",message:t.data.msg||"保存失败！"})})).finally((function(){e.loading=!1}))}}))},getDetail:function(){var e=this;Object(o["b"])(this.id).then((function(t){200===t.data.code?e.form=t.data.data:e.$message({type:"error",message:t.data.msg||"获取详情 失败！"})}))}},mounted:function(){["edit","view"].includes(this.type)&&this.getDetail(),"view"===this.type&&(this.disabled=!0)}},u=c,d=(a("e6d0"),a("2877")),p=Object(d["a"])(u,n,i,!1,null,"ec384f7c",null);t["default"]=p.exports},b76d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("el-alert",{attrs:{title:"当前网关在线实例列表，点击查看按钮查看指定实例网关本地缓存的已发布接口信息。",type:"warning",closable:!1}}),t("avue-crud",{ref:"crud",attrs:{data:e.data,option:e.option,"table-loading":e.loading,permission:e.permissionList},on:{"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"menu",fn:function(a){var n=a.row,i=a.type,r=a.size;return[t("el-button",{attrs:{icon:"el-icon-view",size:r,type:i},on:{click:function(t){return e.goDetail(n)}}},[e._v("查看\n      ")])]}}])})],1)},i=[],r=(a("386d"),a("e5ec")),o={data:function(){return{query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},selectionList:[],option:{menuWidth:120,border:!0,index:!0,addBtn:!1,editBtn:!1,delBtn:!1,columnBtn:!1,menuPosition:"right",column:[{label:"IP",prop:"host"},{label:"端口",prop:"port"}]},data:[]}},watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{goDetail:function(e){if(e.instanceId){var t="/gateway/config";this.$router.push({path:t,query:{originId:e.instanceId}})}else this.$message.error("数据缺失，无法操作！")},searchReset:function(){this.query={},this.search.apiFilterConfigId=[],this.search.method=[],this.onLoad(this.page)},searchChange:function(e,t){this.search.apiFilterConfigId_in=this.search.apiFilterConfigId.join(",")||"",this.search.method_in=this.search.method.join(",")||"",e=Object.assign(e,this.search),e.apiFilterConfigId_in=e.apiFilterConfigId.join(",")||"",e.method_in=e.method.join(",")||"",delete e.apiFilterConfigId,delete e.method,this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud&&this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(r["c"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a,t.loading=!1,t.selectionClear()}))}}},s=o,l=a("2877"),c=Object(l["a"])(s,n,i,!1,null,null,null);t["default"]=c.exports},c597:function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"c",(function(){return g}));a("8e6e"),a("ac6a"),a("456d");var n=a("bd86"),i=a("b5c6"),r=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param/save"),method:"post",data:e})},u=function(e){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param/update"),method:"post",data:e})},d=function(e){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param/detail/").concat(e),method:"get"})},p=function(e){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param/remove"),method:"post",params:{ids:e}})},g=function(e,t,a){return Object(i["a"])({url:"".concat(r["a"],"/gateway-param-history/list"),method:"get",params:s(s({},a),{},{current:e,size:t})})}},cd29:function(e,t,a){"use strict";a("9ee6")},d7d1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",[t("avue-crud",{ref:"crud",attrs:{"before-open":e.beforeOpen,data:e.data,page:e.page,option:e.option,"table-loading":e.loading,permission:e.getPermission},on:{"update:page":function(t){e.page=t},"row-del":e.rowDel,"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"instanceIpsForm",fn:function(a){return[t("div",[t("el-input",{attrs:{type:"textarea",placeholder:"网关实例IP",autosize:{minRows:3,maxRows:8},clearable:""},model:{value:e.form.instanceIps,callback:function(t){e.$set(e.form,"instanceIps",t)},expression:"form.instanceIps"}}),t("span",{staticClass:"key-tips"},[e._v("多个IP用逗号,分隔，需填写实际IP，不能填写127.0.0.1")])],1)]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},i=[],r=(a("8e6e"),a("456d"),a("bd86")),o=(a("ac6a"),a("28a5"),a("0468")),s=a("5880"),l=a("16cd"),c=a("c54a");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{dialogWidth:900,border:!0,index:!0,dialogClickModal:!1,viewBtn:!0,columnBtn:!1,menuPosition:"right",labelWidth:100,column:[{label:"分组ID",prop:"groupId",search:!0,editDisabled:!0,overHidden:!0,rules:[{required:!0,message:"必填",trigger:"blur"}]},{label:"分组名称",prop:"groupName",search:!0,overHidden:!0,rules:[{required:!0,message:"必填",trigger:"blur"}]},{label:"扩展名称",prop:"pluginNames"},{label:"网关实例IP",prop:"instanceIps",placeholder:"多个IP用逗号,分隔",overHidden:!0,type:"textarea",span:24,minRows:3,formslot:!0,rules:[{required:!0,message:"必填",trigger:"blur"},{validator:function(e,t,a){var n=t.split(","),i=!0,r=!1;if(n.forEach((function(e){e&&!Object(c["j"])(Object(l["b"])(e))?i=!1:"127.0.0.1"===Object(l["b"])(e)&&(i=!1,r=!0)})),t&&!i){var o=r?"请勿填写127.0.0.1":"请输入正确的IP";a(new Error(o))}else a()},trigger:"blur"}]}]},data:[]}},computed:d(d({},Object(s["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.gateway_group_add,!1),editBtn:this.vaildData(this.permission.gateway_group_edit,!1),viewBtn:this.vaildData(this.permission.gateway_group_view,!1),delBtn:this.vaildData(this.permission.gateway_group_delete,!1)}}}),watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},methods:{getPermission:function(e,t){return!("addBtn"===e&&!this.permissionList.addBtn)&&(!("viewBtn"===e&&!this.permissionList.viewBtn)&&(!("editBtn"===e&&!this.permissionList.editBtn)&&!!("delBtn"!==e||"default"!==t.groupId&&this.permissionList.delBtn)))},handleSubmitData:function(e){e=Object(l["c"])(e);var t=e.instanceIps.split(",");return t=t.map((function(e){return Object(l["b"])(e)})),t=t.join(","),e.instanceIps=t,e},rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(o["f"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},beforeOpen:function(e,t){this.type=t,this.id=this.form.id,this.$router.push({path:"/gateway/group/".concat(t),query:{id:this.form.id}})},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(o["e"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))}}},g=p,f=(a("987a"),a("2877")),h=Object(f["a"])(g,n,i,!1,null,"5789bda2",null);t["default"]=h.exports},df14:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("basic-container",{staticClass:"gateway-dict"},[t("avue-crud",{ref:"crud",attrs:{data:e.data,search:e.query,page:e.page,option:e.option,"table-loading":e.loading,permission:e.permissionList,"before-open":e.beforeOpen},on:{"update:search":function(t){e.query=t},"update:page":function(t){e.page=t},"row-del":e.rowDel,"row-update":e.rowUpdate,"row-save":e.rowSave,"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"menu",fn:function(a){var n=a.row;return[e.permissionList.historyBtn?t("el-button",{attrs:{icon:"el-icon-bank-card",size:"small",type:"text"},on:{click:function(t){return e.handleHistory(n.id)}}},[e._v("更改历史")]):e._e()]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}}),e.visible?t("dict-detail-dialog",{attrs:{visible:e.visible,type:e.type,id:e.id},on:{doSearch:e.doSearch,changeVisible:function(t){e.visible=!1}}}):e._e()],1)},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=a("5880"),s=a("b084"),l=a("c597"),c=a("dd69");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p={name:"dict",components:{dictDetailDialog:s["default"]},data:function(){return{query:{},form:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{border:!0,index:!0,dialogClickModal:!1,viewBtn:!0,editBtn:!0,columnBtn:!1,menuPosition:"right",labelWidth:100,menuWidth:300,column:[{label:"键(Key)",prop:"key",search:!0},{label:"值(Value)",prop:"value",search:!0},{label:"数据类型",prop:"type",dicData:c["a"]},{label:"创建时间",prop:"createTime"},{label:"更新时间",prop:"updateTime"}]},data:[],visible:!1,id:null}},watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},computed:d(d({},Object(o["mapGetters"])(["permission"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.gateway_dict_add,!1),editBtn:this.vaildData(this.permission.gateway_dict_edit,!1),delBtn:this.vaildData(this.permission.gateway_dict_remove,!1),historyBtn:this.vaildData(this.permission.gateway_dict_history,!1)}}}),methods:{rowDel:function(e){var t=this;this.$confirm("你确定要删除此公共参数吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["e"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"删除成功"})}))},beforeOpen:function(e,t){this.id=this.form.id,this.type=t,this.visible=!0},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(l["d"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))},doSearch:function(){this.onLoad({currentPage:1,pageSize:this.page.pageSize})},handleHistory:function(e){this.$router.push({path:"/gateway/dictHistory",query:{id:e}})}}},g=p,f=a("2877"),h=Object(f["a"])(g,n,i,!1,null,"21b8be74",null);t["default"]=h.exports},e3f0:function(e,t,a){"use strict";a.r(t);a("386d");var n=function(){var e=this,t=e._self._c;return t("basic-container",{staticClass:"gateway-log"},[e.isOpenLog?e._e():t("el-alert",{staticClass:"alert-tip",attrs:{title:"未启用网关日志功能，如需使用请在设置管理里开启。",type:"warning",closable:!1}}),t("avue-crud",{ref:"crud",attrs:{data:e.data,search:e.search,page:e.page,option:e.option,"table-loading":e.loading},on:{"update:search":function(t){e.search=t},"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"expand",fn:function(a){var n=a.row;return[t("el-input",{attrs:{type:"textarea",rows:8,resize:"none",readonly:""},model:{value:n.content,callback:function(t){e.$set(n,"content",t)},expression:"row.content"}})]}},{key:"search",fn:function(a){var n=a.size;return[t("el-checkbox",{attrs:{size:n},model:{value:e.search.bizIdExactMatchingFlag,callback:function(t){e.$set(e.search,"bizIdExactMatchingFlag",t)},expression:"search.bizIdExactMatchingFlag"}},[e._v("全匹配")])]}},{key:"logTimeSearch",fn:function(a){var n=a.size;return[t("datetime-range",{attrs:{defaultValue:e.search.logTime,"start-placeholder":"开始日期","end-placeholder":"结束日期",type:"datetime",size:n,defaultTime:["00:00:00","00:00:00"]},on:{"update:defaultValue":function(t){return e.$set(e.search,"logTime",t)},"update:default-value":function(t){return e.$set(e.search,"logTime",t)},change:function(t){return e.search.logTime=t}}})]}}])})],1)},i=[],r=a("e5ec"),o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),s=a("b5c6"),l=a("da71");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=function(e,t,a){return Object(s["a"])({url:"".concat(l["a"],"/gateway-log/list"),method:"get",params:u(u({},a),{},{current:e,size:t})})},p=function(){return Object(s["a"])({url:"".concat(l["a"],"/gateway-log/is-send-log-on"),method:"get"})},g=a("8e7d"),f=[{label:"FATAL",value:100},{label:"ERROR",value:200},{label:"WARN",value:300},{label:"INFO",value:400},{label:"DEBUG",value:500},{label:"TRACE",value:600}],h={components:{datetimeRange:g["default"]},data:function(){return{isOpenLog:!0,search:{bizIdExactMatchingFlag:!0},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},option:{border:!0,index:!0,addBtn:!1,columnBtn:!1,menuPosition:"right",menu:!1,expand:!0,align:"center",defaultExpandAll:!0,expandFixed:!1,expandWidth:30,column:[{label:"日志时间",prop:"logTime",search:!0,searchslot:!0,searchRange:!0,searchSpan:12,type:"datetime",valueFormat:"yyyy-MM-dd HH:mm:ss"},{label:"服务器IP",prop:"serverIp",search:!0,type:"select",dicData:[],props:{label:"host",value:"host"},searchPlaceholder:"全部"},{label:"日志等级",prop:"level",search:!0,type:"select",dicData:f,searchMultiple:!0,searchTags:!0},{label:"日志内容",prop:"content",search:!0,hide:!0},{label:"业务ID",prop:"bizId",search:!0}]},data:[]}},watch:{data:function(){var e=this;this.$nextTick((function(){e.$refs.crud.refreshTable()}))}},created:function(){this.isSendLogOn(),this.getHostOption()},methods:{getHostOption:function(){var e=this;Object(r["c"])().then((function(t){var a=e.findObject(e.option.column,"serverIp");a.dicData=t.data.data}))},searchReset:function(){this.query={},this.search={bizIdExactMatchingFlag:!1},this.onLoad(this.page)},searchChange:function(e,t){e.logTime&&e.logTime.length>0&&(e.logStartTime=e.logTime[0]||"",e.logEndTime=e.logTime[1]||"",delete e.logTime),e.level&&e.level.length>0&&(e.levels=e.level.join(","),delete e.level),this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,d(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1}))},isSendLogOn:function(){var e=this;p().then((function(t){200==t.data.code&&(e.isOpenLog=t.data.data,e.isOpenLog||e.$message.warning("未启用网关日志功能，如需使用请在设置管理里开启。"))}))}}},m=h,b=(a("6ce4"),a("2561"),a("2877")),v=Object(b["a"])(m,n,i,!1,null,"ea0e7166",null);t["default"]=v.exports},e5ec:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));a("8e6e"),a("ac6a"),a("456d");var n=a("bd86"),i=a("b5c6"),r=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(i["a"])({url:"".concat(r["a"],"/fizz-gateway-aggregate/get-instance-list"),method:"get",params:s(s({},a),{},{current:e,size:t})})},c=function(e,t,a){return Object(i["a"])({url:"".concat(r["a"],"/fizz-gateway-aggregate/get-config-list"),method:"post",params:s(s({},a),{},{current:e,size:t})})},u=function(e){var t=e.instanceId,a=e.configId;return Object(i["a"])({url:"".concat(r["a"],"/fizz-gateway-aggregate/get-config-str/").concat(t,"/").concat(a),method:"get"})}},e6d0:function(e,t,a){"use strict";a("e76d")},e738:function(e,t,a){"use strict";a("3425")},e76d:function(e,t,a){},e833:function(e,t,a){"use strict";a("8f4f")},fb07:function(e,t,a){},ffb0:function(e,t,a){"use strict";a("fb07")}}]);