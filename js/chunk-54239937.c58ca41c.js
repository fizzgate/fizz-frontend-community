/*!
 * Fizz-Admin v2.2.3
 * (c) 2020-2021 Joker-Lee
 * AGPL v3 Licensed.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54239937"],{"047b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"发布","append-to-body":"",visible:e.visible,"before-close":e.handleClose,width:"500px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"b-tip"},[e._v("确定发布【"+e._s(e.name)+"】此接口吗?")]),a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"sub-title",staticStyle:{width:"80px"}},[e._v("备注：")]),a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入备注"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small",loading:e.loading},on:{click:e.confirmPublish}},[e._v("确 定\n    ")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleClose()}}},[e._v("取 消")])],1)])},n=[],i=(a("c5f6"),a("708f")),o={name:"publish-dialog",data:function(){return{loading:!1,remark:""}},props:{visible:{type:Boolean,default:!1},name:{type:String,default:"*"},id:{type:[String,Number],required:!0},callback:{type:Function}},watch:{visible:function(e){e||(this.remark="")}},methods:{confirmPublish:function(){var e=this;if(this.id)return this.loading=!0,Object(i["k"])({id:this.id,remark:this.remark}).then((function(){e.callback&&"function"===typeof e.callback&&e.callback(),e.$message.success("发布成功"),e.$emit("update:visible",!1)})).finally((function(){e.loading=!1}));this.$message.error("信息错误，请重新选择！")},handleClose:function(e){this.$emit("update:visible",!1),e&&e()}}},c=o,l=(a("8138"),a("2877")),s=Object(l["a"])(c,r,n,!1,null,"47ee163f",null);t["default"]=s.exports},"09b0":function(e,t,a){"use strict";a("66f0")},"0f43":function(e,t,a){"use strict";a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"i",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"b",(function(){return d})),a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return m}));a("8e6e"),a("ac6a"),a("456d");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/listApply"),method:"get",params:c(c({},a),{},{current:e,size:t})})},s=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/detail/").concat(e),method:"get"})},u=function(e){var t=e.applyId,a=e.configId,r=e.remark;return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/revoke/").concat(t,"/").concat(a),method:"post",params:{remark:r}})},p=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/revoke/").concat(e),method:"post"})},d=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/exec/").concat(e),method:"post"})},f=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/rollback/").concat(e),method:"post"})},g=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/resubmit"),method:"post",data:e})},b=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply-config-op-log/list/").concat(e),method:"get"})},m=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/change-approval-user"),method:"post",data:e})}},1120:function(e,t,a){},"227d":function(e,t,a){},"247e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"apply-dialog",attrs:{title:e.title,"append-to-body":"",width:"80%",visible:e.visible,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"apply-table-wrap"},[a("div",{staticClass:"b-tip"},[e._v("\n      操作以下接口：\n      "),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){e.drawer=!0}}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",size:"mini","max-height":"240"}},[a("el-table-column",{attrs:{prop:"serviceName",label:"所属服务"}}),a("el-table-column",{attrs:{prop:"name",label:"接口名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.name||t.row.configName)+"\n        ")]}}])}),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index,e.tableData)}}},[e._v("\n            移除\n          ")])]}}])})],1)],1),a("el-form",{ref:"applyForm",attrs:{model:e.applyForm,rules:e.rules,size:"small","label-width":"120px"}},[a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{attrs:{placeholder:"发布|下线标题"},model:{value:e.applyForm.title,callback:function(t){e.$set(e.applyForm,"title",t)},expression:"applyForm.title"}})],1),a("el-form-item",{attrs:{label:"类型：",prop:"type"}},[a("el-radio-group",{model:{value:e.applyForm.type,callback:function(t){e.$set(e.applyForm,"type",t)},expression:"applyForm.type"}},[a("el-radio",{attrs:{label:0}},[e._v("发布")]),a("el-radio",{attrs:{label:1}},[e._v("下线")])],1)],1),a("el-form-item",{attrs:{label:"申请原因：",prop:"reason"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"申请原因"},model:{value:e.applyForm.reason,callback:function(t){e.$set(e.applyForm,"reason",t)},expression:"applyForm.reason"}})],1),a("el-form-item",{attrs:{label:"选择审核人：",prop:"approvalUser"}},[a("el-select",{attrs:{placeholder:"请选择审核人"},model:{value:e.applyForm.approvalUser,callback:function(t){e.$set(e.applyForm,"approvalUser",t)},expression:"applyForm.approvalUser"}},e._l(e.approvalUsers,(function(e){return a("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small",loading:e.loading},on:{click:e.confirm}},[e._v("提交\n    ")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleClose()}}},[e._v("取 消")])],1),a("el-drawer",{ref:"drawer",attrs:{"append-to-body":"",title:"添加接口",size:"60%",visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[a("div",[a("div",{staticStyle:{"padding-bottom":"50px"}},[a("apply-api",{attrs:{selection:e.selectionApi},on:{"update:selection":function(t){e.selectionApi=t}}})],1),a("footer",{staticClass:"drawer-footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleDrawerConfirm()}}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawer=!1}}},[e._v("取 消")])],1)])])],1)},n=[],i=(a("4f7f"),a("5df3"),a("1c4c"),a("456d"),a("ac6a"),a("c5f6"),a("708f")),o=a("0f43"),c=a("6d18"),l={name:"publish-dialog",data:function(){return{loading:!1,drawer:!1,selectionApi:[],tableData:[],applyForm:{title:"",type:"",reason:"",approvalUser:""},approvalUsers:[],rules:{title:[{required:!0,message:"请输入申请标题",trigger:"blur"}],type:[{required:!0,message:"请选择申请类型",trigger:"change"}],approvalUser:[{required:!0,message:"请选择审核人",trigger:"change"}]}}},props:{visible:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}},form:{type:Object,default:function(){return{}}},id:{type:[Number,String]},callback:{type:Function}},computed:{title:function(){return this.id?"发布|下线申请修改":"发布|下线申请"},ids:function(){var e=[];return this.tableData.forEach((function(t){e.push(t.id||t.configId)})),e}},components:{applyApi:c["default"]},watch:{visible:{handler:function(e){e||(this.applyForm={title:"",type:"",reason:"",approvalUser:""})}},list:{deep:!0,handler:function(){this.initData()}},form:{deep:!0,handler:function(e){var t=this;Object.keys(this.applyForm).forEach((function(a){t.applyForm[a]=e[a]}))}},ids:{handler:function(){this.getApprovalUsers()}}},methods:{handleDrawerConfirm:function(){this.$refs.drawer.closeDrawer(),this.addData(this.selectionApi)},getApprovalUsers:function(){var e=this;if(!this.ids||0===this.ids.length)return!1;Object(i["e"])({configIds:this.ids}).then((function(t){var a=t.data.data;e.approvalUsers=a.approvalUsers||[],e.applyForm.approvalUser&&!e.approvalUsers.some((function(t){return t.userId===e.applyForm.approvalUser}))&&(e.applyForm.approvalUser="")}))},confirm:function(){var e=this;if(!this.ids||0===this.ids.length)return this.$message.warning("请选择至少一个接口"),!1;this.$refs.applyForm.validate((function(t){if(t){var a={};a.configIds=e.ids,a.title=e.applyForm.title,a.approvalUser=e.applyForm.approvalUser,a.type=e.applyForm.type,a.reason=e.applyForm.reason,e.loading=!0,e.id?(a.applyId=e.id,e.updateApply(a)):e.addApply(a)}}))},addApply:function(e){var t=this;return Object(i["b"])(e).then((function(){t.callback&&"function"===typeof t.callback&&t.callback(),t.$message.success("申请成功"),t.$emit("update:visible",!1),t.loading=!1})).catch((function(){t.loading=!1}))},updateApply:function(e){var t=this;return Object(o["f"])(e).then((function(){t.callback&&"function"===typeof t.callback&&t.callback(),t.$message.success("修改成功"),t.$emit("update:visible",!1),t.loading=!1})).catch((function(){t.loading=!1}))},deleteRow:function(e,t){t.splice(e,1)},initData:function(){this.tableData=this.list||[].concat(this.list)},addData:function(e){var t={},a=this.tableData.concat(e);a=Array.from(new Set(a)),a=a.reduce((function(e,a){var r=a.id||a.configId;return t[r]||(t[r]=!0,e.push(a)),e}),[]),this.tableData=a},handleClose:function(e){this.$emit("update:visible",!1),e&&e()}}},s=l,u=(a("09b0"),a("3bae"),a("2877")),p=Object(u["a"])(s,r,n,!1,null,"1491fea4",null);t["default"]=p.exports},"3bae":function(e,t,a){"use strict";a("c640")},"54b2":function(e,t,a){},"58a2":function(e,t,a){},"5a57":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"api-state-tag"},[a("el-badge",{attrs:{value:1===e.isModified?"改":""}},[0==e.currentState?a("el-tag",{attrs:{size:"small"}},[e._v("未发布")]):1==e.currentState?a("el-tag",{attrs:{size:"small",type:"success"}},[e._v("已发布")]):2==e.currentState?a("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("已下线")]):e._e()],1),a("div",{staticClass:"color-warning"},[e._v(e._s(e.getApprovalStateName(e.approvalState)))])],1)},n=[],i=(a("7514"),a("c5f6"),a("f874")),o={name:"api-state-tag",props:{currentState:{required:!0,type:[String,Number]},approvalState:{required:!0,type:[String,Number]},isModified:{type:[String,Number]}},methods:{getApprovalStateName:function(e){if([0,5,6,7].some((function(t){return t===e})))return"";var t=i["b"].find((function(t){return parseInt(t.value)===e}));return t&&t.label||""}}},c=o,l=(a("a8eb"),a("795c"),a("2877")),s=Object(l["a"])(c,r,n,!1,null,"4014e4cc",null);t["default"]=s.exports},"66f0":function(e,t,a){},"6d18":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("basic-container",{staticClass:"apply-api"},[a("avue-crud",{ref:"crud",attrs:{data:e.data,page:e.page,option:e.option,"table-loading":e.loading,"cell-class-name":"api-cell"},on:{"update:page":function(t){e.page=t},"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"currentState",fn:function(e){var t=e.row;return[a("api-state-tag",{attrs:{"is-modified":t.isModified,"current-state":t.currentState,"approval-state":t.approvalState}})]}}])})],1)},n=[],i=(a("ac6a"),a("708f")),o=a("f874"),c=a("5a57"),l={data:function(){return{query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},selectionList:[],option:{size:"mini",border:!0,selection:!0,tip:!1,columnBtn:!1,addBtn:!1,menu:!1,menuPosition:"right",searchGutter:"0",selectable:function(e){return![1,2,3].some((function(t){return e.approvalState===t}))},column:[{label:"所属服务",prop:"serviceName",search:!0,searchSpan:12},{label:"接口名",prop:"name",minWidth:120,search:!0,searchSpan:12},{label:"方法",prop:"method",width:80},{label:"路径",prop:"path",minWidth:120,search:!0,searchSpan:12},{label:"开发人员",prop:"developer"},{label:"状态",prop:"currentState",slot:!0,width:100,align:"center",search:!0,type:"select",dicData:o["a"],searchSpan:12}]},data:[]}},props:{selection:{type:[Object,Array]}},components:{apiStateTag:c["default"]},computed:{ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")}},watch:{selectionList:{deep:!0,handler:function(){this.emitData()}}},methods:{emitData:function(){this.$emit("update:selection",this.selectionList)},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.loading=!0,Object(i["g"])(e.currentPage,e.pageSize,Object.assign(a,this.query)).then((function(e){var a=e.data.data;t.page.total=a.total,t.data=a.records,t.loading=!1,t.selectionClear()}))}}},s=l,u=(a("dbd4"),a("78bb"),a("2877")),p=Object(u["a"])(s,r,n,!1,null,"71d8cb96",null);t["default"]=p.exports},"708f":function(e,t,a){"use strict";a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"l",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"m",(function(){return d})),a.d(t,"k",(function(){return f})),a.d(t,"i",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"e",(function(){return m})),a.d(t,"d",(function(){return h})),a.d(t,"h",(function(){return v})),a.d(t,"j",(function(){return y})),a.d(t,"c",(function(){return O}));a("8e6e"),a("ac6a"),a("456d"),a("a481");var r=a("ade3"),n=a("b5c6"),i=a("da71");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=function(e,t,a){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/list"),method:"get",params:c(c({},a),{},{current:e,size:t})})},s=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/detail"),method:"get",params:{id:e}})},u=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/remove"),method:"post",params:{ids:e}})},p=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/save"),method:"post",data:e})},d=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/update"),method:"post",data:e})},f=function(e){var t=e.id,a=void 0===t?"":t,r=e.remark,o=void 0===r?"":r;return Object(n["a"])({url:"".concat(i["a"],"/aggregate/publish"),method:"post",params:{id:a,remark:o}})},g=function(e){return Object(n["a"])({url:"".concat(i["a"],"/aggregate/offline"),method:"post",params:{ids:e}})},b=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/save"),method:"post",data:e})},m=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-apply/getApprovalUsers"),method:"post",data:e})},h=function(e){return Object(n["a"])({url:"".concat(i["a"],"/aggregate/export"),method:"post",params:{ids:e},responseType:"blob"}).then((function(e){var t=new Blob([e.data],{type:"application/json;charset=utf-8"});if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,unescape(e.headers.filename.replace(/\\u/g,"%u")));else{var a=document.createElement("a"),r=window.URL.createObjectURL(t);a.href=r,a.download=unescape(e.headers.filename.replace(/\\u/g,"%u")),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)}}))},v=function(e){return Object(n["a"])({url:"".concat(i["a"],"/aggregate/import"),method:"post",data:e})},y=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/turn-on-debug-mode"),method:"post",params:{ids:e}})},O=function(e){return Object(n["a"])({url:"".concat(i["a"],"/blade-aggregate-config/aggregateconfig/turn-off-debug-mode"),method:"post",params:{ids:e}})}},"78bb":function(e,t,a){"use strict";a("92c9")},"795c":function(e,t,a){"use strict";a("58a2")},8138:function(e,t,a){"use strict";a("1120")},"92c9":function(e,t,a){},a8eb:function(e,t,a){"use strict";a("227d")},c640:function(e,t,a){},dbd4:function(e,t,a){"use strict";a("54b2")}}]);